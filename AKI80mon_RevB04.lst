 AS V1.42 Beta [Bld 227] - Source File AKI80mon_RevB04.asm - Page 1 - 1/5/2023 20:45:29


       1/       0 :                     	page 0
       2/       0 :                     	cpu z80
       3/       0 :                     
       4/       0 :                     ;;; 
       5/       0 :                     ;;; Universal Monitor for Zilog Z80
       6/       0 :                     ;;;   Copyright (C) 2019,2020,2021 Haruo Asano
       7/       0 :                     ;;;
       8/       0 :                     ;;;  AKI-80 Monitor
       9/       0 :                     ;;;
      10/       0 :                     ;;; 2022.12.24 It was added functions by A.honda
      11/       0 :                     ;;; Rev.B03
      12/       0 :                     ;;;
      13/       0 :                     ;;; 2022.12.28 Support XON/XOFF Flow control by A.honda
      14/       0 :                     ;;; Rev.B04
      15/       0 :                     
      16/       0 :                     
      17/       0 :                     ;;; Constants
      18/       0 :                     
      19/       0 : =0DH                 CR	EQU	0DH
      20/       0 : =0AH                 LF	EQU	0AH
      21/       0 : =8H                  BS	EQU	08H
      22/       0 : =7FH                 DEL	EQU	7FH
      23/       0 : =1BH                 ESC	equ	1BH
      24/       0 :                     
      25/       0 : =28H                 BUFLEN	equ	40
      26/       0 : =7H                  NUMLEN	equ	7
      27/       0 : =8H                  F_bitSize	equ	8
      28/       0 : =4H                  NO_UPPER	equ	00000100b
      29/       0 : =2H                  NO_LF		equ	00000010b
      30/       0 : =1H                  NO_CR		equ	00000001b
      31/       0 :                     
      32/       0 : =0H                  BACKDOOR = 0
      33/       0 :                     	
      34/       0 :                     ;	MEMORY ASSIGN
      35/       0 :                     
      36/       0 : =0H                  ROM_B	EQU	0000H
      37/       0 : =40H                 ENTRY	equ	0040h
      38/       0 :                     
      39/       0 : =66H                 NMIVEC	equ	0066h
      40/       0 :                     
      41/       0 : =8000H               RAM_B	equ	8000H	; RAM base address
      42/       0 : =8000H               RAMSIZ	EQU	8000H
      43/       0 : =0FFFFH              RAM_E	equ	RAM_B + RAMSIZ - 1 ; RAM END address
      44/       0 :                     
      45/       0 : =40H                 Rx_BFSIZ	EQU	40H	; SIO recieve buffer size
      46/       0 : =40H                 Tx_BFSIZ	equ	40H	; SIO send buffer size
      47/       0 :                     
      48/       0 : =11H                 XON		equ	11h	; code DCh
      49/       0 : =13H                 XOFF		equ	13h	; code DC3
      50/       0 : =28H                 TXPEND		equ	28h	; SIO clear pending Tx int code
      51/       0 : =4H                  TXEMPTY		equ	04h
      52/       0 :                     
      53/       0 : =130H                WORK_SIZE	equ	130H		;monitor work area size
      54/       0 : =40H                 MSTACK_SIZE	equ	64		;Monitor stack size : 32 words 
      55/       0 :                     
      56/       0 : =0FED0H              WORK_B	equ	RAM_E -	WORK_SIZE + 1	; work area BF00-BFFF
      57/       0 : =0FED0H              STACKM	equ	WORK_B			; monitor stack
      58/       0 : =0FE90H              STACK	equ	WORK_B - MSTACK_SIZE	; user stack
      59/       0 :                     
      60/       0 : =2F00H               BASIC_TOP	equ	2F00H
      61/       0 : =2F00H               BASIC_CST	equ	2F00H	; basic cold start
      62/       0 : =2F03H               BASIC_WST	equ	2F03H	; basic warm start
      63/       0 :                     
      64/       0 : =4C00H               POTB_TOP	equ	4C00H
      65/       0 : =4C00H               POTB_CST	equ	4C00H	; basic cold start
      66/       0 : =4C03H               POTB_WST	equ	4C03H	; basic warm start
      67/       0 :                     
      68/       0 : =5400H               GAME80_TOP	equ	5400H
      69/       0 : =5400H               GAME80_CST	equ	5400H	; basic cold start
      70/       0 : =5403H               GAME80_WST	equ	5403H	; basic warm start
      71/       0 :                     
      72/       0 :                     ; I/O port ASSIGN
      73/       0 :                     
      74/       0 :                     ;	パラレルポートI/Oアドレスセット
      75/       0 :                     ;PIOA	EQU	1CH		;Ａポートデータ
      76/       0 :                     ;PIOB	EQU	1EH		;Ｂポートデータ
      77/       0 :                     
      78/       0 :                     ;	ＳＩＯポートI/Oアドレスセット
      79/       0 : =18H                 SIOA	EQU	18H		;chA送信/受信バッファ
      80/       0 : =1AH                 SIOB	EQU	1AH		;chB送信/受信バッファ
      81/       0 : =18H                 PSIOAD	EQU	SIOA
      82/       0 : =19H                 PSIOAC	EQU	SIOA+1
      83/       0 :                     
      84/       0 :                     ;	カウンタタイマI/Oアドレスセット
      85/       0 : =10H                 CTC0	EQU	10H		;CTC0のアドレス
      86/       0 :                     ;CTC1	EQU	11H		;CTC1のアドレス
      87/       0 :                     ;CTC2	EQU	12H		;CTC2のアドレス
      88/       0 :                     ;CTC3	EQU	13H		;CTC3のアドレス
      89/       0 :                     
      90/       0 :                     ;	Ｚ８４Ｃ０１５専用I/Oアドレスセット
      91/       0 :                     ;WDM	EQU	0F0H	;WDTER,WDTPR,HALTMR
      92/       0 :                     ;WDC	EQU	0F1H	;クリアー(4EH) ディセーブル(B1H)
      93/       0 :                     ;DGC	EQU	0F4H	;デイジーチェーン設定(bit0-bit2)
      94/       0 :                     ;WDCL	EQU	4EH	;ウォッチドッグクリアコマンドデータ
      95/       0 :                     
      96/       0 :                     
      97/       0 :                     	ORG	ROM_B
      98/       0 :                     ;
      99/       0 :                     ;	RST table
     100/       0 :                     ;
     101/       0 :                     E_CSTART:
     102/       0 : C3 FD 00            	JP	START
     103/       3 : C3 9E 01            	jp	WSTART0
     104/       6 :                     
     105/       6 : 00 00               	db	0008H - $ dup(00H)
     106/       8 :                     ;	ORG	0008H	; (RST 08H)
     107/       8 : =>FALSE              	IF	BACKDOOR
     108/       8 :                     	JP	RST08H
     109/       8 : =>TRUE               	ELSE
     110/       8 : C3 8B 2E            	JP	CONOUT
     111/       B : [107]                	ENDIF
     112/       B :                     
     113/       B : 00 00 00 00 00      	db	0010H - $ dup(00H)
     114/      10 :                     ;	ORG	0010H	; (RST 10H)
     115/      10 : =>FALSE              	IF	BACKDOOR
     116/      10 :                     	JP	RST10H
     117/      10 : =>TRUE               	ELSE
     118/      10 : C3 3C 2E            	JP	CONIN
     119/      13 : [115]                	ENDIF
     120/      13 :                     
     121/      13 : 00 00 00 00 00      	db	0018H - $ dup(00H)	; nop
     122/      18 :                     ;	ORG	0018H	; (RST 18H)
     123/      18 : =>FALSE              	IF	BACKDOOR
     124/      18 :                     	JP	RST18H
     125/      18 : =>TRUE               	ELSE
     126/      18 : C3 86 2E            	JP	CONST
     127/      1B : [123]                	ENDIF
     128/      1B :                     
     129/      1B : 00 00 00 00 00      	db	0020H - $ dup(00H)	; nop
     130/      20 :                     ;	ORG	0020H	; (RST 20H)
     131/      20 : =>FALSE              	IF	BACKDOOR
     132/      20 :                     	JP	RST20H
     133/      20 : =>TRUE               	ELSE
     134/      20 : C9                  	RET
     135/      21 : [131]                	ENDIF
     136/      21 :                     
     137/      21 : 00 00 00 00 00 00   	db	0028H - $ dup(00H)	; nop
               27 : 00                
     138/      28 :                     ;	ORG	0028H	; (RST 28H)
     139/      28 : =>FALSE              	IF	BACKDOOR
     140/      28 :                     	RET
     141/      28 : =>TRUE               	ELSE
     142/      28 : C9                  	RET
     143/      29 : [139]                	ENDIF
     144/      29 :                     
     145/      29 : 00 00 00 00 00 00   	db	0030H - $ dup(00H)	; nop
               2F : 00                
     146/      30 :                     ;	ORG	0030H
     147/      30 : =>FALSE              	IF	BACKDOOR
     148/      30 :                     	JP	RST30H
     149/      30 : =>TRUE               	ELSE
     150/      30 : C3 57 27            	JP	RST30H_IN
     151/      33 : [147]                	ENDIF
     152/      33 :                     
     153/      33 : 00 00 00 00 00      	db	0038H - $ dup(00H)	; nop
     154/      38 :                     ;	ORG	0038H
     155/      38 : =>FALSE              	IF	BACKDOOR
     156/      38 :                     	JP	RST38H;
     157/      38 : =>TRUE               	ELSE
     158/      38 : C3 E4 27            	JP	RST38H_IN
     159/      3B : [155]                	ENDIF
     160/      3B :                     
     161/      3B :                     ;**************************************
     162/      3B :                     ;	INTERRUPT TABLE
     163/      3B :                     ;**************************************
     164/      3B :                     
     165/      3B : 00 00 00 00 00      	db	ENTRY - $ dup(00H)
     166/      40 :                     ;	org	ENTRY
     167/      40 :                     
     168/      40 : 00 00               	DW	0000H			; 0: SIOBトランスミッタバッファエンプティ
     169/      42 : 00 00               	DW	0000H			; 2: SIOB外部／ステータス割り込み
     170/      44 : 00 00               	DW	0000H			; 4: SIOBレシーバキャラクタアベイラブル
     171/      46 : 00 00               	DW	0000H			; 6: SIOB特殊受信状態
     172/      48 : 68 00               	DW	INTTXD			; 8: SIOA
     173/      4A : DE 00               	DW	IGNORE			;10:
     174/      4C : 8F 00               	DW	INTRXD			;12:
     175/      4E : DE 00               	DW	IGNORE			;14
     176/      50 :                     
     177/      50 :                     ;	DW	0000H			;16: PIOA割り込み
     178/      50 :                     ;	DW	0000H			;18: PIOB割り込み
     179/      50 :                     ;	DW	0000H			;20: CTC0割り込み
     180/      50 :                     ;	DW	0000H			;22: CTC1割り込み
     181/      50 :                     ;	DW	0000H			;24: CTC2割り込み
     182/      50 :                     ;	DW	0000H			;26: CTC3割り込み
     183/      50 :                     
     184/      50 :                     ;********************************
     185/      50 :                     ;	Ｉ／Ｏセットデータ
     186/      50 :                     ;********************************
     187/      50 :                     ;PIOACD:	DB	0CFH		;PIOAモードワード			**001111
     188/      50 :                     ;	DB	00H		;PIOAデータディレクションワード
     189/      50 :                     ;	DB	17H		;PIOAインタラプトコントロールワード	****0111
     190/      50 :                     ;	DB	00H		;PIOAインタラプトマスクワード
     191/      50 :                     ;	DB	ENTRY+16	;PIOAインタラプトベクタ
     192/      50 :                     ;PAEND	EQU	$
     193/      50 :                     ;PIOBCD:	DB	0CFH		;PIOBモードワード			**001111
     194/      50 :                     ;	DB	00H		;PIOBデータディレクションワード
     195/      50 :                     ;	DB	17H		;PIOBインタラプトコントロールワード	****0111
     196/      50 :                     ;	DB	00H		;PIOBインタラプトマスクワード
     197/      50 :                     ;	DB	ENTRY+18	;PIOBインタラプトベクタ
     198/      50 :                     ;PBEND	EQU	$
     199/      50 :                     
     200/      50 : 18                  SIOACD:	DB	18H		;SIOA WR0 チャンネルリセット
     201/      51 : 14                  	DB	14H		;SIOA WR4 & Reset Ext/Status Interrupts
     202/      52 : 44                  	DB	44H		;SIOA WR4 1/16CLK 8bit 1stop bit NonParity
     203/      53 : 03                  	DB	03H		;SIOA WR0 ポインタ３
     204/      54 : C1                  	DB	0C1H		;SIOA WR3 受信バッファ制御情報:8bit, Rx Enable
     205/      55 : 05                  	DB	05H		;SIOA WR0 WR5
     206/      56 : E8                  	DB	0E8H		;SIOA WR5 DTR, TX 8bit/Character, TX Enable
     207/      57 : 01                  	DB	01H		;SIOA WR1
     208/      58 : 12                  	db	12H		; enable Tx int
     209/      59 :                     
     210/      59 : =59H                 SAEND	EQU	$
     211/      59 : 18                  SIOBCD:	DB	18H		;SIOB WR0 チャンネルリセット
     212/      5A : 01                  	DB	01H		;SIOB WR0 ポインタ１
     213/      5B : 04                  	DB	04H		;SIOB WR1 割り込み制御ウェイト／レディ
     214/      5C : 02                  	DB	02H		;SIOB WR0 ポインタ２
     215/      5D : 40                  	DB	ENTRY & 00FFH	;SIOB WR2 インタラプトベクタ
     216/      5E :                     
     217/      5E :                     ;	DB	03H		;SIOB WR0 ポインタ３
     218/      5E :                     ;	DB	0E1H		;SIOB WR3 受信バッファ制御情報
     219/      5E :                     ;	DB	05H		;SIOB WR0 ポインタ５
     220/      5E :                     ;	DB	68H		;SIOB WR5 送信バッファ制御情報
     221/      5E : =5EH                 SBEND	EQU	$
     222/      5E :                     
     223/      5E : 05                  CTC0CD:	DB	05H		;CTC0 チャンネルコントロールワード	*******1
     224/      5F : 05                  	DB	5		;1/5 = 153.6KHz
     225/      60 :                     ;	DB	ENTRY+20	;CTC0 インタラプトベクタ		*****000
     226/      60 : =60H                 C0END	EQU	$
     227/      60 :                     ;CTC1CD:	DB	05H		;CTC1 チャンネルコントロールワード	*******1
     228/      60 :                     ;	DB	00H		;CTC1 タイムコンスタントレジスタ
     229/      60 :                     ;C1END	EQU	$
     230/      60 :                     ;CTC2CD:	DB	05H		;CTC2 チャンネルコントロールワード	*******1
     231/      60 :                     ;	DB	00H		;CTC2 タイムコンスタントレジスタ
     232/      60 :                     ;C2END	EQU	$
     233/      60 :                     ;CTC3CD:	DB	05H		;CTC3 チャンネルコントロールワード	*******1
     234/      60 :                     ;	DB	00H		;CTC3 タイムコンスタントレジスタ
     235/      60 :                     ;C3END	EQU	$
     236/      60 :                     
     237/      60 :                     ;WDMCD:	DB	07BH	;ウォッチドッグ disable, HALT: RUN
     238/      60 :                     ;GCCD:	DB	00H	;デイジーチェーン順位設定		00000***
     239/      60 :                     
     240/      60 :                     ; --------------- NMI VECTOR ADDRESS 66H --------------------------------
     241/      60 :                     
     242/      60 : 00 00 00 00 00 00   	db	NMIVEC - $ dup(00H)	; nop
     243/      66 :                     ;	org	NMIVEC
     244/      66 : ED 45               	RETN			;ＮＭＩ禁止
     245/      68 :                     
     246/      68 :                     ;-------------------------------------
     247/      68 :                     ; SIO INTERRUPT SERVICE ROUTINE
     248/      68 :                     ;-------------------------------------
     249/      68 :                     
     250/      68 :                     INTTXD:	
     251/      68 : F5                  	PUSH	AF
     252/      69 : C5                  	PUSH	BC
     253/      6A : D5                  	PUSH	DE
     254/      6B : E5                  	PUSH	HL
     255/      6C :                     
     256/      6C : 3A CD FF            	ld	a, (rx_xreq)
     257/      6F : B7                  	or	a
     258/      70 : 28 07               	jr	z, inttx_nxt
     259/      72 :                     
     260/      72 :                     	;send XON/XOFF request
     261/      72 : D3 18               	OUT	(PSIOAD), a
     262/      74 : 32 CB FF            	ld	(rx_xflg), a
     263/      77 : 18 07               	jr	clr_pend
     264/      79 :                     	
     265/      79 :                     
     266/      79 :                     inttx_nxt:
     267/      79 : CD C9 2E            	call	get_TxDat
     268/      7C : 38 0B               	JR	c, clr_TxIntPending
     269/      7E :                     
     270/      7E :                     ;	SEND DATA
     271/      7E : D3 18               	OUT	(PSIOAD), a
     272/      80 :                     
     273/      80 :                     clr_pend:
     274/      80 : AF                  	xor	a
     275/      81 : 32 CD FF            	ld	(rx_xreq), a
     276/      84 :                     set_pend:
     277/      84 : 32 CA FF            	ld	(tx_pend), a
     278/      87 : 18 51               	jr	INTEXT
     279/      89 :                     
     280/      89 :                     ; clear Tx interrupt pending
     281/      89 :                     clr_TxIntPending:
     282/      89 : 3E 28               	ld	a, TXPEND	; reset Tx int pending
     283/      8B : D3 19               	out	(PSIOAC), a
     284/      8D : 18 F5               	jr	set_pend
     285/      8F :                     
     286/      8F :                     ; RX
     287/      8F :                     ;	SIOA -> BUFFER
     288/      8F :                     ;
     289/      8F : F5                  INTRXD:	PUSH	AF
     290/      90 : C5                  	PUSH	BC
     291/      91 : D5                  	PUSH	DE
     292/      92 : E5                  	PUSH	HL
     293/      93 :                     ;
     294/      93 :                     ;	RECEIVE DATA
     295/      93 : DB 18               	IN	A,(PSIOAD)
     296/      95 :                     
     297/      95 :                     	;check XOFF code
     298/      95 : FE 13               	cp	XOFF
     299/      97 : 28 04               	jr	z, ctl_txflg
     300/      99 :                     
     301/      99 :                     	;check XON code
     302/      99 : FE 11               	cp	XON
     303/      9B : 20 05               	jr	nz, ctl_rcv
     304/      9D :                     
     305/      9D :                     ctl_txflg:
     306/      9D : 32 CC FF            	ld	(tx_xflg), a	; save TX XON/OFF condition
     307/      A0 : 18 38               	jr	INTEXT
     308/      A2 :                     
     309/      A2 :                     ; control receive data buffer
     310/      A2 :                     ctl_rcv:
     311/      A2 : 57                  	LD	D,A
     312/      A3 :                     
     313/      A3 : 3A 44 FF            	LD	A,(Rx_BCNT)
     314/      A6 : FE 40               	CP	Rx_BFSIZ	; CHECK BUFFER FULL
     315/      A8 : 28 30               	jr	z, INTEXT	; ring buffer full
     316/      AA :                     
     317/      AA : 3C                  	INC	A
     318/      AB : 32 44 FF            	LD	(Rx_BCNT),A
     319/      AE : FE 36               	CP	Rx_BFSIZ - 10
     320/      B0 : 20 17               	jr	nz, ctl_rcv1
     321/      B2 :                     	
     322/      B2 :                     	; XOFF control
     323/      B2 : 3E 13               	ld	a, XOFF
     324/      B4 : 32 CD FF            	ld	(rx_xreq), a
     325/      B7 : 3A CA FF            	ld	a, (tx_pend)
     326/      BA : B7                  	or	a
     327/      BB : 28 0C               	jr	z, ctl_rcv1
     328/      BD :                     
     329/      BD : 3E 13               	ld	a, XOFF
     330/      BF : 32 CB FF            	ld	(rx_xflg), a
     331/      C2 : CD E7 2E            	call	Tx_direct
     332/      C5 : AF                  	xor	a
     333/      C6 : 32 CD FF            	ld	(rx_xreq), a
     334/      C9 :                     
     335/      C9 :                     ;
     336/      C9 :                     ;	WRITE DATA TO BUFFER
     337/      C9 :                     ctl_rcv1:
     338/      C9 : 3A 46 FF            	LD	A,(Rx_BWP)
     339/      CC : 4F                  	LD	C,A
     340/      CD : 06 00               	LD	B,00H
     341/      CF : 21 47 FF            	LD	HL,Rx_BUF
     342/      D2 : 09                  	ADD	HL,BC
     343/      D3 : 72                  	LD	(HL),D
     344/      D4 : 3C                  	INC	A
     345/      D5 : E6 3F               	AND	Rx_BFSIZ-1
     346/      D7 : 32 46 FF            	LD	(Rx_BWP),A
     347/      DA :                     ;
     348/      DA :                     ;	RESTORE REGISTERS
     349/      DA : E1                  INTEXT:	POP	HL
     350/      DB : D1                  	POP	DE
     351/      DC : C1                  	POP	BC
     352/      DD : F1                  	POP	AF
     353/      DE :                     ;
     354/      DE :                     ;	RETURN FROM INTERRUPT
     355/      DE :                     IGNORE:
     356/      DE : FB                  	EI
     357/      DF : ED 4D               	RETI
     358/      E1 :                     
     359/      E1 :                     ;*******************************
     360/      E1 :                     ;	Ｉ／Ｏセットアップ
     361/      E1 :                     ;*******************************
     362/      E1 :                     
     363/      E1 :                     IOSET:
     364/      E1 :                     ;	LD	HL, PIOACD		;PIOAコマンドセットアップ
     365/      E1 :                     ;	LD	B, PAEND - PIOACD
     366/      E1 :                     ;	LD	C, PIOA + 1		;PIOAコマンドアドレス(1DH)
     367/      E1 :                     ;	OTIR
     368/      E1 :                     ;	LD	HL, PIOBCD		;PIOBコマンドセットアップ
     369/      E1 :                     ;	LD	B, PBEND - PIOBCD
     370/      E1 :                     ;	LD	C, PIOB + 1		;PIOBコマンドアドレス(1FH)
     371/      E1 :                     ;	OTIR
     372/      E1 : 21 5E 00            	LD	HL, CTC0CD		;CTC0コマンドセットアップ
     373/      E4 : 06 02               	LD	B, C0END - CTC0CD
     374/      E6 : 0E 10               	LD	C, CTC0
     375/      E8 : ED B3               	OTIR
     376/      EA :                     ;	LD	HL, CTC1CD		;CTC1コマンドセットアップ
     377/      EA :                     ;	LD	B, C1END - CTC1CD
     378/      EA :                     ;	LD	C, CTC1
     379/      EA :                     ;	OTIR
     380/      EA :                     ;	LD	HL, CTC2CD		;CTC2コマンドセットアップ
     381/      EA :                     ;	LD	B, C2END - CTC2CD
     382/      EA :                     ;	LD	C, CTC2
     383/      EA :                     ;	OTIR
     384/      EA :                     ;	LD	HL, CTC3CD		;CTC3コマンドセットアップ
     385/      EA :                     ;	LD	B, C3END - CTC3CD
     386/      EA :                     ;	LD	C, CTC3
     387/      EA :                     ;	OTIR
     388/      EA : 21 50 00            	LD	HL, SIOACD		;SIOAコマンドセットアップ
     389/      ED : 06 09               	LD	B, SAEND - SIOACD
     390/      EF : 0E 19               	LD	C, SIOA + 1		;SIOAコマンドアドレス(19H)
     391/      F1 : ED B3               	OTIR
     392/      F3 : 21 59 00            	LD	HL, SIOBCD		;SIOBコマンドセットアップ
     393/      F6 : 06 05               	LD	B, SBEND - SIOBCD
     394/      F8 : 0E 1B               	LD	C, SIOB + 1		;SIOBコマンドアドレス(1BH)
     395/      FA : ED B3               	OTIR
     396/      FC :                     ;	LD	A, (WDMCD)		;ウォッチドッグ，ホルトモードセット
     397/      FC :                     ;	OUT	(WDM), A
     398/      FC :                     ;	LD	A, (DGCCD)		;割り込み優先順位セット
     399/      FC :                     ;	LD	A, (GCCD)		;割り込み優先順位セット
     400/      FC :                     ;	OUT	(DGC), A
     401/      FC :                     ;WDOG:	LD	A, WDCL			;ウォッチドッグクリア
     402/      FC :                     ;	OUT	(WDC), A
     403/      FC : C9                  	RET
     404/      FD :                     
     405/      FD : =>FALSE              	IF	BACKDOOR
     406/      FD :                     ;;;
     407/      FD :                     ;;; RST 08H Handler
     408/      FD :                     ;;;
     409/      FD :                     RST08H:
     410/      FD :                     
     411/      FD :                     	ld	(save_hl), hl	; save hl
     412/      FD :                     	ld	hl, (stealRST08)
     413/      FD :                     	jr	jmp_rst
     414/      FD :                     
     415/      FD :                     ;;;
     416/      FD :                     ;;; RST 10H Handler
     417/      FD :                     ;;;
     418/      FD :                     RST10H:
     419/      FD :                     
     420/      FD :                     	ld	(save_hl), hl	; save hl
     421/      FD :                     	ld	hl, (stealRST10)
     422/      FD :                     	jr	jmp_rst
     423/      FD :                     
     424/      FD :                     ;;;
     425/      FD :                     ;;; RST 18H Handler
     426/      FD :                     ;;;
     427/      FD :                     RST18H:
     428/      FD :                     
     429/      FD :                     	ld	(save_hl), hl	; save hl
     430/      FD :                     	ld	hl, (stealRST18)
     431/      FD :                     	jr	jmp_rst
     432/      FD :                     
     433/      FD :                     ;;;
     434/      FD :                     ;;; RST 20H Handler
     435/      FD :                     ;;;
     436/      FD :                     RST20H:
     437/      FD :                     
     438/      FD :                     	ld	(save_hl), hl	; save hl
     439/      FD :                     	ld	hl, (stealRST20)
     440/      FD :                     	jr	jmp_rst
     441/      FD :                     
     442/      FD :                     ;;;
     443/      FD :                     ;;; RST 28H Handler
     444/      FD :                     ;;;
     445/      FD :                     RST28H:
     446/      FD :                     
     447/      FD :                     	ld	(save_hl), hl	; save hl
     448/      FD :                     	ld	hl, (stealRST28)
     449/      FD :                     	jr	jmp_rst
     450/      FD :                     
     451/      FD :                     ;;;
     452/      FD :                     ;;; RST 30H Handler
     453/      FD :                     ;;;
     454/      FD :                     RST30H:
     455/      FD :                     
     456/      FD :                     	ld	(save_hl), hl	; save hl
     457/      FD :                     	ld	hl, (stealRST30)
     458/      FD :                     	jr	jmp_rst
     459/      FD :                     
     460/      FD :                     ;;;
     461/      FD :                     ;;; RST 38H Handler
     462/      FD :                     ;;;
     463/      FD :                     RST38H:
     464/      FD :                     
     465/      FD :                     	ld	(save_hl), hl	; save hl
     466/      FD :                     	ld	hl, (stealRST38)
     467/      FD :                     jmp_rst:
     468/      FD :                     	push	hl		; set jump address
     469/      FD :                     	ld	hl, (save_hl)	; restore hl
     470/      FD :                     RST20H_IN:
     471/      FD :                     RST28H_IN:
     472/      FD :                     	ret			; jump (stealRST38)
     473/      FD : [405]                	ENDIF
     474/      FD :                     
     475/      FD :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     476/      FD :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     477/      FD :                     ;;;
     478/      FD :                     ;;; Universal Monitor Z80 Cold start
     479/      FD :                     ;;;
     480/      FD :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     481/      FD :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
     482/      FD :                     
     483/      FD :                     START:
     484/      FD : F3                  	DI				;セットアップ中、割り込み不可
     485/      FE : 31 D0 FE            	LD	SP,STACKM		; monitor stask defines STACKM
     486/     101 : 21 00 80            	LD	HL,RAM_B
     487/     104 : 01 00 80            	LD	BC,RAMSIZ
     488/     107 :                     init_ram:
     489/     107 : AF                  	xor	a
     490/     108 : 77                  	LD	(HL), a
     491/     109 : 23                  	inc	hl
     492/     10A : 0B                  	dec	bc
     493/     10B : 78                  	ld	a, b
     494/     10C : B1                  	or	c
     495/     10D : 20 F8               	jr	nz, init_ram
     496/     10F :                     
     497/     10F : ED 5E               	IM	2			;割り込みモード２
     498/     111 : 21 40 00            	LD	HL,ENTRY
     499/     114 : 7C                  	LD	A,H
     500/     115 : ED 47               	LD	I,A
     501/     117 :                     
     502/     117 :                     ;	LD	HL, 8000H		;外部I/O使用時のRESET待ち
     503/     117 :                     ;WAIT:	DEC	HL
     504/     117 :                     ;	LD	A, H
     505/     117 :                     ;	OR	L
     506/     117 :                     ;	JR	NZ, WAIT
     507/     117 :                     
     508/     117 : CD E1 00            	CALL	IOSET
     509/     11A :                     
     510/     11A : 3E 11               	ld	a, XON
     511/     11C : 32 CB FF            	ld	(rx_xflg), a
     512/     11F : 32 CC FF            	ld	(tx_xflg), a
     513/     122 : CD E7 2E            	call	Tx_direct
     514/     125 :                     
     515/     125 : FB                  	EI
     516/     126 :                     
     517/     126 : 21 00 80            	LD	HL,RAM_B
     518/     129 : 22 D0 FE            	LD	(DSADDR),HL
     519/     12C : 22 D7 FE            	LD	(SADDR),HL
     520/     12F : 22 D5 FE            	LD	(GADDR),HL
     521/     132 : 22 1B FF            	ld	(asm_adr),HL
     522/     135 : 22 1D FF            	ld	(tasm_adr),HL
     523/     138 : 3E 49               	LD	A,'I'
     524/     13A : 32 D9 FE            	LD	(HEXMOD),A
     525/     13D :                     	
     526/     13D : =>FALSE              	IF	BACKDOOR
     527/     13D :                     	; init back door RST XXH entory point
     528/     13D :                     	ld	hl, CONOUT		; RST 08H : CONOUT
     529/     13D :                     	ld	(stealRST08), hl
     530/     13D :                     	ld	hl, CONIN
     531/     13D :                     	ld	(stealRST10), hl	; RST 10H : CONIN
     532/     13D :                     	ld	hl, CONST
     533/     13D :                     	ld	(stealRST18), hl	; RST 18H : CONST
     534/     13D :                     	ld	hl, RST20H_IN
     535/     13D :                     	ld	(stealRST20), hl
     536/     13D :                     	ld	hl, RST28H_IN
     537/     13D :                     	ld	(stealRST28), hl
     538/     13D :                     	ld	hl, RST30H_IN
     539/     13D :                     	ld	(stealRST30), hl
     540/     13D :                     	ld	hl, RST38H_IN
     541/     13D :                     	ld	(stealRST38), hl
     542/     13D : [526]                	ENDIF
     543/     13D :                     
     544/     13D :                     	;; Initialize register value
     545/     13D : AF                  	XOR	A
     546/     13E : 21 DC FE            	LD	HL,REG_B
     547/     141 : 06 2E               	LD	B,dbg_wend-REG_B
     548/     143 :                     IR0:
     549/     143 : 77                  	LD	(HL),A
     550/     144 : 23                  	INC	HL
     551/     145 : 10 FC               	DJNZ	IR0
     552/     147 :                     
     553/     147 :                     ;	LD	B, dbg_wend - dbg_wtop
     554/     147 :                     ;	ld	hl,dbg_wtop	
     555/     147 :                     ;	XOR	A
     556/     147 :                     ;
     557/     147 :                     ;dbg_wini:
     558/     147 :                     ;	ld	(hl), a
     559/     147 :                     ;	inc	hl
     560/     147 :                     ;	DJNZ	dbg_wini
     561/     147 :                     
     562/     147 : 21 90 FE            	LD	HL,STACK		; user stack define STACK
     563/     14A : 22 F0 FE            	LD	(REGSP),HL
     564/     14D : 21 00 80            	ld	hl, RAM_B
     565/     150 : 22 F2 FE            	ld	(REGPC), HL		; set program counter
     566/     153 :                     
     567/     153 : 06 08               	ld	b, F_bitSize
     568/     155 : 3E 2E               	ld	a, '.'
     569/     157 : 21 30 FF            	ld	hl, F_bit
     570/     15A :                     ir00:
     571/     15A : 77                  	ld	(hl), a
     572/     15B : 23                  	inc	hl
     573/     15C : 10 FC               	djnz	ir00		; init F_bit string
     574/     15E : AF                  	xor	a
     575/     15F : 77                  	ld	(hl), a		; delimiter
     576/     160 :                     
     577/     160 :                     ; init dbg work area
     578/     160 :                     
     579/     160 : 3E 49               	ld	a, 'I'
     580/     162 : 32 15 FF            	ld	(TM_mode), a	; default call_in mode
     581/     165 : 3E 4E               	ld	a, 'N'
     582/     167 : 32 14 FF            	ld	(TP_mode), a	; default display reg mode
     583/     16A : 2E 00               	ld	l, 0
     584/     16C : 65                  	ld	h, l
     585/     16D : 22 16 FF            	ld	(TC_cnt), hl	; clear trace step counter to 0
     586/     170 : AF                  	xor	a
     587/     171 : 32 1A FF            	ld	(fever_t), a	; clear flag trace forever
     588/     174 :                     	; init bp, tp, gstop address & opcode
     589/     174 : 21 00 80            	ld	hl, RAM_B
     590/     177 : 22 F8 FE            	ld	(tpt1_adr), hl
     591/     17A : 22 FC FE            	ld	(tpt2_adr), hl
     592/     17D : 22 00 FF            	ld	(bpt1_adr), hl
     593/     180 : 22 04 FF            	ld	(bpt2_adr), hl
     594/     183 : 22 08 FF            	ld	(tmpb_adr), hl
     595/     186 : 7E                  	ld	a, (hl)
     596/     187 : 32 F7 FE            	ld	(tpt1_op), a
     597/     18A : 32 FB FE            	ld	(tpt2_op), a
     598/     18D : 32 FF FE            	ld	(bpt1_op), a
     599/     190 : 32 03 FF            	ld	(bpt2_op), a
     600/     193 : 32 07 FF            	ld	(tmpb_op), a
     601/     196 :                     
     602/     196 :                     ;; Opening message
     603/     196 :                     
     604/     196 : 21 A5 2B            	LD	HL,OPNMSG
     605/     199 : CD 1B 26            	CALL	STROUT
     606/     19C : 18 2D               	jr	WSTART
     607/     19E :                     
     608/     19E :                     WSTART0:
     609/     19E :                     ;	RECEIVE BUFFER INITIALIZE
     610/     19E :                     ;	init XON/XOFF control
     611/     19E :                     
     612/     19E : AF                  	XOR	A
     613/     19F : F3                  	DI
     614/     1A0 : 32 44 FF            	LD	(Rx_BCNT),A
     615/     1A3 : 32 45 FF            	LD	(Rx_BRP),A
     616/     1A6 : 32 46 FF            	LD	(Rx_BWP),A
     617/     1A9 : 32 87 FF            	LD	(Tx_BCNT),A
     618/     1AC : 32 88 FF            	LD	(Tx_BRP),A
     619/     1AF : 32 89 FF            	LD	(Tx_BWP),A
     620/     1B2 : 32 CD FF            	ld	(rx_xreq), a
     621/     1B5 :                     
     622/     1B5 :                     	; Reinit SIO
     623/     1B5 :                     
     624/     1B5 : 3E 30               	ld	a, 30h		; Error Reset
     625/     1B7 : D3 19               	out	(PSIOAC), a
     626/     1B9 : 3E 28               	ld	a, TXPEND	; Reset TxINT Pending
     627/     1BB : D3 19               	out	(PSIOAC), a
     628/     1BD : 32 CA FF            	ld	(tx_pend), a
     629/     1C0 :                     
     630/     1C0 : 3E 11               	ld	a, XON
     631/     1C2 : 32 CB FF            	ld	(rx_xflg), a
     632/     1C5 : 32 CC FF            	ld	(tx_xflg), a
     633/     1C8 : CD E7 2E            	call	Tx_direct
     634/     1CB :                     ;	EI
     635/     1CB :                     
     636/     1CB :                     WSTART:
     637/     1CB : 31 D0 FE            	LD	SP,STACKM	; monitor stask defines STACKM
     638/     1CE : AF                  	xor	a
     639/     1CF : 32 39 FF            	ld	(ky_flg), a	; clear skip LF flag
     640/     1D2 :                     
     641/     1D2 : 21 E2 2B            	LD	HL,PROMPT
     642/     1D5 : CD 1B 26            	CALL	STROUT
     643/     1D8 : CD 7B 26            	CALL	GETLIN
     644/     1DB : CD 05 27            	CALL	SKIPSP
     645/     1DE : B7                  	OR	A
     646/     1DF : 28 EA               	JR	Z, WSTART
     647/     1E1 :                     
     648/     1E1 : FE 41               	CP	'A'
     649/     1E3 : CA 29 1A            	JP	Z, line_asm
     650/     1E6 : FE 44               	CP	'D'
     651/     1E8 : CA B4 07            	JP	Z, DUMP
     652/     1EB : FE 47               	CP	'G'
     653/     1ED : CA 9C 14            	JP	Z, GO
     654/     1F0 : FE 53               	CP	'S'
     655/     1F2 : CA 5D 15            	JP	Z, SETM
     656/     1F5 :                     
     657/     1F5 : FE 4C               	CP	'L'
     658/     1F7 : CA D3 15            	JP	Z, LOADH
     659/     1FA : FE 50               	CP	'P'
     660/     1FC : CA AD 16            	JP	Z, SAVEH
     661/     1FF :                     
     662/     1FF : FE 52               	CP	'R'
     663/     201 : CA 85 17            	JP	Z, REG
     664/     204 :                     
     665/     204 : FE 23               	cp	'#'
     666/     206 : CA 27 02            	jp	Z, Launcher
     667/     209 :                     
     668/     209 : FE 42               	cp	'B'
     669/     20B : CA 7B 03            	jp	z, brk_cmd	; break point command
     670/     20E :                     	
     671/     20E : FE 54               	cp	'T'
     672/     210 : CA 2B 04            	jp	z, trace_cmd	; trace point command
     673/     213 :                     
     674/     213 : FE 3F               	cp	'?'
     675/     215 : 28 08               	jr	z, command_hlp	; command help message
     676/     217 :                     
     677/     217 :                     ERR:
     678/     217 : 21 FF 2B            	LD	HL,ERRMSG
     679/     21A : CD 1B 26            	CALL	STROUT
     680/     21D : 18 AC               	JR	WSTART
     681/     21F :                     
     682/     21F :                     ;;
     683/     21F :                     ;; command help
     684/     21F :                     ;;
     685/     21F :                     command_hlp:
     686/     21F :                     
     687/     21F : 21 D7 29            	LD	HL, cmd_hlp
     688/     222 : CD 1B 26            	CALL	STROUT
     689/     225 : 18 A4               	JR	WSTART
     690/     227 :                     
     691/     227 :                     ;;
     692/     227 :                     ;; Launch appended program
     693/     227 :                     ;;
     694/     227 :                     Launcher:
     695/     227 : 23                  	INC	HL
     696/     228 : CD 05 27            	CALL	SKIPSP		; A <- next char
     697/     22B : B7                  	OR	A
     698/     22C : 28 E9               	JR	Z,ERR
     699/     22E :                     
     700/     22E :                     	; check L or number
     701/     22E :                     	
     702/     22E : FE 4C               	cp	'L'
     703/     230 : 28 25               	JR	Z,LST_PRG	; list append program
     704/     232 :                     
     705/     232 :                     	; check number
     706/     232 :                     
     707/     232 : CD 16 03            	call	GET_NUM		; return BC : number
     708/     235 : 38 E0               	JR	C, ERR
     709/     237 :                     
     710/     237 :                     	; check number
     711/     237 : 79                  	LD	A, C
     712/     238 : FE 08               	CP	(lanch1 - ApendTBL)/2 +1	; a < 17 ?
     713/     23A : D2 17 02            	JP	NC, ERR
     714/     23D : B7                  	OR	A				; check '0'
     715/     23E : CA 17 02            	JP	Z, ERR
     716/     241 :                     
     717/     241 :                     	; A <- append program No.
     718/     241 :                     
     719/     241 : 3D                  	DEC	A	; 0 <= A <= 0FH
     720/     242 : 17                  	RLA		; A = A * 2
     721/     243 : 16 00               	LD	D, 0
     722/     245 : 5F                  	LD	E, A
     723/     246 : 21 6C 02            	LD	HL, ApendTBL
     724/     249 : 19                  	ADD	HL, DE	; get lanch address point
     725/     24A : 5E                  	LD	E, (HL)
     726/     24B : 23                  	INC	HL
     727/     24C : 56                  	LD	D, (HL)	; DE : JUMP POINT
     728/     24D :                     
     729/     24D :                     	; Jump to append program
     730/     24D :                     	
     731/     24D : EB                  	EX	DE, HL
     732/     24E : 5E                  	LD	E, (HL)
     733/     24F : 23                  	INC	HL
     734/     250 : 56                  	LD	D, (HL)	; DE : jump address
     735/     251 : 7A                  	LD	A, D
     736/     252 : B3                  	OR	E	; address check
     737/     253 : 28 C2               	JR	Z,ERR	; jump address NULL
     738/     255 : EB                  	EX	DE, HL
     739/     256 : E9                  	JP	(HL)	; lanch append program
     740/     257 :                     	
     741/     257 :                     	; List out append program
     742/     257 :                     LST_PRG:
     743/     257 :                     	; get address to DE
     744/     257 : 21 6C 02            	LD	HL, ApendTBL
     745/     25A :                     
     746/     25A :                     LST_PRG1:
     747/     25A : 5E                  	LD	E, (HL)
     748/     25B : 23                  	INC	HL
     749/     25C : 7E                  	LD	a, (HL)
     750/     25D : 57                  	ld	d, a
     751/     25E : 23                  	INC	HL
     752/     25F :                     
     753/     25F : B3                  	or	e
     754/     260 : CA CB 01            	jp	z, WSTART
     755/     263 : 13                  	INC	DE
     756/     264 : 13                  	INC	DE	; get string address
     757/     265 :                     	
     758/     265 : EB                  	EX	DE, HL
     759/     266 : CD 1B 26            	CALL	STROUT
     760/     269 : EB                  	EX	DE, HL
     761/     26A : 18 EE               	JR	LST_PRG1
     762/     26C :                     	
     763/     26C :                     ; Append program launch table
     764/     26C :                     ;
     765/     26C :                     ApendTBL:
     766/     26C : 7A 02               	dw	lanch1
     767/     26E : 8E 02               	dw	lanch2
     768/     270 : A4 02               	dw	lanch3
     769/     272 : C3 02               	dw	lanch4
     770/     274 : E4 02               	dw	lanch5
     771/     276 : F8 02               	dw	lanch6
     772/     278 :                     ;	dw	lanch7
     773/     278 :                     ;	dw	lanch8
     774/     278 :                     ;	dw	lanch9
     775/     278 :                     ;	dw	lanch10
     776/     278 :                     ;	dw	lanch11
     777/     278 :                     ;	dw	lanch12
     778/     278 :                     ;	dw	lanch13
     779/     278 :                     ;	dw	lanch14
     780/     278 :                     ;	dw	lanch15
     781/     278 :                     ;	dw	lanch16
     782/     278 : 00 00               	dw	0
     783/     27A :                     	
     784/     27A :                     lanch1:
     785/     27A : 00 2F               	dw	BASIC_CST
     786/     27C : 31 2E 20 47 42 41   	DB	"1. GBASIC Start",CR,LF,00H
              282 : 53 49 43 20 53 74 
              288 : 61 72 74 0D 0A 00 
     787/     28E :                     lanch2:
     788/     28E : 03 2F               	dw	BASIC_WST
     789/     290 : 32 2E 20 47 42 41   	DB	"2. GBASIC Restart",CR,LF,00H
              296 : 53 49 43 20 52 65 
              29C : 73 74 61 72 74 0D 
              2A2 : 0A 00             
     790/     2A4 :                     
     791/     2A4 :                     lanch3:
     792/     2A4 : 00 4C               	dw	POTB_CST
     793/     2A6 : 33 2E 20 50 61 6C   	DB	"3. PaloAltoTinyBASIC Start",CR,LF,00H
              2AC : 6F 41 6C 74 6F 54 
              2B2 : 69 6E 79 42 41 53 
              2B8 : 49 43 20 53 74 61 
              2BE : 72 74 0D 0A 00    
     794/     2C3 :                     		
     795/     2C3 :                     lanch4:
     796/     2C3 : 03 4C               	dw	POTB_WST
     797/     2C5 : 34 2E 20 50 61 6C   	DB	"4. PaloAltoTinyBASIC Restart",CR,LF,00H
              2CB : 6F 41 6C 74 6F 54 
              2D1 : 69 6E 79 42 41 53 
              2D7 : 49 43 20 52 65 73 
              2DD : 74 61 72 74 0D 0A 
              2E3 : 00                
     798/     2E4 :                     
     799/     2E4 :                     lanch5:
     800/     2E4 : 00 54               	dw	GAME80_CST
     801/     2E6 : 35 2E 20 47 41 4D   	DB	"5. GAME80 Start",CR,LF,00H
              2EC : 45 38 30 20 53 74 
              2F2 : 61 72 74 0D 0A 00 
     802/     2F8 :                     		
     803/     2F8 :                     lanch6:
     804/     2F8 : 00 54               	dw	GAME80_CST
     805/     2FA : 36 2E 20 47 41 4D   	DB	"6. GAME80 Restart",CR,LF,00H
              300 : 45 38 30 20 52 65 
              306 : 73 74 61 72 74 0D 
              30C : 0A 00             
     806/     30E :                     		
     807/     30E :                     ;lanch7:
     808/     30E :                     ;lanch8:
     809/     30E :                     ;lanch9:
     810/     30E :                     ;lanch10:
     811/     30E :                     ;lanch11:
     812/     30E :                     ;lanch12:
     813/     30E :                     ;lanch13:
     814/     30E :                     ;lanch14:
     815/     30E :                     ;lanch15:
     816/     30E :                     ;lanch16:
     817/     30E :                     ;	dw	0
     818/     30E :                     
     819/     30E :                     GET_dNUM:
     820/     30E : D5                  	push	de
     821/     30F : E5                  	push	hl
     822/     310 : CD 16 03            	call	GET_NUM
     823/     313 : E1                  	pop	hl
     824/     314 : D1                  	pop	de
     825/     315 : C9                  	ret
     826/     316 :                     
     827/     316 :                     	; get number
     828/     316 :                     	; input HL : string buffer
     829/     316 :                     	;
     830/     316 :                     	; Return
     831/     316 :                     	; CF =1 : Error
     832/     316 :                     	; BC: Calculation result
     833/     316 :                     
     834/     316 :                     GET_NUM:
     835/     316 : AF                  	XOR	A		; Initialize C
     836/     317 : 47                  	LD	B, A
     837/     318 : 4F                  	LD	C, A		; clear BC
     838/     319 :                     	
     839/     319 :                     GET_NUM0:
     840/     319 : CD 05 27            	CALL	SKIPSP		; A <- next char
     841/     31C : B7                  	OR	A
     842/     31D : C8                  	RET	Z		; ZF=1, ok! buffer end
     843/     31E :                     
     844/     31E : CD 38 03            	CALL	GET_BI
     845/     321 : D8                  	RET	C
     846/     322 :                     
     847/     322 : F5                  	push	af
     848/     323 : 08                  	EX	AF, AF'		;'AF <> AF: save A
     849/     324 : F1                  	pop	af
     850/     325 : CD 47 03            	CALL	MUL_10		; BC = BC * 10
     851/     328 : D8                  	RET	C		; overflow error
     852/     329 : 08                  	EX	AF, AF'		;'AF <> AF: restor A
     853/     32A :                     
     854/     32A : E5                  	push	hl
     855/     32B : 16 00               	ld	d, 0
     856/     32D : 5F                  	ld	e, a
     857/     32E :                     
     858/     32E : 60                  	ld	h, b
     859/     32F : 69                  	ld	l, c
     860/     330 : 19                  	add	hl, de
     861/     331 : 44                  	ld	b, h
     862/     332 : 4D                  	ld	c, l		; result: BC = BC * 10 + A
     863/     333 : E1                  	pop	hl
     864/     334 : D8                  	RET	C		; overflow error
     865/     335 :                     				; result: BC = BC * 10 + A
     866/     335 : 23                  	INC	HL
     867/     336 : 18 E1               	JR	GET_NUM0
     868/     338 :                     ;
     869/     338 :                     ; Make binary to A
     870/     338 :                     ; ERROR if CF=1
     871/     338 :                     ;
     872/     338 :                     GET_BI:
     873/     338 : B7                  	OR	A
     874/     339 : 28 0A               	JR	Z, UP_BI
     875/     33B : FE 30               	CP	'0'
     876/     33D : D8                  	RET	C
     877/     33E :                     	
     878/     33E : FE 3A               	CP	'9'+1	; ASCII':'
     879/     340 : 30 03               	JR	NC, UP_BI
     880/     342 : D6 30               	SUB	'0'	; Make binary to A
     881/     344 : C9                  	RET
     882/     345 :                     
     883/     345 :                     UP_BI:
     884/     345 : 37                  	SCF		; Set CF
     885/     346 : C9                  	RET
     886/     347 :                     
     887/     347 :                     ;
     888/     347 :                     ; multiply by 10
     889/     347 :                     ; BC = BC * 10
     890/     347 :                     MUL_10:
     891/     347 : E5                  	push	hl
     892/     348 :                     
     893/     348 : C5                  	push	bc
     894/     349 : CB 21               	SLA	C
     895/     34B : CB 10               	RL	B		; 2BC
     896/     34D : CB 21               	SLA	C
     897/     34F : CB 10               	RL	B		; 4BC
     898/     351 : E1                  	pop	hl		; hl = bc
     899/     352 : 09                  	add	hl, bc
     900/     353 : E5                  	push	hl
     901/     354 : C1                  	pop	bc		; 5BC
     902/     355 : CB 21               	SLA	C
     903/     357 : CB 10               	RL	B		; 10BC
     904/     359 :                     
     905/     359 : E1                  	pop	hl
     906/     35A : C9                  	RET			; result : BC = BC * 10
     907/     35B :                     ;
     908/     35B :                     ; list break point
     909/     35B :                     ;
     910/     35B :                     b_list:
     911/     35B : 3A FE FE            	ld	a, (bpt1_f)
     912/     35E : B7                  	or	a
     913/     35F : 28 08               	jr	z, b_list1
     914/     361 :                     
     915/     361 : 2A 00 FF            	ld	hl, (bpt1_adr)
     916/     364 : 3E 31               	ld	a, '1'
     917/     366 : CD 11 04            	call	b_msg_out
     918/     369 :                     
     919/     369 :                     b_list1:
     920/     369 : 3A 02 FF            	ld	a, (bpt2_f)
     921/     36C : B7                  	or	a
     922/     36D : CA CB 01            	jp	z, WSTART
     923/     370 :                     
     924/     370 : 2A 04 FF            	ld	hl, (bpt2_adr)
     925/     373 : 3E 32               	ld	a, '2'
     926/     375 : CD 11 04            	call	b_msg_out
     927/     378 : C3 CB 01            	JP	WSTART
     928/     37B :                     
     929/     37B :                     
     930/     37B :                     ;;; 
     931/     37B :                     ;;; break point command
     932/     37B :                     ;;; 
     933/     37B :                     brk_cmd:
     934/     37B : 23                  	INC	HL
     935/     37C : CD 05 27            	CALL	SKIPSP		; A <- next char
     936/     37F : B7                  	OR	A
     937/     380 : 28 D9               	JR	Z,b_list	; only type "B"
     938/     382 :                     
     939/     382 : 01 FE FE            	ld	bc, bpt1_f
     940/     385 : FE 31               	cp	'1'
     941/     387 : 28 0E               	jr	z, set_bp1
     942/     389 :                     
     943/     389 : 01 02 FF            	ld	bc, bpt2_f
     944/     38C : FE 32               	cp	'2'
     945/     38E : 28 07               	jr	z, set_bp1
     946/     390 :                     
     947/     390 : FE 43               	cp	'C'	;clear?
     948/     392 : 28 39               	jr	z, bp_clr
     949/     394 : C3 17 02            	jp	ERR
     950/     397 :                     
     951/     397 :                     set_bp1:
     952/     397 : 08                  	EX	AF, AF'		;'
     953/     398 :                     
     954/     398 : 23                  	INC	HL
     955/     399 : CD 05 27            	CALL	SKIPSP		; A <- next char
     956/     39C : B7                  	OR	A
     957/     39D : 28 55               	JR	Z, bp_LOT 	;; No address input -> list out
     958/     39F : FE 2C               	cp	','
     959/     3A1 : C2 17 02            	jp	nz, ERR
     960/     3A4 :                     
     961/     3A4 : 23                  	INC	HL
     962/     3A5 : CD 05 27            	CALL	SKIPSP
     963/     3A8 : C5                  	push	bc
     964/     3A9 : CD 15 27            	CALL	RDHEX		; 1st arg.
     965/     3AC : E1                  	pop	hl		; hl <- bc
     966/     3AD : DA 17 02            	jp	c, ERR
     967/     3B0 :                     
     968/     3B0 : CD B9 03            	call	setbpadr
     969/     3B3 : DA 17 02            	jp	c, ERR
     970/     3B6 : C3 CB 01            	JP	WSTART
     971/     3B9 :                     
     972/     3B9 :                     
     973/     3B9 :                     ; hl : point of bp flag( bpt1_f or bpt2_f)
     974/     3B9 :                     ; de : break point address
     975/     3B9 :                     
     976/     3B9 :                     ; check ram area, and set berak point
     977/     3B9 :                     ; 
     978/     3B9 :                     setbpadr:
     979/     3B9 : 7A                  	ld	a, d
     980/     3BA : FE 80               	cp	RAM_B >> 8		; a - 080H
     981/     3BC : DA CB 03            	jp	c, chkERR		; ROM area
     982/     3BF :                     ;	cp	(RAM_E + 1)  >> 8	; a - 0C0H
     983/     3BF :                     ;	jp	nc, chkERR		; No RAM area
     984/     3BF : 3E 01               	ld	a,1
     985/     3C1 : 77                  	ld	(hl), a	; set flag
     986/     3C2 : 23                  	inc	hl
     987/     3C3 : 1A                  	ld	a, (de)		; get opcode
     988/     3C4 : 77                  	ld	(hl), a		; save opcode
     989/     3C5 : 23                  	inc	hl
     990/     3C6 : 73                  	ld	(hl), e ; set break point low address
     991/     3C7 : 23                  	inc	hl
     992/     3C8 : 72                  	ld	(hl), d ; set break point high address
     993/     3C9 : B7                  	or	a	; reset carry
     994/     3CA : C9                  	ret
     995/     3CB :                     
     996/     3CB :                     chkERR:
     997/     3CB : 37                  	scf	;set carry
     998/     3CC : C9                  	ret
     999/     3CD :                     
    1000/     3CD :                     ; clear break point
    1001/     3CD :                     
    1002/     3CD :                     bp_clr:
    1003/     3CD : 23                  	INC	HL
    1004/     3CE : CD 05 27            	CALL	SKIPSP		; A <- next char
    1005/     3D1 : B7                  	OR	A
    1006/     3D2 : 28 14               	JR	Z,b_aclr	; all clear
    1007/     3D4 :                     
    1008/     3D4 : 01 FE FE            	ld	bc, bpt1_f
    1009/     3D7 : FE 31               	cp	'1'
    1010/     3D9 : 28 08               	jr	z, bp_clr1
    1011/     3DB :                     
    1012/     3DB : 01 02 FF            	ld	bc, bpt2_f
    1013/     3DE : FE 32               	cp	'2'
    1014/     3E0 : C2 17 02            	jp	nz, ERR
    1015/     3E3 :                     
    1016/     3E3 :                     bp_clr1:
    1017/     3E3 : AF                  	xor	a
    1018/     3E4 : 02                  	ld	(bc), a
    1019/     3E5 : C3 CB 01            	JP	WSTART
    1020/     3E8 :                     
    1021/     3E8 :                     b_aclr:
    1022/     3E8 : AF                  	xor	a
    1023/     3E9 : 01 FE FE            	ld	bc, bpt1_f
    1024/     3EC : 02                  	ld	(bc), a
    1025/     3ED : 01 02 FF            	ld	bc, bpt2_f
    1026/     3F0 : 02                  	ld	(bc), a
    1027/     3F1 : C3 CB 01            	JP	WSTART
    1028/     3F4 :                     
    1029/     3F4 :                     ; when no address input. list out BP
    1030/     3F4 :                     ;
    1031/     3F4 :                     ; bc : break pointer buffer offset
    1032/     3F4 :                     bp_LOT:
    1033/     3F4 : 0A                  	ld	a, (bc)		; set break point?
    1034/     3F5 : B7                  	or	a
    1035/     3F6 : CA CB 01            	jp	z, WSTART	; no break point setting
    1036/     3F9 :                     
    1037/     3F9 : 08                  	EX	AF, AF'		;'
    1038/     3FA : 2A 00 FF            	ld	hl, (bpt1_adr)
    1039/     3FD : FE 31               	cp	'1'
    1040/     3FF : 28 03               	jr	z, l_b2
    1041/     401 : 2A 04 FF            	ld	hl, (bpt2_adr)
    1042/     404 :                     l_b2:
    1043/     404 : CD 11 04            	call	b_msg_out
    1044/     407 : C3 CB 01            	JP	WSTART
    1045/     40A :                     
    1046/     40A : 42 50 28 00         bp_msg1:	db	"BP(",00H
    1047/     40E : 29 3A 00            bp_msg2:	db	"):",00H
    1048/     411 :                     
    1049/     411 :                     b_msg_out:
    1050/     411 : E5                  	push	hl
    1051/     412 : F5                  	push	af
    1052/     413 : 21 0A 04            	ld	hl, bp_msg1
    1053/     416 : CD 1B 26            	call	STROUT
    1054/     419 : F1                  	pop	af
    1055/     41A : CD 8B 2E            	call	CONOUT
    1056/     41D : 21 0E 04            	ld	hl, bp_msg2
    1057/     420 : CD 1B 26            	call	STROUT
    1058/     423 : E1                  	pop	hl
    1059/     424 : CD 24 26            	call	HEXOUT4
    1060/     427 : CD 64 26            	call	CRLF	
    1061/     42A : C9                  	ret
    1062/     42B :                     
    1063/     42B :                     ;;; 
    1064/     42B :                     ;;; trace command
    1065/     42B :                     ;;; 
    1066/     42B :                     trace_cmd:
    1067/     42B :                     
    1068/     42B :                     ; T[address][,step数]
    1069/     42B :                     ; TP[ON | OFF]
    1070/     42B :                     ; TM[I | S]
    1071/     42B :                     
    1072/     42B :                     ; init steps
    1073/     42B : E5                  	push	hl
    1074/     42C : 2E 00               	ld	l, 0
    1075/     42E : 26 00               	ld	h, 0
    1076/     430 : 22 16 FF            	ld	(TC_cnt), hl	; clear trace step counter to 0
    1077/     433 : 2A F2 FE            	ld	hl,(REGPC)
    1078/     436 : 22 18 FF            	ld	(tmpT), hl	; init temp address
    1079/     439 : AF                  	xor	a
    1080/     43A : 32 1A FF            	ld	(fever_t), a	; clear flag trace forever
    1081/     43D :                     
    1082/     43D : E1                  	pop	hl
    1083/     43E : 23                  	inc	hl
    1084/     43F : CD 05 27            	CALL	SKIPSP
    1085/     442 : CD 15 27            	CALL	RDHEX		; 1st arg.
    1086/     445 : D2 F1 04            	jp	nc, tadr_chk
    1087/     448 : CD 05 27            	CALL	SKIPSP
    1088/     44B : 7E                  	ld	a, (hl)
    1089/     44C : B7                  	or	a
    1090/     44D : CA 1A 05            	Jp	z, t_op1	; only 1 step trace, check opcode
    1091/     450 : FE 2C               	cp	','
    1092/     452 : CA 02 05            	jp	z, stp_chk	; steps check
    1093/     455 :                     
    1094/     455 : FE 50               	cp	'P'
    1095/     457 : 28 4E               	jr	z, tp_cmd
    1096/     459 : FE 4D               	cp	'M'
    1097/     45B : C2 17 02            	jp	nz, ERR
    1098/     45E :                     	
    1099/     45E :                     	; tm_cmd
    1100/     45E :                     	
    1101/     45E : 23                  	inc	hl
    1102/     45F : CD 05 27            	CALL	SKIPSP		; A <- next char
    1103/     462 :                     dip_TM:
    1104/     462 : 21 99 04            	ld	hl, tm_msg_i
    1105/     465 : FE 49               	cp	'I'
    1106/     467 : 28 10               	jr	z, set_TM
    1107/     469 : 21 9F 04            	ld	hl, tm_msg_s
    1108/     46C : FE 53               	cp	'S'
    1109/     46E : 28 09               	jr	z, set_TM
    1110/     470 : B7                  	or	a
    1111/     471 : C2 17 02            	jp	nz, ERR
    1112/     474 :                     
    1113/     474 :                     ;display T mode
    1114/     474 : 3A 15 FF            	ld	a, (TM_mode)
    1115/     477 : 18 E9               	jr	dip_TM
    1116/     479 :                     
    1117/     479 :                     ;set TM mode and display
    1118/     479 :                     set_TM:
    1119/     479 : 32 15 FF            	ld	(TM_mode),a
    1120/     47C : E5                  	push	hl
    1121/     47D : 21 8A 04            	ld	hl, tm_msg_0
    1122/     480 : CD 1B 26            	call	STROUT
    1123/     483 : E1                  	pop	hl
    1124/     484 : CD 1B 26            	call	STROUT
    1125/     487 : C3 CB 01            	jp	WSTART
    1126/     48A :                     
    1127/     48A :                     tm_msg_0:
    1128/     48A : 54 4D 20 6D 6F 64   	db	"TM mode:<CALL ", 00h
              490 : 65 3A 3C 43 41 4C 
              496 : 4C 20 00          
    1129/     499 :                     tm_msg_i:
    1130/     499 : 49 4E 3E 0D 0A 00   	db	"IN>", CR, LF, 00h
    1131/     49F :                     tm_msg_s:
    1132/     49F : 53 4B 49 50 3E 0D   	db	"SKIP>", CR, LF, 00h
              4A5 : 0A 00             
    1133/     4A7 :                     	
    1134/     4A7 :                     	
    1135/     4A7 :                     	; tp_cmd
    1136/     4A7 :                     tp_cmd:	
    1137/     4A7 : 23                  	inc	hl
    1138/     4A8 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1139/     4AB : B7                  	or	a
    1140/     4AC : 20 05               	jr	nz, tp_n1
    1141/     4AE : 3A 14 FF            	ld	a, (TP_mode)
    1142/     4B1 : 18 09               	jr	tp_n2
    1143/     4B3 :                     	
    1144/     4B3 :                     tp_n1:
    1145/     4B3 : FE 4F               	cp	'O'
    1146/     4B5 : C2 17 02            	jp	nz, ERR
    1147/     4B8 : 23                  	inc	hl
    1148/     4B9 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1149/     4BC :                     
    1150/     4BC :                     tp_n2:
    1151/     4BC : 21 E6 04            	ld	hl, tp_msg_on
    1152/     4BF : FE 4E               	cp	'N'
    1153/     4C1 : 28 08               	jr	z, tp_md_on
    1154/     4C3 :                     
    1155/     4C3 : 21 EB 04            	ld	hl, tp_msg_off
    1156/     4C6 : FE 46               	cp	'F'
    1157/     4C8 : C2 17 02            	jp	nz, ERR
    1158/     4CB :                     
    1159/     4CB :                     tp_md_on:
    1160/     4CB :                     	; set trace mode and display mode
    1161/     4CB : 32 14 FF            	ld	(TP_mode), a
    1162/     4CE : E5                  	push	hl
    1163/     4CF : 21 DC 04            	ld	hl, tp_msg_0
    1164/     4D2 : CD 1B 26            	call	STROUT
    1165/     4D5 : E1                  	pop	hl
    1166/     4D6 : CD 1B 26            	call	STROUT
    1167/     4D9 : C3 CB 01            	jp	WSTART
    1168/     4DC :                     	
    1169/     4DC :                     tp_msg_0:
    1170/     4DC : 54 50 20 6D 6F 64   	db	"TP mode: ", 00h
              4E2 : 65 3A 20 00       
    1171/     4E6 :                     tp_msg_on:
    1172/     4E6 : 4F 4E 0D 0A 00      	db	"ON", CR, LF, 00h
    1173/     4EB :                     tp_msg_off:
    1174/     4EB : 4F 46 46 0D 0A 00   	db	"OFF", CR, LF, 00h
    1175/     4F1 :                     
    1176/     4F1 :                     tadr_chk:
    1177/     4F1 : ED 53 18 FF         	ld	(tmpT), de	; set start address
    1178/     4F5 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1179/     4F8 : B7                  	or	a
    1180/     4F9 : 28 1F               	jr	z, t_op1	; 1step trace
    1181/     4FB : FE 2C               	cp	','
    1182/     4FD : 28 03               	jr	z, stp_chk
    1183/     4FF : C3 17 02            	jp	ERR
    1184/     502 :                     
    1185/     502 :                     stp_chk:
    1186/     502 : 23                  	inc	hl
    1187/     503 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1188/     506 : B7                  	or	a
    1189/     507 : CA 17 02            	jp	z, ERR
    1190/     50A : FE 2D               	cp	'-'
    1191/     50C : 28 11               	jr	z, chk_fevre
    1192/     50E :                     
    1193/     50E :                     ; check steps
    1194/     50E :                     
    1195/     50E : CD 16 03            	call	GET_NUM		; get steps to BC
    1196/     511 : DA 17 02            	JP	C, ERR		; number error
    1197/     514 :                     
    1198/     514 :                     t_op11:
    1199/     514 : ED 43 16 FF         	ld	(TC_cnt), bc	; set trace step counter
    1200/     518 : 18 1B               	jr	t_op_chk
    1201/     51A :                     
    1202/     51A :                     t_op1:
    1203/     51A : 01 01 00            	ld	bc, 1
    1204/     51D : 18 F5               	jr	t_op11
    1205/     51F :                     
    1206/     51F :                     chk_fevre:
    1207/     51F : 23                  	inc	hl
    1208/     520 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1209/     523 : FE 31               	cp	'1'
    1210/     525 : C2 17 02            	jp	nz, ERR
    1211/     528 : 23                  	inc	hl
    1212/     529 : CD 05 27            	CALL	SKIPSP		; A <- next char
    1213/     52C : B7                  	or	a
    1214/     52D : C2 17 02            	jp	nz, ERR		; not "-1" then error
    1215/     530 : 3E 01               	ld	a, 1
    1216/     532 : 32 1A FF            	ld	(fever_t), a	; set flag trace forever
    1217/     535 :                     
    1218/     535 :                     t_op_chk:
    1219/     535 : 2A 18 FF            	ld	hl, (tmpT)	; get PC address
    1220/     538 : 7E                  	ld	a, (hl)		; get opcode
    1221/     539 :                     	
    1222/     539 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1223/     539 :                     ;;;
    1224/     539 :                     ;;; branch opecode check
    1225/     539 :                     ;;;
    1226/     539 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1227/     539 :                     
    1228/     539 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1229/     539 :                     ; 2 insertion Trace code(TC) 
    1230/     539 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1231/     539 :                     INSTC2:
    1232/     539 :                     	; check 1 byte machine code: branch (RET CC)
    1233/     539 :                     
    1234/     539 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    1235/     53C : 21 D2 06            	ld	hl, RETCC_TBLS
    1236/     53F : ED B1               	cpir
    1237/     541 : 20 13               	jr	nz, next_bc1	; not RET CC
    1238/     543 :                     
    1239/     543 :                     	; RET CC
    1240/     543 :                     	; trace operation:
    1241/     543 :                     	;   1. ea = *REGSP; *ea = TC;
    1242/     543 :                     	;   2. ea = *REGPC; *(ea+1) = TC;
    1243/     543 :                     
    1244/     543 :                     	; 1
    1245/     543 : 0E 01               	ld	c, 1		; first TC point
    1246/     545 : CD 9B 06            	call	insBRK_sp
    1247/     548 : DA 5A 06            	jp	c, err_trace_seq
    1248/     54B :                     	
    1249/     54B :                     	; 2
    1250/     54B : 0E 02               	ld	c, 2		; second TC point
    1251/     54D : CD 7B 06            	call	insBRK_1op
    1252/     550 : DA 5A 06            	jp	c, err_trace_seq
    1253/     553 :                     
    1254/     553 : C3 57 06            	jp	END_INS_TC
    1255/     556 :                     
    1256/     556 :                     	; check 2 byte machine code: branch (JR CC, Relative Value)
    1257/     556 :                     next_bc1:
    1258/     556 :                     
    1259/     556 : 01 05 00            	ld	bc, JRCC_TBLE - JRCC_TBLS
    1260/     559 : 21 DA 06            	ld	hl, JRCC_TBLS
    1261/     55C : ED B1               	cpir
    1262/     55E : 20 19               	jr	nz, next_bc2	; not JR CC
    1263/     560 :                     
    1264/     560 :                     	; JR CC, nn
    1265/     560 :                     	; trace operation:
    1266/     560 :                     	;   1. ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1267/     560 :                     	;   2. ea = *REGPC; *(ea+2) = TC;
    1268/     560 :                     
    1269/     560 :                     	; 1
    1270/     560 : 0E 01               	ld	c, 1		; first TC point
    1271/     562 : 2A 18 FF            	ld	hl, (tmpT)
    1272/     565 : CD 6E 06            	call	Rel_adr_c
    1273/     568 : CD A8 06            	call	inadr_chk_and_wrt
    1274/     56B : DA 5A 06            	jp	c, err_trace_seq
    1275/     56E :                     
    1276/     56E :                     	; 2
    1277/     56E : 0E 02               	ld	c, 2		; second TC point
    1278/     570 : CD 80 06            	call	insBRK_2op
    1279/     573 : DA 5A 06            	jp	c, err_trace_seq
    1280/     576 :                     
    1281/     576 : C3 57 06            	jp	END_INS_TC
    1282/     579 :                     
    1283/     579 :                     	; check 3 byte machine code: branch JP CC, nnnn 16bit literal)
    1284/     579 :                     
    1285/     579 :                     next_bc2:
    1286/     579 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    1287/     57C : 21 DF 06            	ld	hl, JPCC_TBLS
    1288/     57F : ED B1               	cpir
    1289/     581 : 20 04               	jr	nz, next_bc21		; not JP CCC
    1290/     583 :                     
    1291/     583 :                     	; JP CC, nnnn
    1292/     583 :                     	; trace operation:
    1293/     583 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1294/     583 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1295/     583 :                     
    1296/     583 : 0E 01               	ld	c, 1		; first TC point
    1297/     585 : 18 13               	jr	next_bc222
    1298/     587 :                     
    1299/     587 :                     	; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    1300/     587 :                     
    1301/     587 :                     next_bc21:
    1302/     587 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    1303/     58A : 21 E7 06            	ld	hl, CLCC_TBLS
    1304/     58D : ED B1               	cpir
    1305/     58F : 20 1A               	jr	nz, INSTC1		; not CALL CCC
    1306/     591 :                     
    1307/     591 :                     	; CALL CC, nnnn
    1308/     591 :                     	; trace operation:
    1309/     591 :                     	; TM_mode = 'I'
    1310/     591 :                     	;   1. ea = *REGPC; *((short *)(ea+1)) = TC;
    1311/     591 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1312/     591 :                     	;
    1313/     591 :                     	; TM_mode = 'S'
    1314/     591 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1315/     591 :                     
    1316/     591 : 0E 01               	ld	c, 1		; first TC point
    1317/     593 : 3A 15 FF            	ld	a, (TM_mode)
    1318/     596 : FE 53               	cp	'S'
    1319/     598 : 28 08               	jr	z, next_bc22	; skip insertion 1.
    1320/     59A :                     
    1321/     59A :                     next_bc222:
    1322/     59A :                     	; 1. ea = *REGPC; *((char *)(ea+1)) = TC;
    1323/     59A : CD 8F 06            	call	insBRK_brp
    1324/     59D : DA 5A 06            	jp	c, err_trace_seq
    1325/     5A0 :                     	
    1326/     5A0 :                     next_bc221:
    1327/     5A0 :                     	; 2. ea = *REGPC; *(ea+3) = TC;
    1328/     5A0 : 0E 02               	ld	c, 2		; second TC point
    1329/     5A2 :                     next_bc22:
    1330/     5A2 : CD 85 06            	call	insBRK_3op
    1331/     5A5 : DA 5A 06            	jp	c, err_trace_seq
    1332/     5A8 :                     
    1333/     5A8 : C3 57 06            	jp	END_INS_TC
    1334/     5AB :                     
    1335/     5AB :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1336/     5AB :                     ; 1 insertion Trace code(TC) 
    1337/     5AB :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1338/     5AB :                     INSTC1:
    1339/     5AB :                     	; check 1 byte machine code: branch (return)
    1340/     5AB : FE C9               	cp	0C9H		; RET ?
    1341/     5AD : 20 0B               	jr	nz, next_bc3	; not RET
    1342/     5AF :                     
    1343/     5AF :                     	; RET
    1344/     5AF :                     	; trace operation:
    1345/     5AF :                     	;   ea = *REGSP; *ea = TC;
    1346/     5AF : 0E 01               	ld	c, 1		; first TC point
    1347/     5B1 : CD 9B 06            	call	insBRK_sp
    1348/     5B4 : DA 5A 06            	jp	c, err_trace_seq
    1349/     5B7 : C3 57 06            	jp	END_INS_TC
    1350/     5BA :                     
    1351/     5BA :                     	; check RST p
    1352/     5BA :                     next_bc3:
    1353/     5BA : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    1354/     5BD : 21 EF 06            	ld	hl, RST_TBLS
    1355/     5C0 : ED B1               	cpir
    1356/     5C2 : 20 0B               	jr	nz, next_bc4		; not RST p
    1357/     5C4 :                     
    1358/     5C4 :                     	; RST p
    1359/     5C4 :                     	; can't trace: skip trace
    1360/     5C4 :                     	; trace operation:
    1361/     5C4 :                     	;   ea = *REGPC; *(ea+1) = TC;
    1362/     5C4 :                     ;	ld	hl, RST_DMSG
    1363/     5C4 :                     ;	call	STROUT		; message out "DETECT RST OPCODE"
    1364/     5C4 : 0E 01               	ld	c, 1		; first TC point
    1365/     5C6 : CD 7B 06            	call	insBRK_1op
    1366/     5C9 : DA 5A 06            	jp	c, err_trace_seq
    1367/     5CC :                     	
    1368/     5CC : C3 57 06            	jp	END_INS_TC
    1369/     5CF :                     
    1370/     5CF :                     ;RST_DMSG:
    1371/     5CF :                     ;	db	"(RST nn) WILL BE SKIPPED. AND TRACE NEXT OPCODE", CR, LF,00
    1372/     5CF :                     
    1373/     5CF :                     	; check code 0EDH
    1374/     5CF :                     next_bc4:
    1375/     5CF : FE ED               	cp	0EDH		; CODE 0EDH ?
    1376/     5D1 : 20 13               	jr	nz, next_bc5	; not 0EDH
    1377/     5D3 :                     
    1378/     5D3 : 23                  	inc	hl
    1379/     5D4 : 7E                  	ld	a, (hl)
    1380/     5D5 : FE 45               	cp	45H		; RETN?
    1381/     5D7 : 28 04               	jr	z, next_bc6	; yes, RETN
    1382/     5D9 : FE 4D               	cp	4DH		; RETI?
    1383/     5DB : 20 09               	jr	nz, next_bc5	; not RETN
    1384/     5DD :                     
    1385/     5DD :                     	; trace operation:
    1386/     5DD :                     	;   ea = *REGSP; *ea = TC;
    1387/     5DD :                     next_bc6:
    1388/     5DD : 0E 01               	ld	c, 1		; first TC point
    1389/     5DF : CD 9B 06            	call	insBRK_sp
    1390/     5E2 : 38 76               	jr	c, err_trace_seq
    1391/     5E4 : 18 71               	jr	END_INS_TC
    1392/     5E6 :                     
    1393/     5E6 :                     	; check JP (HL)
    1394/     5E6 :                     next_bc5:
    1395/     5E6 : 2A 18 FF            	ld	hl, (tmpT)
    1396/     5E9 : 7E                  	ld	a, (hl)
    1397/     5EA :                     
    1398/     5EA : FE E9               	cp	0E9H		; JP (HL) ?
    1399/     5EC : 20 0C               	jr	nz, next_bc7	; not JP (HL)
    1400/     5EE :                     
    1401/     5EE :                     	; JP (HL)
    1402/     5EE :                     	; trace operation:
    1403/     5EE :                     	;   ea = *REGHL; *ea = TC;
    1404/     5EE : 2A E2 FE            	ld	hl, (REGHL)
    1405/     5F1 :                     djphl:
    1406/     5F1 : 0E 01               	ld	c, 1		; first TC point
    1407/     5F3 : CD A8 06            	call	inadr_chk_and_wrt
    1408/     5F6 : 38 62               	jr	c, err_trace_seq
    1409/     5F8 : 18 5D               	jr	END_INS_TC
    1410/     5FA :                     
    1411/     5FA :                     	; check JP (IX)
    1412/     5FA :                     next_bc7:
    1413/     5FA : FE DD               	cp	0DDH		; 1st OPOCDE 0DDH ?
    1414/     5FC : 20 0B               	jr	nz, next_bc8	; no 0DDH
    1415/     5FE : 23                  	inc	hl
    1416/     5FF : 7E                  	ld	a, (hl)
    1417/     600 : FE E9               	cp	0E9H		; JP (IX) ?
    1418/     602 : 20 05               	jr	nz, next_bc8	; not JP (IX)
    1419/     604 :                     
    1420/     604 :                     	; JP (IX)
    1421/     604 :                     	; trace operation:
    1422/     604 :                     	;   ea = *REGIX; *ea = TC;
    1423/     604 : 2A EC FE            	ld	hl, (REGIX)
    1424/     607 : 18 E8               	jr	djphl
    1425/     609 :                     
    1426/     609 :                     	; check JP (IY)
    1427/     609 :                     next_bc8:
    1428/     609 : 2A 18 FF            	ld	hl, (tmpT)
    1429/     60C : 7E                  	ld	a, (hl)
    1430/     60D :                     
    1431/     60D : FE FD               	cp	0FDH		; 1st OPOCDE 0FDH ?
    1432/     60F : 20 0B               	jr	nz, next_bc9	; no 0FDH
    1433/     611 : 23                  	inc	hl
    1434/     612 : 7E                  	ld	a, (hl)
    1435/     613 : FE E9               	cp	0E9H		; JP (IX) ?
    1436/     615 : 20 05               	jr	nz, next_bc9	; not JP (IX)
    1437/     617 :                     
    1438/     617 :                     	; JP (IY)
    1439/     617 :                     	; trace operation:
    1440/     617 :                     	;   ea = *REGIY; *ea = TC;
    1441/     617 : 2A EE FE            	ld	hl, (REGIY)
    1442/     61A : 18 D5               	jr	djphl
    1443/     61C :                     
    1444/     61C :                     	; check JR relative
    1445/     61C :                     next_bc9:
    1446/     61C : 2A 18 FF            	ld	hl, (tmpT)
    1447/     61F : 7E                  	ld	a, (hl)
    1448/     620 : FE 18               	cp	18H		; JR relative ?
    1449/     622 : 20 0C               	jr	nz, next_bc10	; not JR relative
    1450/     624 :                     
    1451/     624 :                     	; JR Relative
    1452/     624 :                     	; trace operation:
    1453/     624 :                     	;   ea = *REGPC; *(ea + 2 + *(ea+1)) = TC;
    1454/     624 : 0E 01               	ld	c, 1		; first TC point
    1455/     626 : CD 6E 06            	call	Rel_adr_c
    1456/     629 : CD A8 06            	call	inadr_chk_and_wrt
    1457/     62C : 38 2C               	jr	c, err_trace_seq
    1458/     62E : 18 27               	jr	END_INS_TC
    1459/     630 :                     
    1460/     630 :                     	; check JP literal
    1461/     630 :                     next_bc10:
    1462/     630 : FE C3               	cp	0C3H		; JP literal ?
    1463/     632 : 20 09               	jr	nz, next_bc11	; not JP literal
    1464/     634 :                     
    1465/     634 :                     	; JP literal
    1466/     634 :                     	; trace operation:
    1467/     634 :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1468/     634 : 0E 01               	ld	c, 1		; first TC point
    1469/     636 : CD 8F 06            	call	insBRK_brp
    1470/     639 : 38 1F               	jr	c, err_trace_seq
    1471/     63B : 18 1A               	jr	END_INS_TC
    1472/     63D :                     
    1473/     63D :                     	; check call literal
    1474/     63D :                     next_bc11:
    1475/     63D : FE CD               	cp	0CDH		; CALL literal ?
    1476/     63F : C2 F7 06            	jp	nz, INS2	; no, check not branch opcode 
    1477/     642 :                     
    1478/     642 :                     	; CALL literal
    1479/     642 :                     	; trace operation:
    1480/     642 :                     	; TM_mode = 'I'
    1481/     642 :                     	;   ea = *REGPC; *((short *)(ea+1)) = TC;
    1482/     642 :                     	; TM_mode = 'S'
    1483/     642 :                     	;   2. ea = *REGPC; *(ea+3) = TC;
    1484/     642 :                     
    1485/     642 : 0E 01               	ld	c, 1		; first TC point
    1486/     644 : 3A 15 FF            	ld	a, (TM_mode)
    1487/     647 : FE 53               	cp	'S'
    1488/     649 : 28 07               	jr	z, next_bc111	; yes, TM_mode='S'
    1489/     64B :                     
    1490/     64B :                     	; TM_mode = 'I'
    1491/     64B :                     	; ea = *REGPC; *((char *)(ea+1)) = TC;
    1492/     64B : CD 8F 06            	call	insBRK_brp
    1493/     64E : 38 0A               	jr	c, err_trace_seq
    1494/     650 : 18 05               	jr	END_INS_TC
    1495/     652 :                     
    1496/     652 :                     	; TM_mode = 'S'
    1497/     652 :                     	; ea = *REGPC; *(ea+3) = TC;
    1498/     652 :                     next_bc111:
    1499/     652 : CD 85 06            	call	insBRK_3op
    1500/     655 : 38 03               	jr	c, err_trace_seq
    1501/     657 :                     
    1502/     657 :                     END_INS_TC:
    1503/     657 : C3 D9 14            	jp	G0	; go, trace operation
    1504/     65A :                     
    1505/     65A :                     err_trace_seq:
    1506/     65A : 21 64 06            	ld	hl, terr_msg
    1507/     65D : CD 1B 26            	call	STROUT
    1508/     660 : C3 CB 01            	JP	WSTART
    1509/     663 : FF                  	rst	38h
    1510/     664 :                     ;	
    1511/     664 : 41 64 72 20 45 52   terr_msg:	db	"Adr ERR", CR, LF, 00H
              66A : 52 0D 0A 00       
    1512/     66E :                     
    1513/     66E :                     ;--------------------------------------
    1514/     66E :                     ; 2 byte machine code branch
    1515/     66E :                     ; - 2nd byte is Relative address
    1516/     66E :                     ; - input hl : opecode address
    1517/     66E :                     ; - output hl : target address
    1518/     66E :                     ;--------------------------------------
    1519/     66E :                     Rel_adr_c:
    1520/     66E : 23                  	inc	hl
    1521/     66F : 5E                  	ld	e, (hl)		; e = 2nd operand
    1522/     670 : 23                  	inc	hl		; hl = PC + 2
    1523/     671 : 16 FF               	ld	d, 0ffh
    1524/     673 : CB 7B               	bit	7, e		; test msb bit
    1525/     675 : 20 02               	jr	nz, exp_msb	; 
    1526/     677 : 16 00               	ld	d, 0
    1527/     679 :                     exp_msb:
    1528/     679 : 19                  	add	hl, de
    1529/     67A : C9                  	ret
    1530/     67B :                     
    1531/     67B :                     ;--------------------------------------
    1532/     67B :                     ; 1 byte op code, insert TC
    1533/     67B :                     ; ea = *REGPC; *(ea+1) = TC
    1534/     67B :                     ;--------------------------------------
    1535/     67B :                     insBRK_1op:
    1536/     67B :                     ;	ld	hl, (REGPC)
    1537/     67B : 2A 18 FF            	ld	hl, (tmpT)
    1538/     67E : 18 0A               	jr	ib1
    1539/     680 :                     	
    1540/     680 :                     ;--------------------------------------
    1541/     680 :                     ; 2 byte op code, insert TC
    1542/     680 :                     ; ea = *REGPC; *(ea+2) = TC
    1543/     680 :                     ;--------------------------------------
    1544/     680 :                     insBRK_2op:
    1545/     680 :                     ;	ld	hl, (REGPC)
    1546/     680 : 2A 18 FF            	ld	hl, (tmpT)
    1547/     683 : 18 04               	jr	ib2
    1548/     685 :                     	
    1549/     685 :                     ;--------------------------------------
    1550/     685 :                     ; 3 byte op code, insert TC
    1551/     685 :                     ; ea = *REGPC; *(ea+3) = TC;
    1552/     685 :                     ;--------------------------------------
    1553/     685 :                     insBRK_3op:
    1554/     685 :                     ;	ld	hl, (REGPC)
    1555/     685 : 2A 18 FF            	ld	hl, (tmpT)
    1556/     688 :                     ib3:
    1557/     688 : 23                  	inc	hl
    1558/     689 :                     ib2:
    1559/     689 : 23                  	inc	hl
    1560/     68A :                     ib1:
    1561/     68A : 23                  	inc	hl
    1562/     68B : CD A8 06            	call	inadr_chk_and_wrt
    1563/     68E : C9                  	ret
    1564/     68F :                     
    1565/     68F :                     ;--------------------------------------
    1566/     68F :                     ; 3 byte op code, insert TC in branch point
    1567/     68F :                     ; ea = *REGPC; *((char *)(ea+1)) = TC;
    1568/     68F :                     ;--------------------------------------
    1569/     68F :                     insBRK_brp:
    1570/     68F :                     ;	ld	hl, (REGPC)
    1571/     68F : 2A 18 FF            	ld	hl, (tmpT)
    1572/     692 : 23                  	inc	hl
    1573/     693 : 5E                  	ld	e, (hl)
    1574/     694 : 23                  	inc	hl
    1575/     695 : 56                  	ld	d, (hl)
    1576/     696 : EB                  	ex	de,  hl
    1577/     697 : CD A8 06            	call	inadr_chk_and_wrt
    1578/     69A : C9                  	ret
    1579/     69B :                     
    1580/     69B :                     ;--------------------------------------
    1581/     69B :                     ; insert TC at SP
    1582/     69B :                     ; ea = *REGSP; *ea = TC;
    1583/     69B :                     ;--------------------------------------
    1584/     69B :                     insBRK_sp:
    1585/     69B : ED 5B F0 FE         	ld	de, (REGSP)
    1586/     69F : 1A                  	ld	a, (de)
    1587/     6A0 : 6F                  	ld	l, a
    1588/     6A1 : 13                  	inc	de
    1589/     6A2 : 1A                  	ld	a, (de)
    1590/     6A3 : 67                  	ld	h, a		; hl = *sp
    1591/     6A4 : CD A8 06            	call	inadr_chk_and_wrt
    1592/     6A7 : C9                  	ret
    1593/     6A8 :                     
    1594/     6A8 :                     ;--------------------------------------
    1595/     6A8 :                     ; check (HL) is RAM AREA
    1596/     6A8 :                     ; insert Trace code at (HL)
    1597/     6A8 :                     ;--------------------------------------
    1598/     6A8 :                     inadr_chk_and_wrt:
    1599/     6A8 : 7C                  	ld	a, h
    1600/     6A9 :                     
    1601/     6A9 : FE 80               	cp	RAM_B >> 8		; 80H
    1602/     6AB : 38 23               	jr	c, NO_RAM_AREA
    1603/     6AD : FE FF               	cp	RAM_E >> 8		; 8FH
    1604/     6AF : 30 1F               	jr	nc, NO_RAM_AREA
    1605/     6B1 :                     
    1606/     6B1 : 79                  	ld	a, c
    1607/     6B2 : FE 01               	cp	1		;first save?
    1608/     6B4 : 20 0D               	jr	nz, icka1
    1609/     6B6 : 11 F6 FE            	ld	de, tpt1_f
    1610/     6B9 : 12                  	ld	(de), a		; set trace ON
    1611/     6BA : 22 F8 FE            	ld	(tpt1_adr), hl
    1612/     6BD : 7E                  	ld	a, (hl)		; get opcode
    1613/     6BE : 32 F7 FE            	ld	(tpt1_op), a	; save opcode
    1614/     6C1 : 18 0B               	jr	icka_end
    1615/     6C3 :                     icka1:
    1616/     6C3 : 11 FA FE            	ld	de, tpt2_f
    1617/     6C6 : 12                  	ld	(de), a		; set trace ON
    1618/     6C7 : 22 FC FE            	ld	(tpt2_adr), hl
    1619/     6CA : 7E                  	ld	a, (hl)		; get opcode
    1620/     6CB : 32 FB FE            	ld	(tpt2_op), a	; save opcode
    1621/     6CE :                     icka_end:
    1622/     6CE : AF                  	xor	a
    1623/     6CF : C9                  	ret
    1624/     6D0 :                     
    1625/     6D0 :                     NO_RAM_AREA:
    1626/     6D0 : 37                  	SCF
    1627/     6D1 : C9                  	ret
    1628/     6D2 :                     	
    1629/     6D2 :                     
    1630/     6D2 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1631/     6D2 :                     ; 2 insertion TC TABLE
    1632/     6D2 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1633/     6D2 :                     ;
    1634/     6D2 :                     ; 1 byte machine code: branch (RET CC)
    1635/     6D2 :                     RETCC_TBLS:
    1636/     6D2 : C0                  	DB	0C0H	; RET	NZ
    1637/     6D3 : C8                  	DB	0C8H	; RET	Z
    1638/     6D4 : D0                  	DB	0D0H	; RET	NC
    1639/     6D5 : D8                  	DB	0D8H	; RET	C
    1640/     6D6 : E0                  	DB	0E0H	; RET	PO
    1641/     6D7 : E8                  	DB	0E8H	; RET	PE
    1642/     6D8 : F0                  	DB	0F0H	; RET	P
    1643/     6D9 : F8                  	DB	0F8H	; RET	M
    1644/     6DA :                     RETCC_TBLE:
    1645/     6DA :                     
    1646/     6DA :                     ; 2 byte machine code: branch (JR CC, Relative)
    1647/     6DA :                     JRCC_TBLS:
    1648/     6DA : 10                  	DB	10H	; DJNZ	$
    1649/     6DB :                     JRCC_TBLS1:
    1650/     6DB : 20                  	DB	20H	; JR	NZ,$
    1651/     6DC : 28                  	DB	28H	; JR	Z,$
    1652/     6DD : 30                  	DB	30H	; JR	NC,$
    1653/     6DE : 38                  	DB	38H	; JR	C,$
    1654/     6DF :                     JRCC_TBLE:
    1655/     6DF :                     
    1656/     6DF :                     ; 3 byte machine code: branch (JP CC, 16bit literal)
    1657/     6DF :                     JPCC_TBLS:
    1658/     6DF : C2                  	DB	0C2H	; JP	NZ,1234H
    1659/     6E0 : CA                  	DB	0CAH	; JP	Z,1234H
    1660/     6E1 : D2                  	DB	0D2H	; JP	NC,1234H
    1661/     6E2 : DA                  	DB	0DAH	; JP	C,1234H
    1662/     6E3 : E2                  	DB	0E2H	; JP	PO,1234H
    1663/     6E4 : EA                  	DB	0EAH	; JP	PE,1234H
    1664/     6E5 : F2                  	DB	0F2H	; JP	P,1234H
    1665/     6E6 : FA                  	DB	0FAH	; JP	M,1234H
    1666/     6E7 :                     JPCC_TBLE:
    1667/     6E7 :                     
    1668/     6E7 :                     ; (call 16bit literal)
    1669/     6E7 :                     CLCC_TBLS:
    1670/     6E7 : C4                  	DB	0C4H	; CALL	NZ,1234H
    1671/     6E8 : CC                  	DB	0CCH	; CALL	Z,1234H
    1672/     6E9 : D4                  	DB	0D4H	; CALL	NC,1234H
    1673/     6EA : DC                  	DB	0DCH	; CALL	C,1234H
    1674/     6EB : E4                  	DB	0E4H	; CALL	PO,1234H
    1675/     6EC : EC                  	DB	0ECH	; CALL	PE,1234H
    1676/     6ED : F4                  	DB	0F4H	; CALL	P,1234H
    1677/     6EE : FC                  	DB	0FCH	; CALL	M,1234H
    1678/     6EF :                     CLCC_TBLE:
    1679/     6EF :                     
    1680/     6EF :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1681/     6EF :                     ; 1 insertion TC TABLE
    1682/     6EF :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;
    1683/     6EF :                     
    1684/     6EF :                     ; restart
    1685/     6EF :                     RST_TBLS:
    1686/     6EF : C7                  	DB	0C7H	; RST	00H
    1687/     6F0 : CF                  	DB	0CFH	; RST	08H
    1688/     6F1 : D7                  	DB	0D7H	; RST	10H
    1689/     6F2 : DF                  	DB	0DFH	; RST	18H
    1690/     6F3 : E7                  	DB	0E7H	; RST	20H
    1691/     6F4 : EF                  	DB	0EFH	; RST	28H
    1692/     6F5 : F7                  	DB	0F7H	; RST	30H
    1693/     6F6 : FF                  	DB	0FFH	; RST	38H
    1694/     6F7 :                     RST_TBLE:
    1695/     6F7 :                     
    1696/     6F7 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1697/     6F7 :                     ;;;
    1698/     6F7 :                     ;;; machine code check(except branch)
    1699/     6F7 :                     ;;;
    1700/     6F7 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    1701/     6F7 :                     INS2:
    1702/     6F7 :                     
    1703/     6F7 :                     	; 2byte machine code search
    1704/     6F7 : 01 12 00            	ld	bc, TWO_OPTBL_E - TWO_OPTBL
    1705/     6FA : 21 90 07            	ld	hl, TWO_OPTBL
    1706/     6FD : ED B1               	cpir
    1707/     6FF : CA 6B 07            	jp	z, meet_op2
    1708/     702 :                     
    1709/     702 :                     	; 3byte machine code search
    1710/     702 : 01 08 00            	ld	bc, THREE_OPTBL_E - THREE_OPTBL
    1711/     705 : 21 A2 07            	ld	hl, THREE_OPTBL
    1712/     708 : ED B1               	cpir
    1713/     70A : CA 76 07            	jp	z, meet_op3
    1714/     70D :                     
    1715/     70D :                     	; check 0CBH
    1716/     70D :                     	
    1717/     70D :                     	; readjust hl
    1718/     70D : 2A 18 FF            	ld	hl, (tmpT)
    1719/     710 :                     
    1720/     710 : FE CB               	cp	0CBH		; opecode 0CBH?
    1721/     712 : 28 57               	jr	z, meet_op2
    1722/     714 :                     	
    1723/     714 :                     	; check 0DDH
    1724/     714 : FE DD               	cp	0ddh		; opecode 0DDH?
    1725/     716 : 28 0A               	jr	z, meet_dd
    1726/     718 :                     	
    1727/     718 :                     	; check 0EDH
    1728/     718 : FE ED               	cp	0edh		; opecode 0EDH?
    1729/     71A : 28 28               	jr	z, meet_ed
    1730/     71C :                     
    1731/     71C :                     	; check 0FDH
    1732/     71C : FE FD               	cp	0fdh		; opecode 0FDH?
    1733/     71E : 28 02               	jr	z, meet_dd
    1734/     720 :                     
    1735/     720 :                     	; 1byte machine code
    1736/     720 : 18 3E               	jr	meet_op1
    1737/     722 :                     
    1738/     722 :                     	; opecode 0DDh
    1739/     722 :                     meet_dd:
    1740/     722 : 23                  	inc	hl
    1741/     723 : 7E                  	ld	a, (hl)	
    1742/     724 : FE CB               	cp	0cbh		; 2nd 0CBH?
    1743/     726 : 28 59               	jr	z, meet_op4
    1744/     728 : FE 21               	cp	21h		; 2nd 21H?
    1745/     72A : 28 55               	jr	z, meet_op4
    1746/     72C : FE 22               	cp	22h		; 2nd 22H?
    1747/     72E : 28 51               	jr	z, meet_op4
    1748/     730 : FE 2A               	cp	2ah		; 2nd 2AH?
    1749/     732 : 28 4D               	jr	z, meet_op4
    1750/     734 : FE 36               	cp	36h		; 2nd 36H?
    1751/     736 : 28 49               	jr	z, meet_op4
    1752/     738 :                     
    1753/     738 :                     	; 2nd code search
    1754/     738 : 01 0A 00            	ld	bc, DD_2NDTBL_E - DD_2NDTBL
    1755/     73B : 21 AA 07            	ld	hl, DD_2NDTBL
    1756/     73E : ED B1               	cpir
    1757/     740 : 28 29               	jr	z, meet_op2
    1758/     742 : 18 32               	jr	meet_op3
    1759/     744 :                     
    1760/     744 :                     meet_ed:
    1761/     744 : 23                  	inc	hl
    1762/     745 : 7E                  	ld	a, (hl)	
    1763/     746 : FE 43               	cp	43h		; 2nd 43H?
    1764/     748 : 28 37               	jr	z, meet_op4
    1765/     74A : FE 4B               	cp	4bh		; 2nd 4BH?
    1766/     74C : 28 33               	jr	z, meet_op4
    1767/     74E : FE 53               	cp	53h		; 2nd 53H?
    1768/     750 : 28 2F               	jr	z, meet_op4
    1769/     752 : FE 5B               	cp	5bh		; 2nd 5BH?
    1770/     754 : 28 2B               	jr	z, meet_op4
    1771/     756 : FE 73               	cp	73h		; 2nd 73H?
    1772/     758 : 28 27               	jr	z, meet_op4
    1773/     75A : FE 7B               	cp	7bh		; 2nd 7BH?
    1774/     75C : 28 23               	jr	z, meet_op4
    1775/     75E : 18 0B               	jr	meet_op2
    1776/     760 :                     
    1777/     760 :                     ; 1 machine code
    1778/     760 :                     meet_op1:
    1779/     760 : 0E 01               	ld	c, 1
    1780/     762 : CD 7B 06            	call	insBRK_1op
    1781/     765 : DA 5A 06            	jp	c, err_trace_seq
    1782/     768 : C3 57 06            	jp	END_INS_TC
    1783/     76B :                     
    1784/     76B :                     ; 2 machine code
    1785/     76B :                     meet_op2:
    1786/     76B : 0E 01               	ld	c, 1
    1787/     76D : CD 80 06            	call	insBRK_2op
    1788/     770 : DA 5A 06            	jp	c, err_trace_seq
    1789/     773 : C3 57 06            	jp	END_INS_TC
    1790/     776 :                     ; 3 machine code
    1791/     776 :                     meet_op3:
    1792/     776 : 0E 01               	ld	c, 1
    1793/     778 : CD 85 06            	call	insBRK_3op
    1794/     77B : DA 5A 06            	jp	c, err_trace_seq
    1795/     77E : C3 57 06            	jp	END_INS_TC
    1796/     781 :                     
    1797/     781 :                     ; 4 machine codee
    1798/     781 :                     meet_op4:
    1799/     781 : 0E 01               	ld	c, 1
    1800/     783 :                     ;	ld	hl, (REGPC)
    1801/     783 : 2A 18 FF            	ld	hl, (tmpT)
    1802/     786 : 23                  	inc	hl
    1803/     787 : CD 88 06            	call	ib3
    1804/     78A : DA 5A 06            	jp	c, err_trace_seq
    1805/     78D : C3 57 06            	jp	END_INS_TC
    1806/     790 :                     
    1807/     790 :                     TWO_OPTBL:	; second byte is 8bitliteral[nn]
    1808/     790 :                     ld_r_nn_s:
    1809/     790 : 06                  	DB	06h	; LD	B,nn
    1810/     791 : 0E                  	DB	0Eh	; LD	C,nn
    1811/     792 : 16                  	DB	16h	; LD	D,nn
    1812/     793 : 1E                  	DB	1Eh	; LD	E,nn
    1813/     794 : 26                  	DB	26h	; LD	H,nn
    1814/     795 : 2E                  	DB	2Eh	; LD	L,nn
    1815/     796 : 36                  	DB	36h	; LD	(HL),nn
    1816/     797 : 3E                  	DB	3Eh	; LD	A,nn
    1817/     798 :                     ld_r_nn_e:
    1818/     798 :                     
    1819/     798 :                     log_op_s:
    1820/     798 : C6                  	DB	0C6h	; ADD	A,nn
    1821/     799 : CE                  	DB	0CEh	; ADC	A,nn
    1822/     79A : DE                  	DB	0DEh	; SBC	A,nn
    1823/     79B : D6                  	DB	0D6h	; SUB	nn
    1824/     79C : E6                  	DB	0E6h	; AND	nn
    1825/     79D : EE                  	DB	0EEh	; XOR	nn
    1826/     79E : F6                  	DB	0F6h	; OR	nn
    1827/     79F : FE                  	DB	0FEh	; CP	nn
    1828/     7A0 : DB                  	DB	0DBh	; IN	A,(nn)
    1829/     7A1 : D3                  	DB	0D3h	; OUT	(nn),A
    1830/     7A2 :                     log_op_e:
    1831/     7A2 :                     TWO_OPTBL_E:
    1832/     7A2 :                     
    1833/     7A2 :                     THREE_OPTBL:	; 2nd, 3rd byte is 16bitliteral[nnnn]
    1834/     7A2 : 01                  	DB	01h	; LD	BC,nnnn
    1835/     7A3 : 11                  	DB	11h	; LD	DE,nnnn
    1836/     7A4 : 21                  	DB	21h	; LD	HL,nnnn
    1837/     7A5 : 31                  	DB	31h	; LD	SP,nnnn
    1838/     7A6 :                     THREE_OPTBLe
    1839/     7A6 : 22                  	DB	22h	; LD	(nnnn),HL
    1840/     7A7 : 32                  	DB	32h	; LD	(nnnn),A
    1841/     7A8 :                     
    1842/     7A8 : 2A                  	DB	2Ah	; LD	HL,(nnnn)
    1843/     7A9 : 3A                  	DB	3Ah	; LD	A,(nnnn)
    1844/     7AA :                     THREE_OPTBL_E:
    1845/     7AA :                     
    1846/     7AA :                     DD_2NDTBL:
    1847/     7AA : 09                  	DB	09h	; ADD	IX,BC
    1848/     7AB : 19                  	DB	19h	; ADD	IX,DE
    1849/     7AC : 29                  	DB	29h	; ADD	IX,IX
    1850/     7AD : 39                  	DB	39h	; ADD	IX,SP
    1851/     7AE :                     DD_2NDTBL1:
    1852/     7AE : 23                  	DB	23h	; INC	IX
    1853/     7AF : 2B                  	DB	2Bh	; DEC	IX
    1854/     7B0 : E5                  	DB	0E5h	; PUSH	IX
    1855/     7B1 : E1                  	DB	0E1h	; POP	IX
    1856/     7B2 :                     DD_2NDTBL2:
    1857/     7B2 : E3                  	DB	0E3h	; EX	(SP),IX
    1858/     7B3 : F9                  	DB	0F9h	; LD	SP,IX
    1859/     7B4 :                     DD_2NDTBL_E:
    1860/     7B4 :                     
    1861/     7B4 :                     ;;; 
    1862/     7B4 :                     ;;; Dump memory
    1863/     7B4 :                     ;;; 
    1864/     7B4 :                     
    1865/     7B4 :                     DUMP:
    1866/     7B4 : 23                  	INC	HL
    1867/     7B5 : 7E                  	LD	A,(HL)
    1868/     7B6 : FE 49               	cp	'I'
    1869/     7B8 : CA BD 08            	JP	Z,disassemble
    1870/     7BB : CD 05 27            	CALL	SKIPSP
    1871/     7BE : CD 15 27            	CALL	RDHEX		; 1st arg.
    1872/     7C1 : 38 06               	jr	c, DP0
    1873/     7C3 :                     	;; 1st arg. found
    1874/     7C3 : ED 53 D0 FE         	LD	(DSADDR),DE
    1875/     7C7 : 18 10               	jr	dp00
    1876/     7C9 :                     
    1877/     7C9 :                     DP0:	;; No arg. chk
    1878/     7C9 :                     
    1879/     7C9 : E5                  	push	hl
    1880/     7CA : 2A D0 FE            	LD	HL,(DSADDR)
    1881/     7CD : 01 80 00            	LD	BC,128
    1882/     7D0 : 09                  	ADD	HL,BC
    1883/     7D1 : 22 D2 FE            	LD	(DEADDR),HL
    1884/     7D4 : E1                  	pop	hl
    1885/     7D5 : 7E                  	LD	A,(HL)
    1886/     7D6 : B7                  	OR	A
    1887/     7D7 : 28 2B               	JR	z, DPM_C	; no arg.
    1888/     7D9 :                     
    1889/     7D9 :                     dp00:
    1890/     7D9 : CD 05 27            	CALL	SKIPSP
    1891/     7DC : 7E                  	LD	A,(HL)
    1892/     7DD : FE 2C               	CP	','
    1893/     7DF : 28 0D               	JR	Z,DP1
    1894/     7E1 : B7                  	OR	A
    1895/     7E2 : C2 17 02            	JP	NZ,ERR
    1896/     7E5 :                     
    1897/     7E5 :                     	;; No 2nd arg.
    1898/     7E5 :                     
    1899/     7E5 : 21 80 00            	LD	HL,128
    1900/     7E8 : 19                  	ADD	HL,DE
    1901/     7E9 : 22 D2 FE            	LD	(DEADDR),HL
    1902/     7EC : 18 16               	JR	DPM_C
    1903/     7EE :                     
    1904/     7EE :                     DP1:
    1905/     7EE : 23                  	INC	HL
    1906/     7EF : CD 05 27            	CALL	SKIPSP
    1907/     7F2 : CD 15 27            	CALL	RDHEX
    1908/     7F5 : DA 17 02            	jp	c, ERR
    1909/     7F8 : CD 05 27            	CALL	SKIPSP
    1910/     7FB : B7                  	OR	A
    1911/     7FC : C2 17 02            	jp	nz, ERR
    1912/     7FF : 13                  	INC	DE
    1913/     800 : ED 53 D2 FE         	LD	(DEADDR),DE
    1914/     804 :                     DPM_C:
    1915/     804 : CD 0A 08            	CALL	DPM
    1916/     807 : C3 CB 01            	JP	WSTART
    1917/     80A :                     
    1918/     80A :                     	;; DUMP main
    1919/     80A :                     DPM:
    1920/     80A : 2A D0 FE            	LD	HL,(DSADDR)
    1921/     80D : 3E F0               	LD	A,0F0H
    1922/     80F : A5                  	AND	L
    1923/     810 : 6F                  	LD	L,A
    1924/     811 : AF                  	XOR	A
    1925/     812 : 32 D4 FE            	LD	(DSTATE),A
    1926/     815 :                     DPM0:
    1927/     815 : E5                  	PUSH	HL
    1928/     816 : CD 37 08            	CALL	DPL
    1929/     819 : E1                  	POP	HL
    1930/     81A : 01 10 00            	LD	BC,16
    1931/     81D : 09                  	ADD	HL,BC
    1932/     81E : CD 86 2E            	CALL	CONST
    1933/     821 : 20 0E               	JR	NZ,DPM1
    1934/     823 : 3A D4 FE            	LD	A,(DSTATE)
    1935/     826 : FE 02               	CP	2
    1936/     828 : 38 EB               	JR	C,DPM0
    1937/     82A : 2A D2 FE            	LD	HL,(DEADDR)
    1938/     82D : 22 D0 FE            	LD	(DSADDR),HL
    1939/     830 : C9                  	RET
    1940/     831 :                     DPM1:
    1941/     831 : 22 D0 FE            	LD	(DSADDR),HL
    1942/     834 : C3 3C 2E            	JP	CONIN
    1943/     837 :                     
    1944/     837 :                     DPL:
    1945/     837 :                     	;; DUMP line
    1946/     837 : CD 24 26            	CALL	HEXOUT4
    1947/     83A : E5                  	PUSH	HL
    1948/     83B : 21 07 2C            	LD	HL,DSEP0
    1949/     83E : CD 1B 26            	CALL	STROUT
    1950/     841 : E1                  	POP	HL
    1951/     842 : DD 21 CE FF         	LD	IX,INBUF
    1952/     846 : 06 10               	LD	B,16
    1953/     848 :                     DPL0:
    1954/     848 : CD 71 08            	CALL	DPB
    1955/     84B : 10 FB               	DJNZ	DPL0
    1956/     84D :                     
    1957/     84D : 21 0A 2C            	LD	HL,DSEP1
    1958/     850 : CD 1B 26            	CALL	STROUT
    1959/     853 :                     
    1960/     853 : 21 CE FF            	LD	HL,INBUF
    1961/     856 : 06 10               	LD	B,16
    1962/     858 :                     DPL1:
    1963/     858 : 7E                  	LD	A,(HL)
    1964/     859 : 23                  	INC	HL
    1965/     85A : FE 20               	CP	' '
    1966/     85C : 38 09               	JR	C,DPL2
    1967/     85E : FE 7F               	CP	7FH
    1968/     860 : 30 05               	JR	NC,DPL2
    1969/     862 : CD 8B 2E            	CALL	CONOUT
    1970/     865 : 18 05               	JR	DPL3
    1971/     867 :                     DPL2:
    1972/     867 : 3E 2E               	LD	A,'.'
    1973/     869 : CD 8B 2E            	CALL	CONOUT
    1974/     86C :                     DPL3:
    1975/     86C : 10 EA               	DJNZ	DPL1
    1976/     86E : C3 64 26            	JP	CRLF
    1977/     871 :                     
    1978/     871 :                     DPB:	; Dump byte
    1979/     871 : 3E 20               	LD	A,' '
    1980/     873 : CD 8B 2E            	CALL	CONOUT
    1981/     876 : 3A D4 FE            	LD	A,(DSTATE)
    1982/     879 : B7                  	OR	A
    1983/     87A : 20 20               	JR	NZ,DPB2
    1984/     87C :                     	; Dump state 0
    1985/     87C : 3A D0 FE            	LD	A,(DSADDR)	; Low byte
    1986/     87F : BD                  	CP	L
    1987/     880 : 20 06               	JR	NZ,DPB0
    1988/     882 : 3A D1 FE            	LD	A,(DSADDR+1)	; High byte
    1989/     885 : BC                  	CP	H
    1990/     886 : 28 0F               	JR	Z,DPB1
    1991/     888 :                     DPB0:	; Still 0 or 2
    1992/     888 : 3E 20               	LD	A,' '
    1993/     88A : CD 8B 2E            	CALL	CONOUT
    1994/     88D : CD 8B 2E            	CALL	CONOUT
    1995/     890 : DD 77 00            	LD	(IX),A
    1996/     893 : 23                  	INC	HL
    1997/     894 : DD 23               	INC	IX
    1998/     896 : C9                  	RET
    1999/     897 :                     DPB1:	; Found start address
    2000/     897 : 3E 01               	LD	A,1
    2001/     899 : 32 D4 FE            	LD	(DSTATE),A
    2002/     89C :                     DPB2:
    2003/     89C : 3A D4 FE            	LD	A,(DSTATE)
    2004/     89F : FE 01               	CP	1
    2005/     8A1 : 20 E5               	JR	NZ,DPB0
    2006/     8A3 :                     	; Dump state 1
    2007/     8A3 : 7E                  	LD	A,(HL)
    2008/     8A4 : DD 77 00            	LD	(IX),A
    2009/     8A7 : CD 29 26            	CALL	HEXOUT2
    2010/     8AA : 23                  	INC	HL
    2011/     8AB : DD 23               	INC	IX
    2012/     8AD : 3A D2 FE            	LD	A,(DEADDR)	; Low byte
    2013/     8B0 : BD                  	CP	L
    2014/     8B1 : C0                  	RET	NZ
    2015/     8B2 : 3A D3 FE            	LD	A,(DEADDR+1)	; High byte
    2016/     8B5 : BC                  	CP	H
    2017/     8B6 : C0                  	RET	NZ
    2018/     8B7 :                     	; Found end address
    2019/     8B7 : 3E 02               	LD	A,2
    2020/     8B9 : 32 D4 FE            	LD	(DSTATE),A
    2021/     8BC : C9                  	RET
    2022/     8BD :                     
    2023/     8BD :                     ;;;
    2024/     8BD :                     ;;; Disassemble
    2025/     8BD :                     ;;; 
    2026/     8BD :                     
    2027/     8BD :                     
    2028/     8BD :                     ; DI[<address>][,s<steps>|<end address>]
    2029/     8BD :                     
    2030/     8BD :                     disassemble:
    2031/     8BD : 23                  	INC	HL
    2032/     8BE : CD 05 27            	CALL	SKIPSP
    2033/     8C1 : CD 15 27            	CALL	RDHEX		; 1st arg.
    2034/     8C4 : 30 14               	jr	nc, get_DI1
    2035/     8C6 :                     
    2036/     8C6 :                     di_nxt:
    2037/     8C6 :                     	;; No arg. chk
    2038/     8C6 : CD 05 27            	CALL	SKIPSP
    2039/     8C9 : 7E                  	LD	A,(HL)
    2040/     8CA : B7                  	OR	A
    2041/     8CB : 20 13               	jr	NZ, chk_DI1	; ',' check
    2042/     8CD :                     
    2043/     8CD :                     ; No arg
    2044/     8CD : 26 00               	ld	h, 0
    2045/     8CF : 2E 0A               	ld	l, 10
    2046/     8D1 : 7D                  	ld	a, l
    2047/     8D2 : 32 3C FF            	ld	(dasm_stpf), a	; set step flag
    2048/     8D5 : 22 3A FF            	ld	(dasm_ed), hl	; set 10 steps
    2049/     8D8 : 18 33               	jr	DISASM_go
    2050/     8DA :                     
    2051/     8DA :                     ; 1st arg
    2052/     8DA :                     get_DI1:
    2053/     8DA : ED 53 3D FF         	ld	(dasm_adr), de	; save start address
    2054/     8DE :                     ;	INC	HL
    2055/     8DE : 18 E6               	jr	di_nxt
    2056/     8E0 :                     
    2057/     8E0 :                     chk_DI1:
    2058/     8E0 : FE 2C               	cp	','
    2059/     8E2 : C2 17 02            	jp	nz, ERR
    2060/     8E5 :                     
    2061/     8E5 :                     ; check 2nd arg
    2062/     8E5 :                     
    2063/     8E5 : 23                  	INC	HL
    2064/     8E6 : CD 05 27            	CALL	SKIPSP
    2065/     8E9 : FE 53               	cp	'S'
    2066/     8EB : 20 12               	jr	nz, chk_stpDI
    2067/     8ED :                     
    2068/     8ED :                     ; step arg
    2069/     8ED : 3E 01               	ld	a, 1
    2070/     8EF : 32 3C FF            	ld	(dasm_stpf), a	; set step flag
    2071/     8F2 : 23                  	inc	hl
    2072/     8F3 : CD 16 03            	call	GET_NUM		; get decimal number to binary
    2073/     8F6 : DA 17 02            	jp	c, ERR
    2074/     8F9 : ED 43 3A FF         	ld	(dasm_ed), bc	; set steps
    2075/     8FD : 18 0E               	jr	DISASM_go
    2076/     8FF :                     
    2077/     8FF :                     chk_stpDI:
    2078/     8FF : CD 15 27            	CALL	RDHEX		; 2nd arg.
    2079/     902 : DA 17 02            	jp	c, ERR
    2080/     905 : ED 53 3A FF         	ld	(dasm_ed), de	; set end address
    2081/     909 : AF                  	xor	a
    2082/     90A : 32 3C FF            	ld	(dasm_stpf), a	; clear step flag
    2083/     90D :                     
    2084/     90D :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2085/     90D :                     ; operation Disassemble
    2086/     90D :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2087/     90D :                     
    2088/     90D :                     DISASM_go:
    2089/     90D : CD 86 2E            	call	CONST
    2090/     910 : 28 06               	jr	z, dis_go1
    2091/     912 : CD 3C 2E            	call	CONIN		;discard key
    2092/     915 : C3 CB 01            	jp	WSTART		; exit disasm command
    2093/     918 :                     
    2094/     918 :                     dis_go1:
    2095/     918 :                     	; get opcode
    2096/     918 : CD 9C 09            	call	dis_analysis
    2097/     91B : CD 61 09            	call	mk_adr_str	; conout address and machine code
    2098/     91E :                     				; *dasm_adr is next opcode address
    2099/     91E : 21 CE FF            	ld	hl, adr_mc_buf
    2100/     921 : CD 1B 26            	call	STROUT		; conout disassemble strings
    2101/     924 :                     
    2102/     924 : 3A 3C FF            	ld	a, (dasm_stpf)
    2103/     927 : B7                  	or	a
    2104/     928 : 20 0E               	jr	nz, calc_dis_step
    2105/     92A :                     	
    2106/     92A :                     	; *dasm_adr > *dasm_ed ?, yes, finish
    2107/     92A : 2A 3A FF            	ld	hl, (dasm_ed)
    2108/     92D : ED 4B 3D FF         	ld	bc, (dasm_adr)
    2109/     931 : ED 42               	sbc	hl, bc
    2110/     933 : 30 D8               	jr	nc, DISASM_go
    2111/     935 : C3 CB 01            	jp	WSTART
    2112/     938 :                     
    2113/     938 :                     calc_dis_step:
    2114/     938 : 2A 3A FF            	ld	hl, (dasm_ed)
    2115/     93B : 2B                  	dec	hl
    2116/     93C : 22 3A FF            	ld	(dasm_ed), hl
    2117/     93F : 7C                  	ld	a, h
    2118/     940 : B5                  	or	l
    2119/     941 : 20 CA               	jr	nz, DISASM_go
    2120/     943 : C3 CB 01            	jp	WSTART
    2121/     946 :                     
    2122/     946 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2123/     946 :                     ; Disassemble and maked strings to user buffer
    2124/     946 :                     ; input de : user buffer
    2125/     946 :                     ;       hl : disassemble address
    2126/     946 :                     ; output de : next MC address
    2127/     946 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2128/     946 :                     get_disasm_st:
    2129/     946 : 22 3D FF            	ld	(dasm_adr), hl
    2130/     949 : D5                  	push	de
    2131/     94A : CD 9C 09            	call	dis_analysis
    2132/     94D : CD 61 09            	call	mk_adr_str	; conout address and machine code
    2133/     950 : D1                  	pop	de
    2134/     951 : 21 CE FF            	ld	hl, adr_mc_buf
    2135/     954 : 01 2A 00            	ld	bc, dasm_be - dasm_bs
    2136/     957 : ED B0               	ldir
    2137/     959 : ED 5B 3D FF         	ld	de, (dasm_adr)
    2138/     95D : 3A 43 FF            	ld	a, (mc_Size)
    2139/     960 : C9                  	ret
    2140/     961 :                     
    2141/     961 :                     ;-------------------------------------------------
    2142/     961 :                     ; Make address and machine code at adr_mc_buf
    2143/     961 :                     ; "XXXX XX XX XX XX " (17bytes)
    2144/     961 :                     ;-------------------------------------------------
    2145/     961 :                     mk_adr_str:
    2146/     961 : 21 CE FF            	ld	hl, adr_mc_buf
    2147/     964 : ED 5B 3D FF         	ld	de, (dasm_adr)
    2148/     968 : CD 3C 11            	call	hex4str		; address XXXX
    2149/     96B : CD CC 11            	call	ins_spcR
    2150/     96E : CD CC 11            	call	ins_spcR
    2151/     971 :                     
    2152/     971 : 06 04               	ld	b, 4
    2153/     973 : 3A 43 FF            	ld	a, (mc_Size)
    2154/     976 : 4F                  	ld	c, a
    2155/     977 :                     mas_1:
    2156/     977 : 1A                  	ld	a, (de)
    2157/     978 : 13                  	inc	de
    2158/     979 :                     
    2159/     979 : D5                  	push	de
    2160/     97A : 5F                  	ld	e, a
    2161/     97B : CD 44 11            	call	hex2str		; MC XX
    2162/     97E : CD CC 11            	call	ins_spcR
    2163/     981 : D1                  	pop	de
    2164/     982 :                     
    2165/     982 : 05                  	dec	b
    2166/     983 : 28 0F               	jr	z, mas_3	; end
    2167/     985 : 0D                  	dec	c
    2168/     986 : 20 EF               	jr	nz, mas_1
    2169/     988 :                     
    2170/     988 :                     mas_2:	
    2171/     988 : CD CC 11            	call	ins_spcR
    2172/     98B : CD CC 11            	call	ins_spcR
    2173/     98E : CD CC 11            	call	ins_spcR
    2174/     991 : 05                  	dec	b
    2175/     992 : 20 F4               	jr	nz, mas_2
    2176/     994 :                     mas_3:
    2177/     994 : CD CC 11            	call	ins_spcR
    2178/     997 : ED 53 3D FF         	ld	(dasm_adr), de	; set next analysis address
    2179/     99B : C9                  	ret
    2180/     99C :                     
    2181/     99C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2182/     99C :                     ; dis assemble analysis
    2183/     99C :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2184/     99C :                     
    2185/     99C :                     dis_analysis:
    2186/     99C :                     
    2187/     99C :                     	; pre init string buffer
    2188/     99C :                     
    2189/     99C : 3E 01               	ld	a, 1
    2190/     99E : 32 43 FF            	ld	(mc_Size), a
    2191/     9A1 :                     
    2192/     9A1 : 11 9B 12            	ld	de, LDstr	; insert LD string
    2193/     9A4 : CD 60 11            	call	mkopcstr
    2194/     9A7 :                     
    2195/     9A7 : 21 E9 FF            	ld	hl, dasm_OprStr
    2196/     9AA : CD 8C 11            	call	insPostStr	; CR, LF, 00h
    2197/     9AD :                     
    2198/     9AD : 2A 3D FF            	ld	hl, (dasm_adr)
    2199/     9B0 : 7E                  	ld	a, (hl)		; get opcode
    2200/     9B1 :                     
    2201/     9B1 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2202/     9B1 :                     	; analysys 1 byte MC
    2203/     9B1 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2204/     9B1 :                     
    2205/     9B1 :                     ;  check no operand
    2206/     9B1 :                     
    2207/     9B1 : 01 0D 00            	ld	bc, oth_1op_e - oth_1op_s
    2208/     9B4 : 21 DF 11            	ld	hl, oth_1op_s
    2209/     9B7 : ED B1               	cpir
    2210/     9B9 : 20 12               	jr	nz, chk_ld
    2211/     9BB :                     
    2212/     9BB :                     ;  no operand
    2213/     9BB :                     
    2214/     9BB : 21 EE 13            	ld	hl, oth_1op_tbl
    2215/     9BE : CD E2 10            	call	get_strBufpoint
    2216/     9C1 : C3 60 11            	jp	mkopcstr
    2217/     9C4 :                     
    2218/     9C4 :                     get_r_num:
    2219/     9C4 : E6 38               	and	38H
    2220/     9C6 : 0F                  	rrca
    2221/     9C7 : 0F                  	rrca
    2222/     9C8 : 0F                  	rrca
    2223/     9C9 : 4F                  	ld	c, a
    2224/     9CA : 06 00               	ld	b, 0		; bc ; register No.
    2225/     9CC : C9                  	ret
    2226/     9CD :                     ;
    2227/     9CD :                     ; LD opecode
    2228/     9CD :                     ;
    2229/     9CD :                     
    2230/     9CD :                     ; check LD "A,(BC)", "A,(DE)", "(BC),A", "(DE),A", "SP,HL"
    2231/     9CD :                     
    2232/     9CD :                     chk_ld:
    2233/     9CD : FE 0A               	cp	0AH	; LD	A,(BC)
    2234/     9CF : 28 19               	jr	z, ld_a_kbck
    2235/     9D1 : FE 1A               	cp	1AH	; LD	A,(DE)
    2236/     9D3 : 28 23               	jr	z, ld_a_kdek
    2237/     9D5 : FE 02               	cp	02H	; LD	(BC),A
    2238/     9D7 : 28 24               	jr	z, ld_kbck_a
    2239/     9D9 : FE 12               	cp	12H	; LD	(DE),A
    2240/     9DB : 28 29               	jr	z, ld_kdek_a
    2241/     9DD : FE F9               	cp	0F9H	; LD	SP,HL
    2242/     9DF : 20 2A               	jr	nz, chk_ld1
    2243/     9E1 :                     
    2244/     9E1 :                     ; LD SP, HL
    2245/     9E1 : 11 32 2E            	ld	de, RNSP
    2246/     9E4 : CD B3 11            	call	mk_rcs		; "SP, "
    2247/     9E7 : C3 86 11            	jp	hl_crlf
    2248/     9EA :                     	
    2249/     9EA :                     ; LD A, (BC)
    2250/     9EA :                     ld_a_kbck:
    2251/     9EA : 11 F1 2D            	ld	de, RNBC
    2252/     9ED :                     ld_a_kxxk:
    2253/     9ED : D5                  	push	de
    2254/     9EE : CD B0 11            	call	a_colon_sp	; "A, "
    2255/     9F1 : D1                  	pop	de
    2256/     9F2 : CD 9A 11            	call	mk_krk		; "(BC)", "(DE)"
    2257/     9F5 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2258/     9F8 :                     
    2259/     9F8 :                     ; LD A, (DE)
    2260/     9F8 :                     ld_a_kdek:
    2261/     9F8 : 11 F8 2D            	ld	de, RNDE
    2262/     9FB : 18 F0               	jr	ld_a_kxxk
    2263/     9FD :                     
    2264/     9FD :                     ; LD (BC), A
    2265/     9FD :                     ld_kbck_a:
    2266/     9FD : 11 F1 2D            	ld	de, RNBC
    2267/     A00 :                     
    2268/     A00 :                     ld_kxxk_a:
    2269/     A00 : CD A2 11            	call	mk_krkcs	; "(BC), ", "(DE), "
    2270/     A03 : C3 7B 11            	jp	a_crlf		; "A",CR,LF
    2271/     A06 :                     
    2272/     A06 :                     ; LD (DE), A
    2273/     A06 :                     ld_kdek_a:
    2274/     A06 : 11 F8 2D            	ld	de, RNDE
    2275/     A09 : 18 F5               	jr	ld_kxxk_a
    2276/     A0B :                     
    2277/     A0B :                     ; check other 1byte LD MC
    2278/     A0B :                     
    2279/     A0B :                     chk_ld1:
    2280/     A0B : FE 40               	cp	40h
    2281/     A0D : DA A3 0A            	jp	c, chk_inc
    2282/     A10 : FE 80               	cp	80h
    2283/     A12 : 30 28               	jr	nc, chk_add
    2284/     A14 : FE 76               	cp	76h	; HALT?
    2285/     A16 : 20 06               	jr	nz, LD1op
    2286/     A18 :                     
    2287/     A18 : 11 9E 12            	ld	de, HLTstr	; HALT string
    2288/     A1B : C3 60 11            	jp	mkopcstr	; de : next string buffer addr
    2289/     A1E :                     
    2290/     A1E :                     ; LD
    2291/     A1E :                     
    2292/     A1E :                     LD1op:
    2293/     A1E : CD C4 09            	call	get_r_num
    2294/     A21 : CD DF 10            	call	get_rstg_off
    2295/     A24 : 21 E9 FF            	ld	hl, dasm_OprStr
    2296/     A27 : CD B3 11            	call	mk_rcs		; "REG, "
    2297/     A2A :                     
    2298/     A2A :                     mk_2ndopr:
    2299/     A2A : ED 5B 3D FF         	ld	de, (dasm_adr)
    2300/     A2E : 1A                  	ld	a, (de)		; get opcode
    2301/     A2F : E6 07               	and	07h
    2302/     A31 : 4F                  	ld	c, a
    2303/     A32 : 06 00               	ld	b, 0
    2304/     A34 :                     
    2305/     A34 :                     mk_2ndopr1:
    2306/     A34 : E5                  	push	hl		; save copy buffer
    2307/     A35 : CD DF 10            	call	get_rstg_off
    2308/     A38 : E1                  	pop	hl		; copy buffer
    2309/     A39 : C3 89 11            	jp	cpstr_crlf	; "REG",CR,LF
    2310/     A3C :                     
    2311/     A3C :                     ; ADD 80H - 87H
    2312/     A3C :                     ; check ADD code
    2313/     A3C :                     
    2314/     A3C :                     chk_add:
    2315/     A3C : FE 88               	cp	88h
    2316/     A3E : 30 08               	jr	nc, chk_adc
    2317/     A40 :                     
    2318/     A40 :                     ; ADD
    2319/     A40 : CD 5D 11            	call	add_opstr
    2320/     A43 : CD B0 11            	call	a_colon_sp
    2321/     A46 : 18 E2               	jr	mk_2ndopr
    2322/     A48 :                     
    2323/     A48 :                     ; ADC 88H - 8FH
    2324/     A48 :                     ; check ADC code
    2325/     A48 :                     
    2326/     A48 :                     chk_adc:
    2327/     A48 : FE 90               	cp	90h
    2328/     A4A : 30 0B               	jr	nc, chk_sub
    2329/     A4C :                     
    2330/     A4C :                     ; ADC
    2331/     A4C : 11 A7 12            	ld	de, ADCstr
    2332/     A4F : CD 60 11            	call	mkopcstr
    2333/     A52 : CD B0 11            	call	a_colon_sp
    2334/     A55 : 18 D3               	jr	mk_2ndopr
    2335/     A57 :                     
    2336/     A57 :                     ; SUB 90H - 97H
    2337/     A57 :                     ; check SUB code
    2338/     A57 :                     
    2339/     A57 :                     chk_sub:
    2340/     A57 : FE 98               	cp	98h
    2341/     A59 : 30 08               	jr	nc, chk_sbc
    2342/     A5B :                     
    2343/     A5B :                     ; SUB
    2344/     A5B : 11 AB 12            	ld	de, SUBstr
    2345/     A5E : CD 60 11            	call	mkopcstr
    2346/     A61 : 18 C7               	jr	mk_2ndopr
    2347/     A63 :                     
    2348/     A63 :                     ; SBC 98H - 9FH
    2349/     A63 :                     ; check SBC code
    2350/     A63 :                     
    2351/     A63 :                     chk_sbc:
    2352/     A63 : FE A0               	cp	0A0h
    2353/     A65 : 30 0B               	jr	nc, chk_and
    2354/     A67 :                     
    2355/     A67 :                     ; SBC
    2356/     A67 : 11 AF 12            	ld	de, SBCstr
    2357/     A6A : CD 60 11            	call	mkopcstr
    2358/     A6D : CD B0 11            	call	a_colon_sp
    2359/     A70 : 18 B8               	jr	mk_2ndopr
    2360/     A72 :                     
    2361/     A72 :                     ; AND 0A0H - 0A7H
    2362/     A72 :                     ; check AND code
    2363/     A72 :                     
    2364/     A72 :                     chk_and:
    2365/     A72 : FE A8               	cp	0A8h
    2366/     A74 : 30 08               	jr	nc, chk_xor
    2367/     A76 :                     
    2368/     A76 :                     ; AND
    2369/     A76 : 11 B3 12            	ld	de, ANDstr
    2370/     A79 : CD 60 11            	call	mkopcstr
    2371/     A7C : 18 AC               	jr	mk_2ndopr
    2372/     A7E :                     
    2373/     A7E :                     ; XOR 0A8H - 0AFH
    2374/     A7E :                     ; check XOR code
    2375/     A7E :                     
    2376/     A7E :                     chk_xor:
    2377/     A7E :                     
    2378/     A7E : FE B0               	cp	0B0h
    2379/     A80 : 30 08               	jr	nc, chk_or
    2380/     A82 :                     
    2381/     A82 :                     ; XOR
    2382/     A82 : 11 B7 12            	ld	de, XORstr
    2383/     A85 : CD 60 11            	call	mkopcstr
    2384/     A88 : 18 A0               	jr	mk_2ndopr
    2385/     A8A :                     
    2386/     A8A :                     ; OR 0B0H - 0B7H
    2387/     A8A :                     ; check OR code
    2388/     A8A :                     
    2389/     A8A :                     chk_or:
    2390/     A8A : FE B8               	cp	0B8h
    2391/     A8C : 30 08               	jr	nc, chk_cp
    2392/     A8E :                     
    2393/     A8E :                     ; OR
    2394/     A8E : 11 BB 12            	ld	de, ORstr
    2395/     A91 : CD 60 11            	call	mkopcstr
    2396/     A94 : 18 94               	jr	mk_2ndopr
    2397/     A96 :                     
    2398/     A96 :                     ; CP 0B8H - 0BFH
    2399/     A96 :                     ; check CP code
    2400/     A96 :                     
    2401/     A96 :                     chk_cp:
    2402/     A96 : FE C0               	cp	0C0h
    2403/     A98 : D2 1F 0B            	jp	nc, chk_pop_rp
    2404/     A9B :                     
    2405/     A9B :                     ; CP
    2406/     A9B : 11 BE 12            	ld	de, CPstr
    2407/     A9E : CD 60 11            	call	mkopcstr
    2408/     AA1 : 18 87               	jr	mk_2ndopr
    2409/     AA3 :                     
    2410/     AA3 :                     ;check INC
    2411/     AA3 :                     
    2412/     AA3 :                     chk_inc:
    2413/     AA3 : 01 08 00            	ld	bc, INC_OPCDTBLE - INC_OPCDTBLS
    2414/     AA6 : 21 EC 11            	ld	hl, INC_OPCDTBLS
    2415/     AA9 : ED B1               	cpir
    2416/     AAB : 20 0E               	jr	nz, chk_dec
    2417/     AAD :                     
    2418/     AAD :                     ; INC
    2419/     AAD : F5                  	push	af
    2420/     AAE : 11 C1 12            	ld	de, INCstr
    2421/     AB1 : CD 60 11            	call	mkopcstr
    2422/     AB4 : F1                  	pop	af
    2423/     AB5 :                     
    2424/     AB5 :                     inc_dec:
    2425/     AB5 : CD C4 09            	call	get_r_num
    2426/     AB8 : C3 34 0A            	jp	mk_2ndopr1
    2427/     ABB :                     
    2428/     ABB :                     ;check dec
    2429/     ABB :                     
    2430/     ABB :                     chk_dec:
    2431/     ABB : 01 08 00            	ld	bc, DEC_OPCDTBLE - DEC_OPCDTBLS
    2432/     ABE : 21 F4 11            	ld	hl, DEC_OPCDTBLS
    2433/     AC1 : ED B1               	cpir
    2434/     AC3 : 20 0A               	jr	nz, chk_inc_rp
    2435/     AC5 :                     
    2436/     AC5 :                     ; DEC
    2437/     AC5 : F5                  	push	af
    2438/     AC6 : 11 C5 12            	ld	de, DECstr
    2439/     AC9 : CD 60 11            	call	mkopcstr
    2440/     ACC : F1                  	pop	af
    2441/     ACD : 18 E6               	jr	inc_dec
    2442/     ACF :                     
    2443/     ACF :                     ; check inc rp
    2444/     ACF :                     
    2445/     ACF :                     chk_inc_rp:
    2446/     ACF : 01 04 00            	ld	bc, inc_rp_e - inc_rp_s
    2447/     AD2 : 21 FC 11            	ld	hl, inc_rp_s
    2448/     AD5 : ED B1               	cpir
    2449/     AD7 : 20 0F               	jr	nz, chk_dec_rp
    2450/     AD9 :                     
    2451/     AD9 :                     ; INC rp
    2452/     AD9 : 11 C1 12            	ld	de, INCstr
    2453/     ADC : CD 60 11            	call	mkopcstr
    2454/     ADF :                     
    2455/     ADF : 21 DE 13            	ld	hl, INC_DEC_ADDrp
    2456/     AE2 : CD D6 10            	call	mk_str
    2457/     AE5 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2458/     AE8 :                     
    2459/     AE8 :                     ; check dec rp
    2460/     AE8 :                     
    2461/     AE8 :                     chk_dec_rp:
    2462/     AE8 : 01 04 00            	ld	bc, dec_rp_e - dec_rp_s
    2463/     AEB : 21 00 12            	ld	hl, dec_rp_s
    2464/     AEE : ED B1               	cpir
    2465/     AF0 : 20 0F               	jr	nz, chk_add_rp
    2466/     AF2 :                     
    2467/     AF2 :                     ; dec rp
    2468/     AF2 : 11 C5 12            	ld	de, DECstr
    2469/     AF5 : CD 60 11            	call	mkopcstr
    2470/     AF8 :                     
    2471/     AF8 : 21 DE 13            	ld	hl, INC_DEC_ADDrp
    2472/     AFB : CD D6 10            	call	mk_str
    2473/     AFE : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2474/     B01 :                     
    2475/     B01 :                     ;check ADD HL, rp
    2476/     B01 :                     
    2477/     B01 :                     chk_add_rp:
    2478/     B01 : 01 04 00            	ld	bc, add_rp_e - add_rp_s
    2479/     B04 : 21 04 12            	ld	hl, add_rp_s
    2480/     B07 : ED B1               	cpir
    2481/     B09 : 20 46               	jr	nz, chk_ex
    2482/     B0B :                     
    2483/     B0B :                     ; add hl, rp
    2484/     B0B :                     
    2485/     B0B : CD 5D 11            	call	add_opstr
    2486/     B0E :                     
    2487/     B0E : 11 FF 2D            	ld	de, RNHL
    2488/     B11 : CD B3 11            	call	mk_rcs		; "HL, "
    2489/     B14 :                     
    2490/     B14 : E5                  	push	hl
    2491/     B15 : 21 DE 13            	ld	hl, INC_DEC_ADDrp
    2492/     B18 : CD E2 10            	call	get_strBufpoint
    2493/     B1B : E1                  	pop	hl
    2494/     B1C : C3 89 11            	jp	cpstr_crlf	; CR, LF, 00h
    2495/     B1F :                     
    2496/     B1F :                     ; check POP rp
    2497/     B1F :                     
    2498/     B1F :                     chk_pop_rp:
    2499/     B1F : 01 04 00            	ld	bc, pop_rp_e - pop_rp_s
    2500/     B22 : 21 08 12            	ld	hl, pop_rp_s
    2501/     B25 : ED B1               	cpir
    2502/     B27 : 20 0F               	jr	nz, chk_push_rp
    2503/     B29 :                     
    2504/     B29 :                     ; POP RP
    2505/     B29 :                     
    2506/     B29 : 11 C9 12            	ld	de, POPstr
    2507/     B2C : CD 60 11            	call	mkopcstr
    2508/     B2F :                     
    2509/     B2F : 21 E6 13            	ld	hl, POP_PUSHrp
    2510/     B32 : CD D6 10            	call	mk_str
    2511/     B35 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2512/     B38 :                     
    2513/     B38 :                     ; check PUSH rp
    2514/     B38 :                     
    2515/     B38 :                     chk_push_rp:
    2516/     B38 : 01 04 00            	ld	bc, push_rp_e - push_rp_s
    2517/     B3B : 21 0C 12            	ld	hl, push_rp_s
    2518/     B3E : ED B1               	cpir
    2519/     B40 : 20 0F               	jr	nz, chk_ex
    2520/     B42 :                     
    2521/     B42 :                     ; PUSH RP
    2522/     B42 :                     
    2523/     B42 : 11 CD 12            	ld	de, PUSHstr
    2524/     B45 : CD 60 11            	call	mkopcstr
    2525/     B48 :                     
    2526/     B48 : 21 E6 13            	ld	hl, POP_PUSHrp
    2527/     B4B : CD D6 10            	call	mk_str
    2528/     B4E : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2529/     B51 :                     
    2530/     B51 :                     ; check EX XX, XX
    2531/     B51 :                     
    2532/     B51 :                     chk_ex:
    2533/     B51 : FE 08               	cp	08H		; EX	AF,AF'
    2534/     B53 : 28 17               	jr	z, ex_af_af
    2535/     B55 : FE E3               	cp	0E3H		; EX	(SP),HL
    2536/     B57 : 28 21               	jr	z, dex_sp_hl
    2537/     B59 : FE EB               	cp	0EBH		; EX	DE,HL
    2538/     B5B : 20 25               	jr	nz, chk_1mc_bnh
    2539/     B5D :                     
    2540/     B5D :                     ; EX DE, HL
    2541/     B5D : 11 F8 2D            	ld	de, RNDE
    2542/     B60 : CD B3 11            	call	mk_rcs
    2543/     B63 :                     
    2544/     B63 :                     ins_hl_opr:
    2545/     B63 : CD 86 11            	call	hl_crlf
    2546/     B66 :                     
    2547/     B66 :                     ins_ex_opc:
    2548/     B66 : 11 D2 12            	ld	de, EXstr
    2549/     B69 : C3 60 11            	jp	mkopcstr
    2550/     B6C :                     
    2551/     B6C :                     ; EX AF,AF'
    2552/     B6C :                     ex_af_af:
    2553/     B6C : 11 7C 12            	ld	de, RNAF
    2554/     B6F : CD B3 11            	call	mk_rcs
    2555/     B72 : 11 7F 12            	ld	de, RNAFX
    2556/     B75 : CD 89 11            	call	cpstr_crlf
    2557/     B78 : 18 EC               	jr ins_ex_opc
    2558/     B7A :                     
    2559/     B7A :                     ; EX (SP),HL
    2560/     B7A :                     dex_sp_hl:
    2561/     B7A : 11 32 2E            	ld	de, RNSP
    2562/     B7D : CD A2 11            	call	mk_krkcs
    2563/     B80 : 18 E1               	jr	ins_hl_opr
    2564/     B82 :                     
    2565/     B82 :                     ; check other one MC code
    2566/     B82 :                     
    2567/     B82 :                     chk_1mc_bnh:
    2568/     B82 :                     
    2569/     B82 :                     ; check JP (HL)
    2570/     B82 :                     
    2571/     B82 : FE E9               	cp	0E9H		; JP (HL) ?
    2572/     B84 : 20 0F               	jr	nz, chk_ret
    2573/     B86 :                     
    2574/     B86 :                     ; JP (HL)
    2575/     B86 : 11 87 12            	ld	de, JPstr
    2576/     B89 : CD 60 11            	call	mkopcstr	; "JP "
    2577/     B8C :                     
    2578/     B8C : 11 FF 2D            	ld	de, RNHL
    2579/     B8F : CD 97 11            	call	mk_krk_1
    2580/     B92 : C3 8C 11            	jp	insPostStr
    2581/     B95 :                     
    2582/     B95 :                     ; check RET CC
    2583/     B95 :                     chk_ret:
    2584/     B95 : 01 08 00            	ld	bc, RETCC_TBLE - RETCC_TBLS
    2585/     B98 : 21 D2 06            	ld	hl, RETCC_TBLS
    2586/     B9B : ED B1               	cpir
    2587/     B9D : 20 0F               	jr	nz, chk_rst
    2588/     B9F :                     
    2589/     B9F :                     ; RET CC
    2590/     B9F :                     ; BC : 7 >= BC >= 0
    2591/     B9F :                     
    2592/     B9F :                     	; make opcode string
    2593/     B9F : 11 83 12            	ld	de, RETstr
    2594/     BA2 : CD 60 11            	call	mkopcstr
    2595/     BA5 :                     
    2596/     BA5 :                     	; make operand string
    2597/     BA5 :                     
    2598/     BA5 : 21 C6 13            	ld	hl, CC_opr	; string base
    2599/     BA8 : CD D6 10            	call	mk_str
    2600/     BAB : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2601/     BAE :                     
    2602/     BAE :                     ; check RST p
    2603/     BAE :                     
    2604/     BAE :                     chk_rst:
    2605/     BAE : 01 08 00            	ld	bc, RST_TBLE - RST_TBLS
    2606/     BB1 : 21 EF 06            	ld	hl, RST_TBLS
    2607/     BB4 : ED B1               	cpir
    2608/     BB6 : 20 17               	jr	nz, chk_2MC		; 2bytes MC
    2609/     BB8 :                     
    2610/     BB8 :                     ; RST p
    2611/     BB8 :                     
    2612/     BB8 : 11 97 12            	ld	de, RSTstr
    2613/     BBB : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    2614/     BBE :                     
    2615/     BBE :                     ; 0 <= BC <= 7
    2616/     BBE :                     ; 7: 00H  (0000 0 111 : 00 000 000)
    2617/     BBE :                     ; 6: 08H  (0000 0 110 : 00 001 000)
    2618/     BBE :                     ; 5: 10H  (0000 0 101 : 00 010 000)
    2619/     BBE :                     ; 4: 18H  (0000 0 100 : 00 011 000)
    2620/     BBE :                     ; 3: 20H  (0000 0 011 : 00 100 000)
    2621/     BBE :                     ; 2: 28H  (0000 0 010 : 00 101 000)
    2622/     BBE :                     ; 1: 30H  (0000 0 001 : 00 110 000)
    2623/     BBE :                     ; 0: 38H  (0000 0 000 : 00 111 000)
    2624/     BBE :                     ;
    2625/     BBE : 79                  	ld	a, c
    2626/     BBF : 2F                  	cpl		; not a
    2627/     BC0 : CB 27               	sla	a
    2628/     BC2 : CB 27               	sla	a
    2629/     BC4 : CB 27               	sla	a
    2630/     BC6 : E6 38               	and	38H	; a = RST No.
    2631/     BC8 :                     
    2632/     BC8 : 5F                  	ld	e, a
    2633/     BC9 : 21 E9 FF            	ld	hl, dasm_OprStr
    2634/     BCC : C3 EB 10            	jp	mk_n2crlf	; "nnH", CR, LF
    2635/     BCF :                     
    2636/     BCF :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2637/     BCF :                     	; analysys 2 byte MC
    2638/     BCF :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2639/     BCF :                     
    2640/     BCF :                     chk_2MC:
    2641/     BCF :                     
    2642/     BCF : F5                  	push	af
    2643/     BD0 : 3E 02               	ld	a, 2
    2644/     BD2 : 32 43 FF            	ld	(mc_Size), a
    2645/     BD5 : F1                  	pop	af
    2646/     BD6 :                     
    2647/     BD6 :                     ; check LD r, nn
    2648/     BD6 :                     
    2649/     BD6 : 01 08 00            	ld	bc, ld_r_nn_e - ld_r_nn_s
    2650/     BD9 : 21 90 07            	ld	hl, ld_r_nn_s
    2651/     BDC : ED B1               	cpir
    2652/     BDE : 20 16               	jr	nz, chk_logop2
    2653/     BE0 :                     
    2654/     BE0 :                     ; LD r, nn
    2655/     BE0 :                     
    2656/     BE0 : CD C4 09            	call	get_r_num
    2657/     BE3 : CD DF 10            	call	get_rstg_off
    2658/     BE6 : CD B3 11            	call	mk_rcs		; "REG, "
    2659/     BE9 :                     
    2660/     BE9 : ED 5B 3D FF         	ld	de, (dasm_adr)
    2661/     BED : 13                  	inc	de
    2662/     BEE : 1A                  	ld	a, (de)		; get nn
    2663/     BEF : 5F                  	ld	e, a
    2664/     BF0 : CD 2E 11            	call	hex2str_asm	; "nnH"
    2665/     BF3 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2666/     BF6 :                     
    2667/     BF6 :                     ; check logical operation with 8 bit literal
    2668/     BF6 :                     
    2669/     BF6 :                     chk_logop2:
    2670/     BF6 :                     
    2671/     BF6 : 01 0A 00            	ld	bc, log_op_e - log_op_s
    2672/     BF9 : 21 98 07            	ld	hl, log_op_s
    2673/     BFC : ED B1               	cpir
    2674/     BFE : C2 4A 0C            	jp	nz, chk_djnz
    2675/     C01 :                     
    2676/     C01 :                     ; logical operation with 8 bit literal
    2677/     C01 :                     
    2678/     C01 :                     
    2679/     C01 : C5                  	push	bc
    2680/     C02 : 21 08 14            	ld	hl, logop2str
    2681/     C05 : CD E2 10            	call	get_strBufpoint
    2682/     C08 : CD 60 11            	call	mkopcstr		; make op code string
    2683/     C0B : C1                  	pop	bc
    2684/     C0C : 79                  	ld	a, c
    2685/     C0D :                     
    2686/     C0D : FE 01               	cp	1
    2687/     C0F : 28 14               	jr	z, acs_kn2k	; insert "A, (nn)"
    2688/     C11 : B7                  	or	a
    2689/     C12 : 28 1A               	jr	z, ins_kn2k	; insert "(nn), A"
    2690/     C14 : FE 07               	cp	7
    2691/     C16 : 38 03               	jr	c, ins_n2crlf	; insert  "nnH"
    2692/     C18 :                     
    2693/     C18 :                     ; insert "A, "
    2694/     C18 :                     
    2695/     C18 : CD B0 11            	call	a_colon_sp
    2696/     C1B :                     
    2697/     C1B :                     ; "nn"
    2698/     C1B :                     ins_n2crlf:
    2699/     C1B : ED 5B 3D FF         	ld	de, (dasm_adr)
    2700/     C1F : 13                  	inc	de
    2701/     C20 : 1A                  	ld	a, (de)
    2702/     C21 : 5F                  	ld	e, a		; get nn
    2703/     C22 : C3 EB 10            	jp	mk_n2crlf	; "nnH", CR, LF
    2704/     C25 :                     
    2705/     C25 :                     acs_kn2k:
    2706/     C25 : CD B0 11            	call	a_colon_sp	; "A, "
    2707/     C28 : CD 3A 0C            	call	kn2k		; "(nnH)"
    2708/     C2B : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    2709/     C2E :                     
    2710/     C2E :                     ; "(nn), A"
    2711/     C2E :                     ins_kn2k:
    2712/     C2E : 21 E9 FF            	ld	hl, dasm_OprStr	;operand str buffer
    2713/     C31 : CD 3A 0C            	call	kn2k		; "(nnH)"
    2714/     C34 : CD D8 11            	call	ins_kmR		; " ,"
    2715/     C37 : C3 7B 11            	jp	a_crlf		; "A", CR, LF, 00h
    2716/     C3A :                     
    2717/     C3A :                     ; "(nnH)"
    2718/     C3A :                     kn2k:
    2719/     C3A : CD C3 11            	call	ins_kakkoL	; "("
    2720/     C3D : ED 5B 3D FF         	ld	de, (dasm_adr)
    2721/     C41 : 13                  	inc	de
    2722/     C42 : 1A                  	ld	a, (de)		; get nn
    2723/     C43 : 5F                  	ld	e, a		; e: nn
    2724/     C44 : CD 2E 11            	call	hex2str_asm	; hex strings
    2725/     C47 : C3 C7 11            	jp	ins_kakkoR	; ")"
    2726/     C4A :                     
    2727/     C4A :                     
    2728/     C4A :                     ; check DJNZ nn
    2729/     C4A :                     chk_djnz:
    2730/     C4A : FE 10               	cp	10H
    2731/     C4C : 20 05               	jr	nz, chk_jrnn
    2732/     C4E :                     
    2733/     C4E :                     ; check DJNZ nn
    2734/     C4E : 11 8D 12            	ld	de, DJNZstr
    2735/     C51 : 18 07               	jr	jr_n4crlf
    2736/     C53 :                     
    2737/     C53 :                     ; check jr nn
    2738/     C53 :                     chk_jrnn:
    2739/     C53 : FE 18               	cp	18H
    2740/     C55 : 20 0C               	jr	nz, chk_jrcc	; not JR relative
    2741/     C57 :                     
    2742/     C57 :                     ; JR Relative
    2743/     C57 : 11 8A 12            	ld	de, JRstr
    2744/     C5A :                     jr_n4crlf:
    2745/     C5A : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    2746/     C5D : 21 E9 FF            	ld	hl, dasm_OprStr
    2747/     C60 : C3 0F 11            	jp	mkRel_str	; "nnnnH",cr,lf : nnnn : branch address
    2748/     C63 :                     
    2749/     C63 :                     ; JR CC, nn
    2750/     C63 :                     
    2751/     C63 :                     chk_jrcc:
    2752/     C63 : 01 04 00            	ld	bc, JRCC_TBLE - JRCC_TBLS1
    2753/     C66 : 21 DB 06            	ld	hl, JRCC_TBLS1
    2754/     C69 : ED B1               	cpir
    2755/     C6B : 20 12               	jr	nz, chk_3MC	; no, check 3 bnytes MC
    2756/     C6D :                     
    2757/     C6D :                     ; JR CC, nn(Relative Value)
    2758/     C6D :                     
    2759/     C6D : 11 8A 12            	ld	de, JRstr
    2760/     C70 : CD 60 11            	call	mkopcstr
    2761/     C73 : 21 D6 13            	ld	hl, JRCC_opr1	; string base
    2762/     C76 : CD D6 10            	call	mk_str		; "NZ", "Z", "NC", "C"
    2763/     C79 : CD D8 11            	call	ins_kmR		; ", "
    2764/     C7C : C3 0F 11            	jp	mkRel_str	; "nnnnH", cr, lf
    2765/     C7F :                     
    2766/     C7F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2767/     C7F :                     	; analysys 3 byte MC
    2768/     C7F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2769/     C7F :                     
    2770/     C7F :                     chk_3MC:
    2771/     C7F : F5                  	push	af
    2772/     C80 : 3E 03               	ld	a, 3
    2773/     C82 : 32 43 FF            	ld	(mc_Size), a
    2774/     C85 : F1                  	pop	af
    2775/     C86 :                     
    2776/     C86 : 01 04 00            	ld	bc, THREE_OPTBLe - THREE_OPTBL
    2777/     C89 : 21 A2 07            	ld	hl, THREE_OPTBL
    2778/     C8C : ED B1               	cpir
    2779/     C8E : C2 A0 0C            	jp	nz, chk_ld16
    2780/     C91 :                     
    2781/     C91 :                     ; LD rp, nnnn
    2782/     C91 :                     
    2783/     C91 : 21 1C 14            	ld	hl, logop3str
    2784/     C94 : CD E2 10            	call	get_strBufpoint
    2785/     C97 : CD B3 11            	call	mk_rcs		; "Reg, "
    2786/     C9A :                     
    2787/     C9A :                     get_n4crlf:
    2788/     C9A : CD C8 0C            	call	get_n4
    2789/     C9D : C3 F1 10            	jp	mk_n4crlf	; "nnnnH", CR, LF, 00h
    2790/     CA0 :                     
    2791/     CA0 :                     ; LD 16bit literal
    2792/     CA0 :                     chk_ld16:
    2793/     CA0 : FE 22               	cp	22h
    2794/     CA2 : 28 12               	jr	z, ins_kkhl	; "(nnnnH), HL"
    2795/     CA4 : FE 32               	cp	32h
    2796/     CA6 : 28 14               	jr	z, ins_kka	; "(nnnnH), A"
    2797/     CA8 : FE 2A               	cp	2ah
    2798/     CAA : 28 26               	jr	z, ins_hlkk	; "HL, (nnnnH)"
    2799/     CAC : FE 3A               	cp	3ah
    2800/     CAE : C2 E1 0C            	jp	nz, chk_jpn4	; check jp n4
    2801/     CB1 :                     
    2802/     CB1 :                     ; "A, (nnnnH)"
    2803/     CB1 : CD B0 11            	call	a_colon_sp	; "A, "
    2804/     CB4 : 18 22               	jr	kn4kcrlf
    2805/     CB6 :                     
    2806/     CB6 :                     ; "(nnnnH), HL"
    2807/     CB6 :                     ins_kkhl:
    2808/     CB6 : CD C2 0C            	call	kn4hk
    2809/     CB9 : C3 86 11            	jp	hl_crlf		; "HL",cr,lf
    2810/     CBC :                     
    2811/     CBC :                     ; "(nnnnH), A"
    2812/     CBC :                     ins_kka:
    2813/     CBC : CD C2 0C            	call	kn4hk
    2814/     CBF : C3 7B 11            	jp	a_crlf		; "A",cr,lf
    2815/     CC2 :                     
    2816/     CC2 :                     kn4hk:
    2817/     CC2 : CD C8 0C            	call	get_n4
    2818/     CC5 : C3 F7 10            	jp	ins_kn4kcs	; "(nnnnH), "
    2819/     CC8 :                     
    2820/     CC8 :                     get_n4:
    2821/     CC8 : E5                  	push	hl
    2822/     CC9 : 2A 3D FF            	ld	hl, (dasm_adr)
    2823/     CCC : 23                  	inc	hl
    2824/     CCD : 5E                  	ld	e, (hl)
    2825/     CCE : 23                  	inc	hl
    2826/     CCF : 56                  	ld	d, (hl)
    2827/     CD0 : E1                  	pop	hl
    2828/     CD1 : C9                  	ret
    2829/     CD2 :                     
    2830/     CD2 :                     ; "HL, (nnnnH)"
    2831/     CD2 :                     ins_hlkk:
    2832/     CD2 : 11 FF 2D            	ld	de, RNHL
    2833/     CD5 : CD B3 11            	call	mk_rcs		; "HL ,"
    2834/     CD8 :                     
    2835/     CD8 :                     kn4kcrlf:
    2836/     CD8 : CD C8 0C            	call	get_n4
    2837/     CDB : CD 06 11            	call	mk_kn4k		; "(nnnnH)"
    2838/     CDE : C3 8C 11            	jp	insPostStr	; cr, lf
    2839/     CE1 :                     
    2840/     CE1 :                     ; check JP literal
    2841/     CE1 :                     
    2842/     CE1 :                     chk_jpn4:
    2843/     CE1 : FE C3               	cp	0C3H		; JP literal ?
    2844/     CE3 : 20 08               	jr	nz, chk_calln4	; not JP literal
    2845/     CE5 :                     
    2846/     CE5 :                     ; "JP nnnnH"
    2847/     CE5 :                     
    2848/     CE5 : 11 87 12            	ld	de, JPstr
    2849/     CE8 : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    2850/     CEB : 18 AD               	jr	get_n4crlf
    2851/     CED :                     
    2852/     CED :                     ; check call literal
    2853/     CED :                     
    2854/     CED :                     chk_calln4:
    2855/     CED : FE CD               	cp	0CDH		; CALL literal ?
    2856/     CEF : 20 08               	jr	nz, chk_jpcc
    2857/     CF1 :                     
    2858/     CF1 :                     ; "CALL nnnnH",cr,lf
    2859/     CF1 :                     
    2860/     CF1 : 11 92 12            	ld	de, CALLstr
    2861/     CF4 : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    2862/     CF7 : 18 A1               	jr	get_n4crlf
    2863/     CF9 :                     
    2864/     CF9 :                     
    2865/     CF9 :                     ; check 3 byte machine code: branch JP CC, nnnn
    2866/     CF9 :                     
    2867/     CF9 :                     chk_jpcc:
    2868/     CF9 : 01 08 00            	ld	bc, JPCC_TBLE - JPCC_TBLS
    2869/     CFC : 21 DF 06            	ld	hl, JPCC_TBLS
    2870/     CFF : ED B1               	cpir
    2871/     D01 : 20 11               	jr	nz, chk_calcc
    2872/     D03 :                     
    2873/     D03 :                     ; JP CC, nnnn
    2874/     D03 :                     ; BC : 7 >= BC >= 0
    2875/     D03 :                     
    2876/     D03 : 11 87 12            	ld	de, JPstr
    2877/     D06 :                     
    2878/     D06 :                     CC_NNNN:
    2879/     D06 : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    2880/     D09 :                     
    2881/     D09 : 21 C6 13            	ld	hl, CC_opr	; string base
    2882/     D0C : CD D6 10            	call	mk_str		; de: point (string end) + 1
    2883/     D0F : CD D8 11            	call	ins_kmR		; " ,"
    2884/     D12 : 18 86               	jr	get_n4crlf	; "nnnnh", cr,lf
    2885/     D14 :                     
    2886/     D14 :                     
    2887/     D14 :                     ; check 3 byte machine code: branch (CALL CC, nnnn 16bit literal)
    2888/     D14 :                     
    2889/     D14 :                     chk_calcc:
    2890/     D14 : 01 08 00            	ld	bc, CLCC_TBLE - CLCC_TBLS
    2891/     D17 : 21 E7 06            	ld	hl, CLCC_TBLS
    2892/     D1A : ED B1               	cpir
    2893/     D1C : 20 05               	jr	nz, chk_0CBH
    2894/     D1E :                     
    2895/     D1E :                     ; CALL CC, nnnn
    2896/     D1E :                     ; BC : 7 >= BC >= 0 CALLstr
    2897/     D1E :                     
    2898/     D1E : 11 92 12            	ld	de, CALLstr
    2899/     D21 : 18 E3               	jr	CC_NNNN
    2900/     D23 :                     
    2901/     D23 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2902/     D23 :                     	; OPECODE 0CBH check
    2903/     D23 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    2904/     D23 :                     
    2905/     D23 :                     chk_0CBH:
    2906/     D23 : 2A 3D FF            	ld	hl, (dasm_adr)
    2907/     D26 : 23                  	inc	hl		; 2nd opecode address
    2908/     D27 :                     
    2909/     D27 : F5                  	push	af
    2910/     D28 : 3E 02               	ld	a, 2
    2911/     D2A : 32 43 FF            	ld	(mc_Size), a	; set 2bytes MC
    2912/     D2D : F1                  	pop	af
    2913/     D2E :                     
    2914/     D2E : FE CB               	cp	0cbh
    2915/     D30 : C2 E9 0D            	jp	nz, chk_0DDH
    2916/     D33 :                     
    2917/     D33 : 7E                  	ld	a, (hl)		; a : 2nd opecode
    2918/     D34 : 21 E9 FF            	ld	hl, dasm_OprStr ; set operand string buffer
    2919/     D37 :                     
    2920/     D37 : FE 08               	cp	08h
    2921/     D39 : DA 72 0D            	jp	c, mk_rlcr
    2922/     D3C : FE 10               	cp	10h
    2923/     D3E : DA 7B 0D            	jp	c, mk_rrcr
    2924/     D41 : FE 18               	cp	18h
    2925/     D43 : DA 84 0D            	jp	c, mk_rlr
    2926/     D46 : FE 20               	cp	20h
    2927/     D48 : DA 8D 0D            	jp	c, mk_rrr
    2928/     D4B : FE 28               	cp	28h
    2929/     D4D : DA 96 0D            	jp	c, mk_slar
    2930/     D50 : FE 30               	cp	30h
    2931/     D52 : DA 9F 0D            	jp	c, mk_srar
    2932/     D55 : FE 38               	cp	38h
    2933/     D57 : DA C3 0D            	jp	c, op_err
    2934/     D5A : FE 40               	cp	40h
    2935/     D5C : DA A8 0D            	jp	c, mk_srlr
    2936/     D5F : FE 80               	cp	80h
    2937/     D61 : DA B1 0D            	jp	c, mk_bitr
    2938/     D64 : FE C0               	cp	0c0h
    2939/     D66 : DA BA 0D            	jp	c, mk_resr
    2940/     D69 :                     
    2941/     D69 :                     ; make SET n, r, SET n, (HL)
    2942/     D69 :                     
    2943/     D69 : CD C9 0D            	call	mk_bitr_str
    2944/     D6C : 11 91 13            	ld	de, SETstr
    2945/     D6F : C3 60 11            	jp	mkopcstr
    2946/     D72 :                     
    2947/     D72 :                     
    2948/     D72 :                     ; make RLC r, RLC (HL)
    2949/     D72 :                     mk_rlcr:
    2950/     D72 : CD CE 0D            	call	ins_rstg
    2951/     D75 : 11 0C 13            	ld	de, RLCstr
    2952/     D78 : C3 60 11            	jp	mkopcstr
    2953/     D7B :                     
    2954/     D7B :                     ; make RRC r, RRC (HL)
    2955/     D7B :                     mk_rrcr:
    2956/     D7B : CD CE 0D            	call	ins_rstg
    2957/     D7E : 11 10 13            	ld	de, RRCstr
    2958/     D81 : C3 60 11            	jp	mkopcstr
    2959/     D84 :                     
    2960/     D84 :                     ; make RL r, RL (HL)
    2961/     D84 :                     mk_rlr:
    2962/     D84 : CD CE 0D            	call	ins_rstg
    2963/     D87 : 11 14 13            	ld	de, RLstr
    2964/     D8A : C3 60 11            	jp	mkopcstr
    2965/     D8D :                     
    2966/     D8D :                     ; make RR r, RR (HL)
    2967/     D8D :                     mk_rrr:
    2968/     D8D : CD CE 0D            	call	ins_rstg
    2969/     D90 : 11 17 13            	ld	de, RRstr
    2970/     D93 : C3 60 11            	jp	mkopcstr
    2971/     D96 :                     
    2972/     D96 :                     ; make SLA r, SLA (HL)
    2973/     D96 :                     mk_slar:
    2974/     D96 : CD CE 0D            	call	ins_rstg
    2975/     D99 : 11 1A 13            	ld	de, SLAstr
    2976/     D9C : C3 60 11            	jp	mkopcstr
    2977/     D9F :                     
    2978/     D9F :                     ; make SRA r, SRA (HL)
    2979/     D9F :                     mk_srar:
    2980/     D9F : CD CE 0D            	call	ins_rstg
    2981/     DA2 : 11 1E 13            	ld	de, SRAstr
    2982/     DA5 : C3 60 11            	jp	mkopcstr
    2983/     DA8 :                     
    2984/     DA8 :                     ; make SRL r, SRL (HL)
    2985/     DA8 :                     mk_srlr:
    2986/     DA8 : CD CE 0D            	call	ins_rstg
    2987/     DAB : 11 22 13            	ld	de, SRLstr
    2988/     DAE : C3 60 11            	jp	mkopcstr
    2989/     DB1 :                     
    2990/     DB1 :                     ; make BIT n, r, BIT n, (HL)
    2991/     DB1 :                     mk_bitr:
    2992/     DB1 : CD C9 0D            	call	mk_bitr_str
    2993/     DB4 : 11 26 13            	ld	de, BITstr
    2994/     DB7 : C3 60 11            	jp	mkopcstr
    2995/     DBA :                     
    2996/     DBA :                     ; make RES n, r, RES n, (HL)
    2997/     DBA :                     mk_resr:
    2998/     DBA : CD C9 0D            	call	mk_bitr_str
    2999/     DBD : 11 2A 13            	ld	de, RESstr
    3000/     DC0 : C3 60 11            	jp	mkopcstr
    3001/     DC3 :                     
    3002/     DC3 :                     op_err:
    3003/     DC3 : 11 95 13            	ld	de, ER_OPMSG
    3004/     DC6 : C3 60 11            	jp	mkopcstr
    3005/     DC9 :                     
    3006/     DC9 :                     ;-------------------------------------------
    3007/     DC9 :                     ; input a : 2nd opecode
    3008/     DC9 :                     ;	hl : make string buffer
    3009/     DC9 :                     ; make "bit No, r" string to *hl
    3010/     DC9 :                     ; (ex) *hl = "1, B"
    3011/     DC9 :                     ;-------------------------------------------
    3012/     DC9 :                     mk_bitr_str:
    3013/     DC9 : F5                  	push	af
    3014/     DCA : CD DB 0D            	call	set_bitno
    3015/     DCD : F1                  	pop	af
    3016/     DCE :                     
    3017/     DCE :                     ins_rstg:
    3018/     DCE : E6 07               	and	07h
    3019/     DD0 : 4F                  	ld	c, a	; table offset
    3020/     DD1 : 06 00               	ld	b, 0		; bc : string offset
    3021/     DD3 : E5                  	push	hl
    3022/     DD4 : CD DF 10            	call	get_rstg_off	; get string address to de
    3023/     DD7 : E1                  	pop	hl
    3024/     DD8 : C3 89 11            	jp	cpstr_crlf	; "REG", CR, LF, 00h
    3025/     DDB :                     ;
    3026/     DDB :                     ; input hl : make string buffer
    3027/     DDB :                     ;
    3028/     DDB :                     set_bitno:
    3029/     DDB : E6 38               	and	38h
    3030/     DDD : 0F                  	rrca
    3031/     DDE : 0F                  	rrca
    3032/     DDF : 0F                  	rrca
    3033/     DE0 : 47                  	ld	b, a	; bit number
    3034/     DE1 :                     
    3035/     DE1 : 3E 30               	ld	a, 30h
    3036/     DE3 : B0                  	or	b		; a : bit string "0" - "7"
    3037/     DE4 : 77                  	ld	(hl), a
    3038/     DE5 : 23                  	inc	hl
    3039/     DE6 : C3 D8 11            	jp	ins_kmR
    3040/     DE9 :                     
    3041/     DE9 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3042/     DE9 :                     	; OPECODE 0DDH check
    3043/     DE9 :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3044/     DE9 :                     
    3045/     DE9 :                     chk_0DDH:
    3046/     DE9 : FE DD               	cp	0ddh
    3047/     DEB : C2 8F 0F            	jp	nz, chk_0EDH
    3048/     DEE :                     
    3049/     DEE : 11 2C 2E            	ld	de, RNIX
    3050/     DF1 : ED 53 3F FF         	ld	(reg_xy), de	; save index reg string
    3051/     DF5 : 11 38 14            	ld	de, addixrp_tbl
    3052/     DF8 : ED 53 41 FF         	ld	(xy_srtp), de
    3053/     DFC :                     
    3054/     DFC :                     chk_0DDH_1:
    3055/     DFC :                     
    3056/     DFC : 7E                  	ld	a, (hl)		; get 2nd opcode
    3057/     DFD :                     
    3058/     DFD : FE E3               	cp	0E3h	; EX (SP),IX
    3059/     DFF : CA 43 0E            	jp	z, ins_kspkix
    3060/     E02 : FE E9               	cp	0E9h	; JP (IX)
    3061/     E04 : CA 31 0E            	jp	z, ins_jpix
    3062/     E07 : FE F9               	cp	0F9h	; LD SP, IX
    3063/     E09 : CA 52 0E            	jp	z, ins_spix
    3064/     E0C :                     
    3065/     E0C : 01 04 00            	ld	bc, DD_2NDTBL1 - DD_2NDTBL
    3066/     E0F : 21 AA 07            	ld	hl, DD_2NDTBL
    3067/     E12 : ED B1               	cpir
    3068/     E14 : CA 5B 0E            	jp	z, ins_ixrp
    3069/     E17 :                     
    3070/     E17 : 01 04 00            	ld	bc, DD_2NDTBL2 - DD_2NDTBL1
    3071/     E1A : 21 AE 07            	ld	hl, DD_2NDTBL1
    3072/     E1D : ED B1               	cpir
    3073/     E1F : C2 70 0E            	jp	nz, chk_0DD3op
    3074/     E22 :                     
    3075/     E22 :                     ; INC	IX
    3076/     E22 :                     ; DEC	IX
    3077/     E22 :                     ; PUSH	IX
    3078/     E22 :                     ; POP	IX
    3079/     E22 : 21 30 14            	ld	hl, dd_2opt
    3080/     E25 : CD E2 10            	call	get_strBufpoint
    3081/     E28 : CD 60 11            	call	mkopcstr		; inseert OPCODE strings to dasm_OpcStr
    3082/     E2B :                     
    3083/     E2B : 21 E9 FF            	ld	hl, dasm_OprStr
    3084/     E2E : C3 80 11            	jp	ix_crlf			; "IX", CR, LF, 00h
    3085/     E31 :                     
    3086/     E31 :                     ; JP	(IX)
    3087/     E31 :                     ins_jpix:
    3088/     E31 : ED 5B 3F FF         	ld	de, (reg_xy)
    3089/     E35 :                     ins_jpix1:
    3090/     E35 : D5                  	push	de
    3091/     E36 : 11 87 12            	ld	de, JPstr
    3092/     E39 : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    3093/     E3C :                     
    3094/     E3C : D1                  	pop	de
    3095/     E3D : CD 97 11            	call	mk_krk_1
    3096/     E40 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    3097/     E43 :                     
    3098/     E43 :                     ; EX	(SP),IX
    3099/     E43 :                     ins_kspkix:
    3100/     E43 : 11 D2 12            	ld	de, EXstr
    3101/     E46 : CD 60 11            	call	mkopcstr	; de : next string buffer addr
    3102/     E49 : 11 32 2E            	ld	de, RNSP
    3103/     E4C : CD A2 11            	call	mk_krkcs	; "(SP), "
    3104/     E4F : C3 80 11            	jp	ix_crlf		; "IX",cr,lf
    3105/     E52 :                     
    3106/     E52 :                     ; LD	SP,IX
    3107/     E52 :                     ins_spix:
    3108/     E52 : 11 32 2E            	ld	de, RNSP
    3109/     E55 : CD B3 11            	call	mk_rcs		; "SP, "
    3110/     E58 : C3 80 11            	jp	ix_crlf		; "IX",cr,lf
    3111/     E5B :                     
    3112/     E5B :                     ; ADD	IX,BC
    3113/     E5B :                     ; ADD	IX,DE
    3114/     E5B :                     ; ADD	IX,IX
    3115/     E5B :                     ; ADD	IX,SP
    3116/     E5B :                     ins_ixrp:
    3117/     E5B : CD 5D 11            	call	add_opstr	; de : next string buffer addr
    3118/     E5E :                     
    3119/     E5E : ED 5B 3F FF         	ld	de, (reg_xy)
    3120/     E62 : CD B3 11            	call	mk_rcs		; "IX, "
    3121/     E65 :                     
    3122/     E65 : E5                  	push	hl
    3123/     E66 : 2A 41 FF            	ld	hl, (xy_srtp)
    3124/     E69 : CD E2 10            	call	get_strBufpoint
    3125/     E6C : E1                  	pop	hl
    3126/     E6D : C3 89 11            	jp	cpstr_crlf	; "REG",cr,lf
    3127/     E70 :                     
    3128/     E70 :                     ;
    3129/     E70 :                     ; check 0DD 3bytes MC
    3130/     E70 :                     ;
    3131/     E70 :                     chk_0DD3op:
    3132/     E70 : F5                  	push	af
    3133/     E71 : 3E 03               	ld	a, 3
    3134/     E73 : 32 43 FF            	ld	(mc_Size), a	; 2byte machine code
    3135/     E76 : F1                  	pop	af
    3136/     E77 :                     
    3137/     E77 : 01 0E 00            	ld	bc, dd_ld_tble - dd_ld_tbl
    3138/     E7A : 21 10 12            	ld	hl, dd_ld_tbl
    3139/     E7D : ED B1               	cpir
    3140/     E7F : CA AF 0E            	jp	z, dd_ld
    3141/     E82 :                     
    3142/     E82 : FE 86               	cp	86h
    3143/     E84 : CA DA 0E            	jp	z, dd_mix
    3144/     E87 : FE 8E               	cp	8eh
    3145/     E89 : CA E5 0E            	jp	z, dd_mix1
    3146/     E8C : FE 9E               	cp	9eh
    3147/     E8E : CA EA 0E            	jp	z, dd_mix2
    3148/     E91 :                     
    3149/     E91 : 01 07 00            	ld	bc, dd_log_tble - dd_log_tbl
    3150/     E94 : 21 1E 12            	ld	hl, dd_log_tbl
    3151/     E97 : ED B1               	cpir
    3152/     E99 : C2 EF 0E            	jp	nz, chk_0DD4op
    3153/     E9C :                     
    3154/     E9C :                     ;
    3155/     E9C :                     ; make "SUB (IX+nn)", "AND (IX+nn)", "XOR (IX+nn)"
    3156/     E9C :                     ;       "OR (IX+nn)",  "CP (IX+nn)"
    3157/     E9C :                     ;      "INC (IX+nn)", "DEC (IX+nn)"
    3158/     E9C :                     ;
    3159/     E9C : 21 48 14            	ld	hl, ddlogtbl
    3160/     E9F : CD E2 10            	call	get_strBufpoint
    3161/     EA2 : CD 60 11            	call	mkopcstr
    3162/     EA5 :                     
    3163/     EA5 :                     mk_kixpnk:
    3164/     EA5 : ED 5B 3F FF         	ld	de, (reg_xy)
    3165/     EA9 :                     
    3166/     EA9 :                     mk_kiypnk:
    3167/     EA9 : 21 E9 FF            	ld	hl, dasm_OprStr
    3168/     EAC : C3 A6 10            	jp	kixypnk_crlf		; "(IX+nnH)",cr,lf
    3169/     EAF :                     
    3170/     EAF :                     ;
    3171/     EAF :                     ; make "LD (IX+nn), r" or "LD r, (IX+nn)"
    3172/     EAF :                     ;
    3173/     EAF :                     dd_ld:
    3174/     EAF : 79                  	ld	a, c
    3175/     EB0 : FE 07               	cp	7
    3176/     EB2 : D2 C7 0E            	jp	nc, dd_ld1
    3177/     EB5 :                     	
    3178/     EB5 :                     ; LD (IX+nn), r
    3179/     EB5 : ED 5B 3F FF         	ld	de, (reg_xy)
    3180/     EB9 : CD 9D 10            	call	kixypnk_cs	; make "(IX+nn), "
    3181/     EBC :                     
    3182/     EBC : E5                  	push	hl
    3183/     EBD : 21 56 14            	ld	hl, dd_ldtbl
    3184/     EC0 : CD E2 10            	call	get_strBufpoint
    3185/     EC3 : E1                  	pop	hl
    3186/     EC4 : C3 89 11            	jp	cpstr_crlf	; "A", "L", "H", "E", D", "C", "B"
    3187/     EC7 :                     				; CR, LF, 00h
    3188/     EC7 :                     	
    3189/     EC7 :                     ; LD r, (IX+nn)
    3190/     EC7 :                     dd_ld1:
    3191/     EC7 : D6 07               	sub	7
    3192/     EC9 : 4F                  	ld	c, a
    3193/     ECA : 21 56 14            	ld	hl, dd_ldtbl
    3194/     ECD : CD E2 10            	call	get_strBufpoint
    3195/     ED0 :                     
    3196/     ED0 : CD B3 11            	call	mk_rcs		; "REG, "
    3197/     ED3 :                     dd_mix4:
    3198/     ED3 : ED 5B 3F FF         	ld	de, (reg_xy)
    3199/     ED7 : C3 A6 10            	jp	kixypnk_crlf	; "(IX+nn)", CR, LF, 00h
    3200/     EDA :                     
    3201/     EDA :                     
    3202/     EDA :                     ; "ADD A,(IX+nn)"
    3203/     EDA :                     dd_mix:
    3204/     EDA : 11 A3 12            	ld	de, ADDstr
    3205/     EDD :                     dd_mix3:
    3206/     EDD : CD 60 11            	call	mkopcstr	; "ADD"
    3207/     EE0 : CD B0 11            	call	a_colon_sp	; "A, "
    3208/     EE3 : 18 EE               	jr	dd_mix4		; "(IX+nn)",cr,lf
    3209/     EE5 :                     
    3210/     EE5 :                     ;"ADC A,(IX+nn)"
    3211/     EE5 :                     dd_mix1:
    3212/     EE5 : 11 A7 12            	ld	de, ADCstr
    3213/     EE8 : 18 F3               	jr	dd_mix3
    3214/     EEA :                     
    3215/     EEA :                     ;"SBC A,(IX+nn)"
    3216/     EEA :                     dd_mix2:
    3217/     EEA : 11 AF 12            	ld	de, SBCstr
    3218/     EED : 18 EE               	jr	dd_mix3
    3219/     EEF :                     
    3220/     EEF :                     ;
    3221/     EEF :                     ; check 0DD 4bytes MC
    3222/     EEF :                     ;
    3223/     EEF :                     chk_0DD4op:
    3224/     EEF : F5                  	push	af
    3225/     EF0 : 3E 04               	ld	a, 4
    3226/     EF2 : 32 43 FF            	ld	(mc_Size), a	; 2byte machine code
    3227/     EF5 : F1                  	pop	af
    3228/     EF6 :                     
    3229/     EF6 : FE 21               	cp	21h
    3230/     EF8 : CA 15 0F            	jp	z, DD_21
    3231/     EFB : FE 22               	cp	22h
    3232/     EFD : CA 22 0F            	jp	z, DD_22
    3233/     F00 : FE 2A               	cp	2ah
    3234/     F02 : CA 2B 0F            	jp	z, DD_2a
    3235/     F05 : FE 36               	cp	36h
    3236/     F07 : C2 3B 0F            	jp	nz, chk_DD_CB
    3237/     F0A :                     ; DD 36
    3238/     F0A :                     ; "LD (IX+xx), yy"
    3239/     F0A :                     
    3240/     F0A : ED 5B 3F FF         	ld	de, (reg_xy)
    3241/     F0E : CD 9D 10            	call	kixypnk_cs	; "(IX+xx), "
    3242/     F11 : 5A                  	ld	e, d		; e: yy
    3243/     F12 : C3 EB 10            	jp	mk_n2crlf	; "0yyH",cr,lf
    3244/     F15 :                     
    3245/     F15 :                     
    3246/     F15 :                     ; "LD IX, nnnn"
    3247/     F15 :                     DD_21:
    3248/     F15 : ED 5B 3F FF         	ld	de, (reg_xy)
    3249/     F19 : CD B3 11            	call	mk_rcs		; "IX, "
    3250/     F1C : CD CB 10            	call	get_nnnn
    3251/     F1F : C3 F1 10            	jp	mk_n4crlf	; "nnnnH",cr,lf
    3252/     F22 :                     
    3253/     F22 :                     ; "LD (nnnn), IX"
    3254/     F22 :                     DD_22:
    3255/     F22 : CD CB 10            	call	get_nnnn
    3256/     F25 : CD F7 10            	call	ins_kn4kcs	; "(nnnnH), "
    3257/     F28 : C3 80 11            	jp	ix_crlf		; "IX",cr,lf
    3258/     F2B :                     
    3259/     F2B :                     ; "LD IX, (nnnn)"
    3260/     F2B :                     DD_2a:
    3261/     F2B : ED 5B 3F FF         	ld	de, (reg_xy)
    3262/     F2F :                     DD_2a1:
    3263/     F2F : CD B3 11            	call	mk_rcs		; "IX, "
    3264/     F32 : CD CB 10            	call	get_nnnn
    3265/     F35 : CD 06 11            	call	mk_kn4k		; "(nnnnH)"
    3266/     F38 : C3 8C 11            	jp	insPostStr	; cr,lf
    3267/     F3B :                     
    3268/     F3B :                     chk_DD_CB
    3269/     F3B : FE CB               	cp	0CBH
    3270/     F3D : C2 C3 0D            	jp	nz, op_err
    3271/     F40 :                     
    3272/     F40 : CD CB 10            	call	get_nnnn	; d: 3rd OP, e:nn
    3273/     F43 : 7A                  	ld	a, d
    3274/     F44 :                     
    3275/     F44 : 01 07 00            	ld	bc, dd_rt_tble - dd_rt_tbles
    3276/     F47 : 21 25 12            	ld	hl, dd_rt_tbles
    3277/     F4A : ED B1               	cpir
    3278/     F4C : C2 5B 0F            	jp	nz, DD_CB_nn_XX
    3279/     F4F :                     
    3280/     F4F : 21 8E 14            	ld	hl, dd_rt_str
    3281/     F52 : CD E2 10            	call	get_strBufpoint
    3282/     F55 : CD 60 11            	call	mkopcstr	; RLC, RRC, RL, RR, SLA, SRA, SRL
    3283/     F58 : C3 A5 0E            	jp	mk_kixpnk	; "(IX+nnH)",cr,lf
    3284/     F5B :                     
    3285/     F5B :                     ; check BIT, RES, SET
    3286/     F5B :                     DD_CB_nn_XX:
    3287/     F5B :                     
    3288/     F5B :                     	; check undefine MC
    3289/     F5B : 01 18 00            	ld	bc, dd_bit_opTble - dd_bit_opTbl
    3290/     F5E : 21 2C 12            	ld	hl, dd_bit_opTbl
    3291/     F61 : ED B1               	cpir
    3292/     F63 : C2 C3 0D            	jp	nz, op_err
    3293/     F66 :                     
    3294/     F66 : FE 80               	cp	80h
    3295/     F68 : DA 7F 0F            	jp	c, dd_bit
    3296/     F6B : FE C0               	cp	0c0h
    3297/     F6D : DA 87 0F            	jp	c, dd_res
    3298/     F70 :                     
    3299/     F70 :                     ; DD_SET
    3300/     F70 :                     ; "SET i, (IX+nn)"
    3301/     F70 :                     
    3302/     F70 : 11 91 13            	ld	de, SETstr
    3303/     F73 : CD 60 11            	call	mkopcstr
    3304/     F76 :                     
    3305/     F76 :                     DD_BSR:
    3306/     F76 :                     
    3307/     F76 : 21 E9 FF            	ld	hl, dasm_OprStr ; set operand string buffer
    3308/     F79 : CD DB 0D            	call	set_bitno	; "i, "
    3309/     F7C : C3 D3 0E            	jp	dd_mix4		; "(IX+nn)", cr,lf
    3310/     F7F :                     
    3311/     F7F :                     ; DD_BIT
    3312/     F7F :                     ; "BIT i, (IX+nn)"
    3313/     F7F :                     dd_bit:
    3314/     F7F : 11 26 13            	ld	de, BITstr
    3315/     F82 : CD 60 11            	call	mkopcstr
    3316/     F85 : 18 EF               	jr	DD_BSR
    3317/     F87 :                     
    3318/     F87 :                     ; DD_RES
    3319/     F87 :                     ; "RES i, (IX+nn)"
    3320/     F87 :                     dd_res:
    3321/     F87 : 11 2A 13            	ld	de, RESstr
    3322/     F8A : CD 60 11            	call	mkopcstr
    3323/     F8D : 18 E7               	jr	DD_BSR
    3324/     F8F :                     
    3325/     F8F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3326/     F8F :                     	; OPECODE 0EDH check
    3327/     F8F :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3328/     F8F :                     
    3329/     F8F :                     chk_0EDH:
    3330/     F8F : FE ED               	cp	0edh
    3331/     F91 : C2 8C 10            	jp	nz, chk_0FDH
    3332/     F94 :                     
    3333/     F94 : 7E                  	ld	a, (hl)		; get 2nd opcode
    3334/     F95 :                     
    3335/     F95 :                     	; check undefine MC
    3336/     F95 : 01 38 00            	ld	bc, ed_op_tble - ed_op_tbl
    3337/     F98 : 21 44 12            	ld	hl, ed_op_tbl
    3338/     F9B : ED B1               	cpir
    3339/     F9D : C2 C3 0D            	jp	nz, op_err
    3340/     FA0 :                     
    3341/     FA0 : 79                  	ld	a, c
    3342/     FA1 : FE 06               	cp	6
    3343/     FA3 : DA 6D 10            	jp	c, ed_4mc
    3344/     FA6 : FE 1B               	cp	27
    3345/     FA8 : DA 5F 10            	jp	c, ed_no_opr
    3346/     FAB : FE 1E               	cp	30
    3347/     FAD : DA 4C 10            	jp	c, ed_im
    3348/     FB0 : CA 2C 10            	jp	z, ed_ld_ar
    3349/     FB3 : FE 1F               	cp	31
    3350/     FB5 : CA 35 10            	jp	z, ed_ld_ai
    3351/     FB8 : FE 20               	cp	32
    3352/     FBA : CA 3E 10            	jp	z, ed_ld_ra
    3353/     FBD : FE 21               	cp	33
    3354/     FBF : CA 47 10            	jp	z, ed_ld_ia
    3355/     FC2 : FE 26               	cp	38
    3356/     FC4 : DA 1B 10            	jp	c, ed_adc
    3357/     FC7 : FE 2A               	cp	42
    3358/     FC9 : DA 05 10            	jp	c, ed_sbc
    3359/     FCC : FE 31               	cp	49
    3360/     FCE : DA EA 0F            	jp	c, ed_out
    3361/     FD1 :                     
    3362/     FD1 :                     ; c: 49 - 55 : IN r,(C) (r:B,C,D,E,H,L,A)
    3363/     FD1 :                     
    3364/     FD1 : 11 09 13            	ld	de, INstr
    3365/     FD4 : CD 60 11            	call	mkopcstr
    3366/     FD7 :                     
    3367/     FD7 : 79                  	ld	a, c
    3368/     FD8 : D6 31               	sub	49
    3369/     FDA : 4F                  	ld	c, a
    3370/     FDB : 21 56 14            	ld	hl, dd_ldtbl
    3371/     FDE : CD E2 10            	call	get_strBufpoint	; get strung buffer
    3372/     FE1 : CD B3 11            	call	mk_rcs		; "REG, "
    3373/     FE4 : 11 99 13            	ld	de, KCKstr
    3374/     FE7 : C3 89 11            	jp	cpstr_crlf	; "(C)",cr,lf
    3375/     FEA :                     
    3376/     FEA :                     ; c: 42 - 48 : OUT (C),r(r:B,C,D,E,H,L,A)
    3377/     FEA :                     ed_out:
    3378/     FEA : 11 05 13            	ld	de, OUTstr
    3379/     FED : CD 60 11            	call	mkopcstr
    3380/     FF0 :                     
    3381/     FF0 : 11 99 13            	ld	de, KCKstr
    3382/     FF3 : CD B3 11            	call	mk_rcs		; "(C), "
    3383/     FF6 :                     
    3384/     FF6 : 79                  	ld	a, c
    3385/     FF7 : D6 2A               	sub	42
    3386/     FF9 : 4F                  	ld	c, a
    3387/     FFA : E5                  	push	hl
    3388/     FFB : 21 56 14            	ld	hl, dd_ldtbl
    3389/     FFE :                     
    3390/     FFE :                     ed_out1:
    3391/     FFE : CD E2 10            	call	get_strBufpoint	; get strung buffer
    3392/    1001 : E1                  	pop	hl
    3393/    1002 : C3 89 11            	jp	cpstr_crlf	; "REG",cr,lf
    3394/    1005 :                     
    3395/    1005 :                     ; c: 38 - 41 : SBC HL,rr(rr:BC,DE,HL,SP)
    3396/    1005 :                     ed_sbc:
    3397/    1005 : 11 AF 12            	ld	de, SBCstr
    3398/    1008 : CD 60 11            	call	mkopcstr
    3399/    100B :                     
    3400/    100B : 11 FF 2D            	ld	de, RNHL
    3401/    100E : CD B3 11            	call	mk_rcs		; "HL, "
    3402/    1011 :                     
    3403/    1011 : 79                  	ld	a, c
    3404/    1012 : D6 26               	sub	38
    3405/    1014 :                     ed_sbc1:
    3406/    1014 : 4F                  	ld	c, a
    3407/    1015 : E5                  	push	hl
    3408/    1016 : 21 DE 13            	ld	hl, INC_DEC_ADDrp
    3409/    1019 : 18 E3               	jr	ed_out1
    3410/    101B :                     
    3411/    101B :                     ; c: 34 - 37 : ADC HL,rr(rr:BC,DE,HL,SP)
    3412/    101B :                     ed_adc:
    3413/    101B : 11 A7 12            	ld	de, ADCstr
    3414/    101E : CD 60 11            	call	mkopcstr
    3415/    1021 :                     
    3416/    1021 : 11 FF 2D            	ld	de, RNHL
    3417/    1024 : CD B3 11            	call	mk_rcs		; "HL, "
    3418/    1027 :                     
    3419/    1027 : 79                  	ld	a, c
    3420/    1028 : D6 22               	sub	34
    3421/    102A : 18 E8               	jr	ed_sbc1
    3422/    102C :                     
    3423/    102C :                     ; c: 30, 31 : LD A,R ; LD A,I
    3424/    102C :                     ed_ld_ar:
    3425/    102C : CD B0 11            	call	a_colon_sp	; "A, "
    3426/    102F : 11 3A 2E            	ld	de, RNR
    3427/    1032 : C3 89 11            	jp	cpstr_crlf	; "R",cr,lf
    3428/    1035 :                     	
    3429/    1035 :                     ed_ld_ai:
    3430/    1035 : CD B0 11            	call	a_colon_sp	; "A, "
    3431/    1038 : 11 38 2E            	ld	de, RNI
    3432/    103B : C3 89 11            	jp	cpstr_crlf	; "I",cr,lf
    3433/    103E :                     	
    3434/    103E :                     ; c: 32, 33 : LD R,A ; LD I,A
    3435/    103E :                     ed_ld_ra:
    3436/    103E : 11 3A 2E            	ld	de, RNR
    3437/    1041 :                     ed_ld_ra1:
    3438/    1041 : CD B3 11            	call	mk_rcs		; "R, "
    3439/    1044 : C3 7B 11            	jp	a_crlf		; "A",cr,lf
    3440/    1047 :                     
    3441/    1047 :                     ed_ld_ia:
    3442/    1047 : 11 38 2E            	ld	de, RNI
    3443/    104A : 18 F5               	jr	ed_ld_ra1
    3444/    104C :                     	
    3445/    104C :                     ; c: 27, 28, 29 : IM 2, IM 1, IM 0
    3446/    104C :                     ed_im:
    3447/    104C : 11 32 13            	ld	de, IMstr
    3448/    104F : CD 60 11            	call	mkopcstr
    3449/    1052 :                     
    3450/    1052 : 3E 1D               	ld	a, 29
    3451/    1054 : 91                  	sub	c
    3452/    1055 : C6 30               	add	a, '0'		; '0', '1', '2'
    3453/    1057 : 21 E9 FF            	ld	hl, dasm_OprStr
    3454/    105A : 77                  	ld	(hl), a
    3455/    105B : 23                  	inc	hl
    3456/    105C : C3 8C 11            	jp	insPostStr
    3457/    105F :                     
    3458/    105F :                     ; c: 6 - 26 ed_noopr
    3459/    105F :                     ed_no_opr:
    3460/    105F : D6 06               	sub	6
    3461/    1061 : 4F                  	ld	c, a
    3462/    1062 : 06 00               	ld	b, 0
    3463/    1064 : 21 64 14            	ld	hl, ed_noopr
    3464/    1067 : CD E2 10            	call	get_strBufpoint		; de : string buffer
    3465/    106A : C3 60 11            	jp	mkopcstr
    3466/    106D :                     ;
    3467/    106D :                     ; check ED 4 byte MC
    3468/    106D :                     ;
    3469/    106D :                     ed_4mc:
    3470/    106D : 3E 04               	ld	a, 4
    3471/    106F : 32 43 FF            	ld	(mc_Size), a	; 4byte machine code
    3472/    1072 :                     
    3473/    1072 : C5                  	push	bc
    3474/    1073 : 79                  	ld	a, c
    3475/    1074 : 21 24 14            	ld	hl, ed_rp_str
    3476/    1077 : CD E2 10            	call	get_strBufpoint		; de : string buffer
    3477/    107A : C1                  	pop	bc
    3478/    107B : 79                  	ld	a, c
    3479/    107C : FE 03               	cp	3
    3480/    107E : DA 2F 0F            	jp	c, DD_2a1		; "rr, (nnnnH)",cr,lf
    3481/    1081 :                     					; rr: BC, DE, SP
    3482/    1081 :                     ; "(nnnnH), rr" rr: BC, DE, SP
    3483/    1081 :                     
    3484/    1081 : D5                  	push	de
    3485/    1082 : CD CB 10            	call	get_nnnn
    3486/    1085 : CD F7 10            	call	ins_kn4kcs	; "(nnnnH), "
    3487/    1088 : D1                  	pop	de
    3488/    1089 : C3 89 11            	jp	cpstr_crlf	; "REG",cr,lf
    3489/    108C :                     
    3490/    108C :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3491/    108C :                     	; OPECODE 0FDH check
    3492/    108C :                     	;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    3493/    108C :                     
    3494/    108C :                     chk_0FDH:
    3495/    108C :                     
    3496/    108C : 11 2F 2E            	ld	de, RNIY
    3497/    108F : ED 53 3F FF         	ld	(reg_xy), de	; save index reg string
    3498/    1093 : 11 40 14            	ld	de, addiyrp_tbl
    3499/    1096 : ED 53 41 FF         	ld	(xy_srtp), de
    3500/    109A :                     
    3501/    109A : C3 FC 0D            	jp	chk_0DDH_1
    3502/    109D :                     
    3503/    109D :                     ;-----------------------------------
    3504/    109D :                     ; make "(REG+nn), " at dasm_OprStr
    3505/    109D :                     ;	REG : IX or IY
    3506/    109D :                     ; input de: RNIX, or RNIY
    3507/    109D :                     ;-----------------------------------
    3508/    109D :                     kixypnk_cs:
    3509/    109D : 21 E9 FF            	ld	hl, dasm_OprStr
    3510/    10A0 : CD AC 10            	call	mk_kixypnk
    3511/    10A3 : C3 D8 11            	jp	ins_kmR
    3512/    10A6 :                     
    3513/    10A6 :                     ;-----------------------------------
    3514/    10A6 :                     ; make "(REG+nn)",cr,lf 
    3515/    10A6 :                     ;	REG : IX or IY
    3516/    10A6 :                     ; input de: RNIX, or RNIY
    3517/    10A6 :                     ;       hl: string buffer
    3518/    10A6 :                     ;-----------------------------------
    3519/    10A6 :                     kixypnk_crlf:
    3520/    10A6 : CD AC 10            	call	mk_kixypnk
    3521/    10A9 : C3 8C 11            	jp	insPostStr	; CR, LF, 00h
    3522/    10AC :                     
    3523/    10AC :                     ;-----------------------------------
    3524/    10AC :                     ; make "(IX+nn)", "(IY+nn)" string
    3525/    10AC :                     ; input de: RNIX, or RNIY
    3526/    10AC :                     ;       hl: string buffer
    3527/    10AC :                     ;-----------------------------------
    3528/    10AC :                     mk_kixypnk:
    3529/    10AC : CD C3 11            	call	ins_kakkoL	; "("
    3530/    10AF : CD BB 11            	call	st_copy	; IX
    3531/    10B2 : CD CB 10            	call	get_nnnn
    3532/    10B5 : 7B                  	ld	a, e		;get number
    3533/    10B6 : FE 80               	cp	80h
    3534/    10B8 : 38 0C               	jr	c, numPlus	; number plus
    3535/    10BA : ED 44               	neg			; a = not a + 1
    3536/    10BC : 5F                  	ld	e, a
    3537/    10BD : CD D4 11            	call	ins_misR	; -
    3538/    10C0 :                     sv_nnkr:
    3539/    10C0 : CD 2E 11            	call	hex2str_asm	; nnh
    3540/    10C3 : C3 C7 11            	jp	ins_kakkoR	; ")"
    3541/    10C6 :                     	
    3542/    10C6 :                     numPlus:
    3543/    10C6 : CD D0 11            	call	ins_plsR	; +
    3544/    10C9 : 18 F5               	jr	sv_nnkr
    3545/    10CB :                     
    3546/    10CB :                     ; de : nnnn , or d:yy, e:xx
    3547/    10CB :                     get_nnnn:
    3548/    10CB : E5                  	push	hl
    3549/    10CC : 2A 3D FF            	ld	hl, (dasm_adr)
    3550/    10CF : 23                  	inc	hl		; 2nd opecode address
    3551/    10D0 : 23                  	inc	hl		; operand address
    3552/    10D1 : 5E                  	ld	e, (hl)		; get nn
    3553/    10D2 : 23                  	inc	hl
    3554/    10D3 : 56                  	ld	d, (hl)		; d:yy use for "LD (IX+xx), yy"
    3555/    10D4 :                     				; d:OP use for 4bytes MC like "DD CB xx OP"
    3556/    10D4 :                     				; de : YYXX : ED OP XX YY
    3557/    10D4 : E1                  	pop	hl
    3558/    10D5 : C9                  	ret
    3559/    10D6 :                     
    3560/    10D6 :                     ;-------------------------------------------------
    3561/    10D6 :                     ; hl: massage table
    3562/    10D6 :                     ; bc: found operand point
    3563/    10D6 :                     ;
    3564/    10D6 :                     ; output: copy strings to dasm_OprStr buffer
    3565/    10D6 :                     ;         hl = end point of copied string buffer
    3566/    10D6 :                     ;-------------------------------------------------
    3567/    10D6 :                     mk_str:
    3568/    10D6 : CD E2 10            	call	get_strBufpoint
    3569/    10D9 : 21 E9 FF            	ld	hl, dasm_OprStr
    3570/    10DC : C3 BB 11            	jp	st_copy
    3571/    10DF :                     
    3572/    10DF :                     ;------------------------------------------------
    3573/    10DF :                     ; get register strings address
    3574/    10DF :                     ; input bc: string buffer offset
    3575/    10DF :                     ; output de: register strings address
    3576/    10DF :                     ;------------------------------------------------
    3577/    10DF :                     get_rstg_off:
    3578/    10DF : 21 B6 13            	ld	hl, disRegTbl
    3579/    10E2 :                     
    3580/    10E2 :                     ;-------------------------------------------------
    3581/    10E2 :                     ; input
    3582/    10E2 :                     ;	bc: found operand point
    3583/    10E2 :                     ;	hl: massage table
    3584/    10E2 :                     ; output: 
    3585/    10E2 :                     ;	DE : string point
    3586/    10E2 :                     ;-------------------------------------------------
    3587/    10E2 :                     get_strBufpoint:
    3588/    10E2 : CB 21               	sla	c
    3589/    10E4 : CB 10               	rl	b		; bc *=2
    3590/    10E6 : 09                  	add	hl, bc		; get operand string point
    3591/    10E7 : 5E                  	ld	e, (hl)
    3592/    10E8 : 23                  	inc	hl
    3593/    10E9 : 56                  	ld	d, (hl)
    3594/    10EA : C9                  	ret
    3595/    10EB :                     
    3596/    10EB :                     ;------------------------------------------------
    3597/    10EB :                     ; insert "nnH", CR, LF to buffer
    3598/    10EB :                     ;input e: value
    3599/    10EB :                     ;      hl: string buffer
    3600/    10EB :                     ;------------------------------------------------
    3601/    10EB :                     mk_n2crlf:
    3602/    10EB : CD 2E 11            	call	hex2str_asm
    3603/    10EE : C3 8C 11            	jp	insPostStr
    3604/    10F1 :                     
    3605/    10F1 :                     ;------------------------------------------------
    3606/    10F1 :                     ; insert "nnnnH", CR, LF to buffer
    3607/    10F1 :                     ;input de: value
    3608/    10F1 :                     ;      hl: string buffer
    3609/    10F1 :                     ;------------------------------------------------
    3610/    10F1 :                     mk_n4crlf:
    3611/    10F1 : CD 1D 11            	call	hex4str_asm
    3612/    10F4 : C3 8C 11            	jp	insPostStr
    3613/    10F7 :                     
    3614/    10F7 :                     ;------------------------------------------------
    3615/    10F7 :                     ; insert "(nnnnH), " to buffer dasm_OprStr
    3616/    10F7 :                     ;input de: value
    3617/    10F7 :                     ;
    3618/    10F7 :                     ; make "(nnnnH), " to dasm_OprStr buffer
    3619/    10F7 :                     ; output hl: end point of string buffer
    3620/    10F7 :                     ;------------------------------------------------
    3621/    10F7 :                     ins_kn4kcs:
    3622/    10F7 : 21 E9 FF            	ld	hl, dasm_OprStr	;operand str buffer
    3623/    10FA : CD C3 11            	call	ins_kakkoL	; "("
    3624/    10FD : CD 1D 11            	call	hex4str_asm
    3625/    1100 : CD C7 11            	call	ins_kakkoR	; ")"
    3626/    1103 : C3 D8 11            	jp	ins_kmR		; ", "
    3627/    1106 :                     
    3628/    1106 :                     ;------------------------------------------------
    3629/    1106 :                     ; insert "(nnnnH)" to buffer
    3630/    1106 :                     ;input de: value
    3631/    1106 :                     ;      hl: string buffer
    3632/    1106 :                     ;------------------------------------------------
    3633/    1106 :                     mk_kn4k:
    3634/    1106 : CD C3 11            	call	ins_kakkoL	; "("
    3635/    1109 : CD 1D 11            	call	hex4str_asm
    3636/    110C : C3 C7 11            	jp	ins_kakkoR	; ")"
    3637/    110F :                     
    3638/    110F :                     ;------------------------------------------------
    3639/    110F :                     ; Make address string from branch relative value
    3640/    110F :                     ; input hl: string buffer pointer
    3641/    110F :                     ; output *hl= "nnnnH",cr,lf,0
    3642/    110F :                     ;------------------------------------------------
    3643/    110F :                     mkRel_str:
    3644/    110F : E5                  	push	hl
    3645/    1110 : 2A 3D FF            	ld	hl, (dasm_adr)
    3646/    1113 : CD 6E 06            	call	Rel_adr_c	; return hl : target addr
    3647/    1116 : EB                  	ex	de, hl		; hl: buffer, de: addr value
    3648/    1117 : E1                  	pop	hl
    3649/    1118 : CD 1D 11            	call	hex4str_asm
    3650/    111B : 18 6F               	jr	insPostStr
    3651/    111D :                     	
    3652/    111D :                     ;------------------------------------------------
    3653/    111D :                     ;input de: value, hl: save baffer.
    3654/    111D :                     ;output 4hex chars(asm format)
    3655/    111D :                     ;	(ex). "0FFFFH"
    3656/    111D :                     ;             "1234H"
    3657/    111D :                     ;       hl : hl = hl + 5(or 6); *hl=0
    3658/    111D :                     ;------------------------------------------------
    3659/    111D :                     hex4str_asm:
    3660/    111D : 7A                  	ld	a, d
    3661/    111E : FE A0               	cp	0a0h
    3662/    1120 : 38 04               	jr	c, h4sa_1
    3663/    1122 : 3E 30               	ld	a, '0'
    3664/    1124 : 77                  	ld	(hl), a
    3665/    1125 : 23                  	inc	hl
    3666/    1126 :                     
    3667/    1126 :                     h4sa_1:
    3668/    1126 : CD 3C 11            	call	hex4str
    3669/    1129 :                     h4sa_2:
    3670/    1129 : 3E 48               	ld	a, 'H'
    3671/    112B : C3 C9 11            	jp	ikk_1
    3672/    112E :                     
    3673/    112E :                     ;------------------------------------------------
    3674/    112E :                     ;input e: value, hl: save baffer.
    3675/    112E :                     ;output: 2 hex chars(asm format)
    3676/    112E :                     ;	(ex). "0FFH"
    3677/    112E :                     ;             "12H"
    3678/    112E :                     ;       hl : hl = hl + 3(or 4); *hl=0
    3679/    112E :                     ;------------------------------------------------
    3680/    112E :                     hex2str_asm:
    3681/    112E : 7B                  	ld	a, e
    3682/    112F : FE A0               	cp	0a0h
    3683/    1131 : 38 04               	jr	c, h2sa_1
    3684/    1133 : 3E 30               	ld	a, '0'
    3685/    1135 : 77                  	ld	(hl), a
    3686/    1136 : 23                  	inc	hl
    3687/    1137 :                     
    3688/    1137 :                     h2sa_1:
    3689/    1137 : CD 44 11            	call	hex2str
    3690/    113A : 18 ED               	jr	h4sa_2
    3691/    113C :                     
    3692/    113C :                     ;------------------------------------------------
    3693/    113C :                     ;input de: value, hl: save baffer.
    3694/    113C :                     ;output: 4 hex chras in save buffer
    3695/    113C :                     ;	 hl = hl + 4
    3696/    113C :                     ;------------------------------------------------
    3697/    113C :                     hex4str:
    3698/    113C : 7A                  	ld	a, d
    3699/    113D : CD 4D 11            	call	h2s_n1
    3700/    1140 : 7A                  	ld	a, d
    3701/    1141 : CD 51 11            	call	h2s_n2
    3702/    1144 :                     
    3703/    1144 :                     ;------------------------------------------------
    3704/    1144 :                     ;input e: value, hl: save baffer.
    3705/    1144 :                     ;output: 2 hex chras in save buffer
    3706/    1144 :                     ;	 hl = hl + 2
    3707/    1144 :                     ;------------------------------------------------
    3708/    1144 :                     hex2str:
    3709/    1144 : 7B                  	ld	a, e
    3710/    1145 : CD 4D 11            	call	h2s_n1
    3711/    1148 : 7B                  	ld	a, e
    3712/    1149 : CD 51 11            	call	h2s_n2
    3713/    114C : C9                  	ret
    3714/    114D :                     
    3715/    114D :                     h2s_n1:
    3716/    114D : 0F                  	rrca
    3717/    114E : 0F                  	rrca
    3718/    114F : 0F                  	rrca
    3719/    1150 : 0F                  	rrca
    3720/    1151 :                     h2s_n2:
    3721/    1151 : E6 0F               	and	0fh
    3722/    1153 : F6 30               	or	30h
    3723/    1155 : FE 3A               	cp	3aH
    3724/    1157 : 38 70               	jr	c, ikk_1	; '0' to '9'
    3725/    1159 : C6 07               	add	a, 07h		; 'A' to 'F'
    3726/    115B : 18 6C               	jr	ikk_1
    3727/    115D :                     
    3728/    115D :                     add_opstr:
    3729/    115D : 11 A3 12            	ld	de, ADDstr
    3730/    1160 :                     ;-----------------------------------
    3731/    1160 :                     ; make opecode strings
    3732/    1160 :                     ; input de : opecode strings
    3733/    1160 :                     ;-----------------------------------
    3734/    1160 :                     mkopcstr:
    3735/    1160 : F5                  	push	af
    3736/    1161 : C5                  	push	bc
    3737/    1162 : 06 08               	ld	b, 8	;tab size
    3738/    1164 : 21 E1 FF            	ld	hl, dasm_OpcStr
    3739/    1167 :                     dmkstr0:
    3740/    1167 : 1A                  	ld	a, (de)
    3741/    1168 : B7                  	or	a
    3742/    1169 : 28 06               	jr	z, dmkst1
    3743/    116B : 77                  	ld	(hl), a
    3744/    116C : 23                  	inc	hl
    3745/    116D : 13                  	inc	de
    3746/    116E : 05                  	dec	b
    3747/    116F : 18 F6               	jr	dmkstr0
    3748/    1171 :                     dmkst1:
    3749/    1171 : 3E 20               	ld	a, ' '
    3750/    1173 :                     dmkst2:
    3751/    1173 : 77                  	ld	(hl), a
    3752/    1174 : 23                  	inc	hl
    3753/    1175 : 05                  	dec	b
    3754/    1176 : 20 FB               	jr	nz, dmkst2
    3755/    1178 : C1                  	pop	bc
    3756/    1179 : F1                  	pop	af
    3757/    117A : C9                  	ret
    3758/    117B :                     
    3759/    117B :                     ;
    3760/    117B :                     ; "REG",CR,LF
    3761/    117B :                     ;
    3762/    117B :                     a_crlf:
    3763/    117B : 11 EF 2D            	ld	de, RNA
    3764/    117E : 18 09               	jr	cpstr_crlf	; "A",CR,LF
    3765/    1180 :                     ;bc_crlf:
    3766/    1180 :                     ;	ld	de, RNBC
    3767/    1180 :                     ;	jr	cpstr_crlf
    3768/    1180 :                     ;de_crlf:
    3769/    1180 :                     ;	ld	de, RNDE
    3770/    1180 :                     ;	jr	cpstr_crlf
    3771/    1180 :                     ix_crlf:
    3772/    1180 : ED 5B 3F FF         	ld	de, (reg_xy)
    3773/    1184 : 18 03               	jr	cpstr_crlf
    3774/    1186 :                     ;sp_crlf:
    3775/    1186 :                     ;	ld	de, RNSP
    3776/    1186 :                     ;	jr	cpstr_crlf
    3777/    1186 :                     hl_crlf:
    3778/    1186 : 11 FF 2D            	ld	de, RNHL
    3779/    1189 :                     cpstr_crlf:
    3780/    1189 : CD BB 11            	call	st_copy		; "REG"
    3781/    118C :                     	
    3782/    118C :                     ;-----------------------------------
    3783/    118C :                     ; insert CR, LF, 00H(end delimiter)
    3784/    118C :                     ; input hl : insert buffer
    3785/    118C :                     ;-----------------------------------
    3786/    118C :                     insPostStr:
    3787/    118C : 3E 0D               	ld	a, CR
    3788/    118E : 77                  	ld	(hl), a		; CR code
    3789/    118F : 23                  	inc	hl
    3790/    1190 : 3E 0A               	ld	a, LF
    3791/    1192 : 77                  	ld	(hl), a		; LF code
    3792/    1193 : 23                  	inc	hl
    3793/    1194 : AF                  	xor	a
    3794/    1195 : 77                  	ld	(hl), a		; end delimiter
    3795/    1196 : C9                  	ret
    3796/    1197 :                     
    3797/    1197 :                     mk_krk_1:
    3798/    1197 : 21 E9 FF            	ld	hl, dasm_OprStr
    3799/    119A :                     ;----------------------------
    3800/    119A :                     ; insert "(Reg)" to buffer
    3801/    119A :                     ;
    3802/    119A :                     ; input de: register string
    3803/    119A :                     ;	hl: save buffer
    3804/    119A :                     ;----------------------------
    3805/    119A :                     mk_krk:
    3806/    119A : CD C3 11            	call	ins_kakkoL	; "("
    3807/    119D : CD BB 11            	call	st_copy		; "REG"
    3808/    11A0 : 18 25               	jr	ins_kakkoR	; ")"
    3809/    11A2 :                     
    3810/    11A2 :                     ;----------------------------
    3811/    11A2 :                     ; insert "(Reg), " to dasm_OprStr
    3812/    11A2 :                     ;
    3813/    11A2 :                     ; input de: register string
    3814/    11A2 :                     ;----------------------------
    3815/    11A2 :                     mk_krkcs:
    3816/    11A2 : 21 E9 FF            	ld	hl, dasm_OprStr
    3817/    11A5 : CD C3 11            	call	ins_kakkoL	; "("
    3818/    11A8 : CD BB 11            	call	st_copy		; "REG"
    3819/    11AB : CD C7 11            	call	ins_kakkoR	; ")"
    3820/    11AE : 18 28               	jr	ins_kmR		; ", "
    3821/    11B0 :                     
    3822/    11B0 :                     ;----------------------------
    3823/    11B0 :                     ; insert "A, " to dasm_OprStr
    3824/    11B0 :                     ;----------------------------
    3825/    11B0 :                     a_colon_sp:
    3826/    11B0 : 11 EF 2D            	ld	de, RNA
    3827/    11B3 :                     ;----------------------------
    3828/    11B3 :                     ; insert "Reg, " to dasm_OprStr
    3829/    11B3 :                     ;
    3830/    11B3 :                     ; input de: register string
    3831/    11B3 :                     ;----------------------------
    3832/    11B3 :                     mk_rcs:
    3833/    11B3 : 21 E9 FF            	ld	hl, dasm_OprStr
    3834/    11B6 : CD BB 11            	call	st_copy		; "REG"
    3835/    11B9 : 18 1D               	jr	ins_kmR		; ", "
    3836/    11BB :                     
    3837/    11BB :                     ;-------------------------------------------------
    3838/    11BB :                     ; copy string to output buffer
    3839/    11BB :                     ; input:
    3840/    11BB :                     ;	de : string point
    3841/    11BB :                     ;	hl : output buffer
    3842/    11BB :                     ;-------------------------------------------------
    3843/    11BB :                     st_copy:
    3844/    11BB : 1A                  	ld	a, (de)
    3845/    11BC : 77                  	ld	(hl), a
    3846/    11BD : B7                  	or	a
    3847/    11BE : C8                  	ret	z	; return after coping delimiter
    3848/    11BF :                     			; hl : delimiter position
    3849/    11BF : 23                  	inc	hl
    3850/    11C0 : 13                  	inc	de
    3851/    11C1 : 18 F8               	jr	st_copy
    3852/    11C3 :                     
    3853/    11C3 :                     ;--------------
    3854/    11C3 :                     ; insert "("
    3855/    11C3 :                     ;--------------
    3856/    11C3 :                     ins_kakkoL:
    3857/    11C3 : 3E 28               	ld	a, '('
    3858/    11C5 : 18 02               	jr	ikk_1
    3859/    11C7 :                     	
    3860/    11C7 :                     ;--------------
    3861/    11C7 :                     ; insert ")"
    3862/    11C7 :                     ;--------------
    3863/    11C7 :                     ins_kakkoR:
    3864/    11C7 : 3E 29               	ld	a, ')'
    3865/    11C9 :                     ikk_1:
    3866/    11C9 : 77                  	ld	(hl), a
    3867/    11CA : 23                  	inc	hl
    3868/    11CB : C9                  	ret
    3869/    11CC :                     
    3870/    11CC :                     ;--------------
    3871/    11CC :                     ; insert " "
    3872/    11CC :                     ;--------------
    3873/    11CC :                     ins_spcR:
    3874/    11CC : 3E 20               	ld	a, ' '
    3875/    11CE : 18 F9               	jr	ikk_1
    3876/    11D0 :                     
    3877/    11D0 :                     ;--------------
    3878/    11D0 :                     ; insert "+"
    3879/    11D0 :                     ;--------------
    3880/    11D0 :                     ins_plsR:
    3881/    11D0 : 3E 2B               	ld	a, '+'
    3882/    11D2 : 18 F5               	jr	ikk_1
    3883/    11D4 :                     
    3884/    11D4 :                     ;--------------
    3885/    11D4 :                     ; insert "-"
    3886/    11D4 :                     ;--------------
    3887/    11D4 :                     ins_misR:
    3888/    11D4 : 3E 2D               	ld	a, '-'
    3889/    11D6 : 18 F1               	jr	ikk_1
    3890/    11D8 :                     
    3891/    11D8 :                     ;--------------
    3892/    11D8 :                     ; insert ", "
    3893/    11D8 :                     ;--------------
    3894/    11D8 :                     ins_kmR:
    3895/    11D8 : 3E 2C               	ld	a, ','
    3896/    11DA : CD C9 11            	call	ikk_1
    3897/    11DD : 18 ED               	jr	ins_spcR
    3898/    11DF :                     
    3899/    11DF :                     ;------------------------------------------
    3900/    11DF :                     ; Dis assemble tables
    3901/    11DF :                     ;------------------------------------------
    3902/    11DF :                     oth_1op_s:
    3903/    11DF : 00                  	DB	00H	; NOP
    3904/    11E0 : 07                  	DB	07H	; RLCA
    3905/    11E1 : 0F                  	DB	0FH	; RRCA
    3906/    11E2 : 17                  	DB	17H	; RLA
    3907/    11E3 : 1F                  	DB	1FH	; RRA
    3908/    11E4 : 27                  	DB	27H	; DAA
    3909/    11E5 : 2F                  	DB	2FH	; CPL
    3910/    11E6 : 37                  	DB	37H	; SCF
    3911/    11E7 : 3F                  	DB	3FH	; CCF
    3912/    11E8 : C9                  	DB	0C9H	; RET
    3913/    11E9 : D9                  	DB	0D9H	; EXX
    3914/    11EA : F3                  	DB	0F3H	; DI
    3915/    11EB : FB                  	DB	0FBH	; EI
    3916/    11EC :                     oth_1op_e:
    3917/    11EC :                     
    3918/    11EC :                     INC_OPCDTBLS:
    3919/    11EC : 04                  	DB	04H	; INC	B
    3920/    11ED : 0C                  	DB	0CH	; INC	C
    3921/    11EE : 14                  	DB	14H	; INC	D
    3922/    11EF : 1C                  	DB	1CH	; INC	E
    3923/    11F0 : 24                  	DB	24H	; INC	H
    3924/    11F1 : 2C                  	DB	2CH	; INC	L
    3925/    11F2 : 34                  	DB	34H	; INC	(HL)
    3926/    11F3 : 3C                  	DB	3CH	; INC	A
    3927/    11F4 :                     INC_OPCDTBLE:
    3928/    11F4 :                     
    3929/    11F4 :                     DEC_OPCDTBLS:
    3930/    11F4 : 05                  	DB	05H	; DEC	B
    3931/    11F5 : 0D                  	DB	0DH	; DEC	C
    3932/    11F6 : 15                  	DB	15H	; DEC	D
    3933/    11F7 : 1D                  	DB	1DH	; DEC	E
    3934/    11F8 : 25                  	DB	25H	; DEC	H
    3935/    11F9 : 2D                  	DB	2DH	; DEC	L
    3936/    11FA : 35                  	DB	35H	; DEC	(HL)
    3937/    11FB : 3D                  	DB	3DH	; DEC	A
    3938/    11FC :                     DEC_OPCDTBLE:
    3939/    11FC :                     
    3940/    11FC :                     inc_rp_s:
    3941/    11FC : 03                  	DB	03H	; INC	BC
    3942/    11FD : 13                  	DB	13H	; INC	DE
    3943/    11FE : 23                  	DB	23H	; INC	HL
    3944/    11FF : 33                  	DB	33H	; INC	SP
    3945/    1200 :                     inc_rp_e:
    3946/    1200 :                     
    3947/    1200 :                     dec_rp_s:
    3948/    1200 : 0B                  	DB	0BH	; DEC	BC
    3949/    1201 : 1B                  	DB	1BH	; DEC	DE
    3950/    1202 : 2B                  	DB	2BH	; DEC	HL
    3951/    1203 : 3B                  	DB	3BH	; DEC	SP
    3952/    1204 :                     dec_rp_e:
    3953/    1204 :                     
    3954/    1204 :                     add_rp_s:
    3955/    1204 : 09                  	DB	09H	; ADD	HL,BC
    3956/    1205 : 19                  	DB	19H	; ADD	HL,DE
    3957/    1206 : 29                  	DB	29H	; ADD	HL,HL
    3958/    1207 : 39                  	DB	39H	; ADD	HL,SP
    3959/    1208 :                     add_rp_e:
    3960/    1208 :                     
    3961/    1208 :                     pop_rp_s:
    3962/    1208 : C1                  	DB	0C1H	; POP	BC
    3963/    1209 : D1                  	DB	0D1H	; POP	DE
    3964/    120A : E1                  	DB	0E1H	; POP	HL
    3965/    120B : F1                  	DB	0F1H	; POP	AF
    3966/    120C :                     pop_rp_e:
    3967/    120C :                     
    3968/    120C :                     push_rp_s:
    3969/    120C : C5                  	DB	0C5H	; PUSH	BC
    3970/    120D : D5                  	DB	0D5H	; PUSH	DE
    3971/    120E : E5                  	DB	0E5H	; PUSH	HL
    3972/    120F : F5                  	DB	0F5H	; PUSH	AF
    3973/    1210 :                     push_rp_e:
    3974/    1210 :                     
    3975/    1210 :                     dd_ld_tbl:
    3976/    1210 : 46                  	DB	46h	; nn: LD B,(IX+nn)
    3977/    1211 : 4E                  	DB	4Eh	; nn: LD C,(IX+nn)
    3978/    1212 : 56                  	DB	56h	; nn: LD D,(IX+nn)
    3979/    1213 : 5E                  	DB	5Eh	; nn: LD E,(IX+nn)
    3980/    1214 : 66                  	DB	66h	; nn: LD H,(IX+nn)
    3981/    1215 : 6E                  	DB	6Eh	; nn: LD L,(IX+nn)
    3982/    1216 : 7E                  	DB	7Eh	; nn: LD A,(IX+nn)
    3983/    1217 :                     
    3984/    1217 : 70                  	DB	70h	; nn: LD (IX+nn),B
    3985/    1218 : 71                  	DB	71h	; nn: LD (IX+nn),C
    3986/    1219 : 72                  	DB	72h	; nn: LD (IX+nn),D
    3987/    121A : 73                  	DB	73h	; nn: LD (IX+nn),E
    3988/    121B : 74                  	DB	74h	; nn: LD (IX+nn),H
    3989/    121C : 75                  	DB	75h	; nn: LD (IX+nn),L
    3990/    121D : 77                  	DB	77h	; nn: LD (IX+nn),A
    3991/    121E :                     dd_ld_tble:
    3992/    121E :                     
    3993/    121E :                     dd_log_tbl:
    3994/    121E : 96                  	DB	96h	; nn: SUB (IX+nn)
    3995/    121F : A6                  	DB	0A6h	; nn: AND (IX+nn)
    3996/    1220 : AE                  	DB	0AEh	; nn: XOR (IX+nn)
    3997/    1221 : B6                  	DB	0B6h	; nn: OR  (IX+nn)
    3998/    1222 : BE                  	DB	0BEh	; nn: CP  (IX+nn)
    3999/    1223 : 34                  	DB	34h	; nn: INC (IX+nn)
    4000/    1224 : 35                  	DB	35h	; nn: DEC (IX+nn)
    4001/    1225 :                     dd_log_tble:
    4002/    1225 :                     
    4003/    1225 :                     dd_rt_tbles:
    4004/    1225 : 06                  	DB	06h	; RLC (IX+nn)
    4005/    1226 : 0E                  	DB	0Eh	; RRC (IX+nn)
    4006/    1227 : 16                  	DB	16h	; RL  (IX+nn)
    4007/    1228 : 1E                  	DB	1Eh	; RR  (IX+nn)
    4008/    1229 : 26                  	DB	26h	; SLA (IX+nn)
    4009/    122A : 2E                  	DB	2Eh	; SRA (IX+nn)
    4010/    122B : 3E                  	DB	3Eh	; SRL (IX+nn)
    4011/    122C :                     dd_rt_tble:
    4012/    122C :                     
    4013/    122C :                     ; use checking undefine MC ( DD CB nn XX )
    4014/    122C :                     dd_bit_opTbl:
    4015/    122C : 46                  	DB	46h	; BIT 0,(IX+12H)
    4016/    122D : 4E                  	DB	4Eh	; BIT 1,(IX+12H)
    4017/    122E : 56                  	DB	56h	; BIT 2,(IX+12H)
    4018/    122F : 5E                  	DB	5Eh	; BIT 3,(IX+12H)
    4019/    1230 : 66                  	DB	66h	; BIT 4,(IX+12H)
    4020/    1231 : 6E                  	DB	6Eh	; BIT 5,(IX+12H)
    4021/    1232 : 76                  	DB	76h	; BIT 6,(IX+12H)
    4022/    1233 : 7E                  	DB	7Eh	; BIT 7,(IX+12H)
    4023/    1234 : 86                  	DB	86h	; RES 0,(IX+12H)
    4024/    1235 : 8E                  	DB	8Eh	; RES 1,(IX+12H)
    4025/    1236 : 96                  	DB	96h	; RES 2,(IX+12H)
    4026/    1237 : 9E                  	DB	9Eh	; RES 3,(IX+12H)
    4027/    1238 : A6                  	DB	0A6h	; RES 4,(IX+12H)
    4028/    1239 : AE                  	DB	0AEh	; RES 5,(IX+12H)
    4029/    123A : B6                  	DB	0B6h	; RES 6,(IX+12H)
    4030/    123B : BE                  	DB	0BEh	; RES 7,(IX+12H)
    4031/    123C : C6                  	DB	0C6h	; SET 0,(IX+12H)
    4032/    123D : CE                  	DB	0CEh	; SET 1,(IX+12H)
    4033/    123E : D6                  	DB	0D6h	; SET 2,(IX+12H)
    4034/    123F : DE                  	DB	0DEh	; SET 3,(IX+12H)
    4035/    1240 : E6                  	DB	0E6h	; SET 4,(IX+12H)
    4036/    1241 : EE                  	DB	0EEh	; SET 5,(IX+12H)
    4037/    1242 : F6                  	DB	0F6h	; SET 6,(IX+12H)
    4038/    1243 : FE                  	DB	0FEh	; SET 7,(IX+12H)
    4039/    1244 :                     dd_bit_opTble:
    4040/    1244 :                     
    4041/    1244 :                     ; use checking undefine MC ( ED XX ....)
    4042/    1244 :                     ed_op_tbl:
    4043/    1244 : 40                  	DB	40h	; 55:IN  B,(C)
    4044/    1245 : 48                   	DB	48h	; 54:IN  C,(C)
    4045/    1246 : 50                  	DB	50h	; 53:IN  D,(C)
    4046/    1247 : 58                  	DB	58h	; 52:IN  E,(C)
    4047/    1248 : 60                  	DB	60h	; 51:IN  H,(C)
    4048/    1249 : 68                  	DB	68h	; 50:IN  L,(C)
    4049/    124A : 78                  	DB	78h	; 49:IN  A,(C)
    4050/    124B :                     
    4051/    124B : 41                  	DB	41h	; 48:OUT (C),B
    4052/    124C : 49                  	DB	49h	; 47:OUT (C),C
    4053/    124D : 51                  	DB	51h	; 46:OUT (C),D
    4054/    124E : 59                  	DB	59h	; 45:OUT (C),E
    4055/    124F : 61                  	DB	61h	; 44:OUT (C),H
    4056/    1250 : 69                  	DB	69h	; 43:OUT (C),L
    4057/    1251 : 79                  	DB	79h	; 42:OUT (C),A
    4058/    1252 :                     
    4059/    1252 : 42                  	DB	42h	; 41:SBC HL,BC
    4060/    1253 : 52                  	DB	52h	; 40:SBC HL,DE
    4061/    1254 : 62                  	DB	62h	; 39:SBC HL,HL
    4062/    1255 : 72                  	DB	72h	; 38:SBC HL,SP
    4063/    1256 :                     
    4064/    1256 : 4A                  	DB	4Ah	; 37:ADC HL,BC
    4065/    1257 : 5A                  	DB	5Ah	; 36:ADC HL,DE
    4066/    1258 : 6A                  	DB	6Ah	; 35:ADC HL,HL
    4067/    1259 : 7A                  	DB	7Ah	; 34:ADC HL,SP
    4068/    125A :                     
    4069/    125A : 47                  	DB	47h	; 33:LD I,A
    4070/    125B : 4F                  	DB	4Fh	; 32:LD R,A
    4071/    125C : 57                  	DB	57h	; 31:LD A,I
    4072/    125D : 5F                  	DB	5Fh	; 30:LD A,R
    4073/    125E :                     
    4074/    125E : 46                  	DB	46h	; 29:IM  0
    4075/    125F : 56                  	DB	56h	; 28:IM  1
    4076/    1260 : 5E                  	DB	5Eh	; 27:IM  2
    4077/    1261 :                     
    4078/    1261 : 44                  	DB	44h	; 26:NEG
    4079/    1262 : 45                  	DB	45h	; 25:RETN
    4080/    1263 : 4D                  	DB	4Dh	; 24:RETI
    4081/    1264 : 67                  	DB	67h	; 23:RRD
    4082/    1265 : 6F                  	DB	6Fh	; 22:RLD
    4083/    1266 : A0                  	DB	0A0h	; 21:LDI
    4084/    1267 : A1                  	DB	0A1h	; 20:CPI
    4085/    1268 : A2                  	DB	0A2h	; 19:INI
    4086/    1269 : A3                  	DB	0A3h	; 18:OUTI
    4087/    126A : A8                  	DB	0A8h	; 17:LDD
    4088/    126B : A9                  	DB	0A9h	; 16:CPD
    4089/    126C : AA                  	DB	0AAh	; 15:IND
    4090/    126D : AB                  	DB	0ABh	; 14:OUTD
    4091/    126E : B0                  	DB	0B0h	; 13:LDIR
    4092/    126F : B1                  	DB	0B1h	; 12:CPIR
    4093/    1270 : B2                  	DB	0B2h	; 11:INIR
    4094/    1271 : B3                  	DB	0B3h	; 10:OTIR
    4095/    1272 : B8                  	DB	0B8h	; 09:LDDR
    4096/    1273 : B9                  	DB	0B9h	; 08:CPDR
    4097/    1274 : BA                  	DB	0BAh	; 07:INDR
    4098/    1275 : BB                  	DB	0BBh	; 06:OTDR
    4099/    1276 :                     
    4100/    1276 : 43                  	DB	43h	; 05:LD (nnnn),BC
    4101/    1277 : 53                  	DB	53h	; 04:LD (nnnn),DE
    4102/    1278 : 73                  	DB	73h	; 03:LD (nnnn),SP
    4103/    1279 :                     
    4104/    1279 : 4B                  	DB	4Bh	; 02:LD BC,(nnnn)
    4105/    127A : 5B                  	DB	5Bh	; 01:LD DE,(nnnn)
    4106/    127B : 7B                  	DB	7Bh	; 00:LD SP,(nnnn)
    4107/    127C :                     ed_op_tble:
    4108/    127C :                     
    4109/    127C : 41 46 00            RNAF:		DB	"AF",00H
    4110/    127F : 41 46 27 00         RNAFX:		DB	"AF'",00H
    4111/    1283 :                     
    4112/    1283 : 52 45 54 00         RETstr:		db	"RET", 00h
    4113/    1287 : 4A 50 00            JPstr:		db	"JP", 00h
    4114/    128A : 4A 52 00            JRstr:		db	"JR", 00h
    4115/    128D : 44 4A 4E 5A 00      DJNZstr:	db	"DJNZ", 00h
    4116/    1292 : 43 41 4C 4C 00      CALLstr:	db	"CALL", 00h
    4117/    1297 : 52 53 54 00         RSTstr:		db	"RST", 00h
    4118/    129B : 4C 44 00            LDstr:		db	"LD", 00h
    4119/    129E : 48 41 4C 54 00      HLTstr:		db	"HALT", 00h
    4120/    12A3 : 41 44 44 00         ADDstr:		db	"ADD", 00h
    4121/    12A7 : 41 44 43 00         ADCstr:		db	"ADC", 00h
    4122/    12AB : 53 55 42 00         SUBstr:		db	"SUB", 00h
    4123/    12AF : 53 42 43 00         SBCstr:		db	"SBC", 00h
    4124/    12B3 : 41 4E 44 00         ANDstr:		db	"AND", 00h
    4125/    12B7 : 58 4F 52 00         XORstr:		db	"XOR", 00h
    4126/    12BB : 4F 52 00            ORstr:		db	"OR", 00h
    4127/    12BE : 43 50 00            CPstr:		db	"CP", 00h
    4128/    12C1 : 49 4E 43 00         INCstr:		db	"INC", 00h
    4129/    12C5 : 44 45 43 00         DECstr:		db	"DEC", 00h
    4130/    12C9 : 50 4F 50 00         POPstr:		db	"POP", 00h
    4131/    12CD : 50 55 53 48 00      PUSHstr:	db	"PUSH",00h
    4132/    12D2 : 45 58 00            EXstr:		db	"EX", 00h
    4133/    12D5 :                     
    4134/    12D5 : 45 58 58 00         EXXstr:		db	"EXX", 00h
    4135/    12D9 : 4E 4F 50 00         NOPstr:		db	"NOP", 00h
    4136/    12DD : 52 4C 43 41 00      RLCAstr:	db	"RLCA", 00h
    4137/    12E2 : 52 52 43 41 00      RRCAstr:	db	"RRCA", 00h
    4138/    12E7 : 52 4C 41 00         RLAstr:		db	"RLA", 00h
    4139/    12EB : 52 52 41 00         RRAstr:		db	"RRA", 00h
    4140/    12EF : 44 41 41 00         DAAstr:		db	"DAA", 00h
    4141/    12F3 : 43 50 4C 00         CPLstr:		db	"CPL", 00h
    4142/    12F7 : 53 43 46 00         SCFstr:		db	"SCF", 00h
    4143/    12FB : 43 43 46 00         CCFstr:		db	"CCF", 00h
    4144/    12FF : 44 49 00            DIstr:		db	"DI", 00h
    4145/    1302 : 45 49 00            EIstr:		db	"EI", 00h
    4146/    1305 :                     
    4147/    1305 : 4F 55 54 00         OUTstr:		db	"OUT", 00h
    4148/    1309 : 49 4E 00            INstr:		db	"IN", 00h
    4149/    130C :                     
    4150/    130C : 52 4C 43 00         RLCstr		db	"RLC", 00h
    4151/    1310 : 52 52 43 00         RRCstr		db	"RRC", 00h
    4152/    1314 : 52 4C 00            RLstr		db	"RL", 00h
    4153/    1317 : 52 52 00            RRstr		db	"RR", 00h
    4154/    131A : 53 4C 41 00         SLAstr		db	"SLA", 00h
    4155/    131E : 53 52 41 00         SRAstr		db	"SRA", 00h
    4156/    1322 : 53 52 4C 00         SRLstr		db	"SRL", 00h
    4157/    1326 : 42 49 54 00         BITstr		db	"BIT", 00h
    4158/    132A : 52 45 53 00         RESstr		db	"RES", 00h
    4159/    132E : 4E 45 47 00         NEGstr		db	"NEG", 00h
    4160/    1332 : 49 4D 00            IMstr		db	"IM", 00h
    4161/    1335 : 52 52 44 00         RRDstr		db	"RRD", 00h
    4162/    1339 : 52 4C 44 00         RLDstr		db	"RLD", 00h
    4163/    133D : 4C 44 49 00         LDIstr		db	"LDI", 00h
    4164/    1341 : 43 50 49 00         CPIstr		db	"CPI", 00h
    4165/    1345 : 49 4E 49 00         INIstr		db	"INI", 00h
    4166/    1349 : 4F 55 54 49 00      OUTIstr		db	"OUTI", 00h
    4167/    134E : 4C 44 44 00         LDDstr		db	"LDD", 00h
    4168/    1352 : 43 50 44 00         CPDstr		db	"CPD", 00h
    4169/    1356 : 49 4E 44 00         INDstr		db	"IND", 00h
    4170/    135A : 4F 55 54 44 00      OUTDstr		db	"OUTD", 00h
    4171/    135F : 4C 44 49 52 00      LDIRstr		db	"LDIR", 00h
    4172/    1364 : 43 50 49 52 00      CPIRstr		db	"CPIR", 00h
    4173/    1369 : 49 4E 49 52 00      INIRstr		db	"INIR", 00h
    4174/    136E : 4F 54 49 52 00      OTIRstr		db	"OTIR", 00h
    4175/    1373 : 4C 44 44 52 00      LDDRstr		db	"LDDR", 00h
    4176/    1378 : 43 50 44 52 00      CPDRstr		db	"CPDR", 00h
    4177/    137D : 49 4E 44 52 00      INDRstr		db	"INDR", 00h
    4178/    1382 : 4F 54 44 52 00      OTDRstr		db	"OTDR", 00h
    4179/    1387 : 52 45 54 49 00      RETIstr		db	"RETI", 00h
    4180/    138C : 52 45 54 4E 00      RETNstr		db	"RETN", 00h
    4181/    1391 :                     ;BITstr		db	"BIT", 00h
    4182/    1391 :                     ;RESstr		db	"RES", 00h
    4183/    1391 : 53 45 54 00         SETstr		db	"SET", 00h
    4184/    1395 :                     com_errm:
    4185/    1395 : 3F 3F 3F 00         ER_OPMSG:	db	"???", 00h
    4186/    1399 : 28 43 29 00         KCKstr		db	"(C)", 00h
    4187/    139D :                     
    4188/    139D : 28 48 4C 29 00      kRNHL:	db	"(HL)", 00h
    4189/    13A2 : 4E 5A 00            cc0:	db	"NZ", 00h
    4190/    13A5 : 5A 00               cc1:	db	"Z", 00h
    4191/    13A7 : 4E 43 00            cc2:	db	"NC", 00h
    4192/    13AA : 43 00               cc3:	db	"C", 00h
    4193/    13AC : 50 4F 00            cc4:	db	"PO", 00h
    4194/    13AF : 50 45 00            cc5:	db	"PE", 00h
    4195/    13B2 : 50 00               cc6:	db	"P", 00h
    4196/    13B4 : 4D 00               cc7:	db	"M", 00h
    4197/    13B6 :                     
    4198/    13B6 : F4 2D F6 2D FB 2D   disRegTbl:	dw	RNB, RNC, RND, RNE, RNH, RNL, kRNHL, RNA
             13BC : FD 2D 02 2E 04 2E 
             13C2 : 9D 13 EF 2D       
    4199/    13C6 : B4 13 B2 13 AF 13   CC_opr:		dw	cc7, cc6, cc5, cc4, cc3, cc2, cc1, cc0
             13CC : AC 13 AA 13 A7 13 
             13D2 : A5 13 A2 13       
    4200/    13D6 : AA 13 A7 13 A5 13   JRCC_opr1:	dw	cc3, cc2, cc1, cc0
             13DC : A2 13             
    4201/    13DE : 32 2E FF 2D F8 2D   INC_DEC_ADDrp:	dw	RNSP, RNHL, RNDE, RNBC
             13E4 : F1 2D             
    4202/    13E6 : 7C 12 FF 2D F8 2D   POP_PUSHrp:	dw	RNAF, RNHL, RNDE, RNBC
             13EC : F1 2D             
    4203/    13EE :                     
    4204/    13EE : 02 13 FF 12 D5 12   oth_1op_tbl:	dw	EIstr, DIstr, EXXstr, RETstr, CCFstr
             13F4 : 83 12 FB 12       
    4205/    13F8 : F7 12 F3 12 EF 12   		dw	SCFstr, CPLstr, DAAstr, RRAstr
             13FE : EB 12             
    4206/    1400 : E7 12 E2 12 DD 12   		dw	RLAstr, RRCAstr, RLCAstr, NOPstr
             1406 : D9 12             
    4207/    1408 :                     
    4208/    1408 : 05 13 09 13 BE 12   logop2str:	dw	OUTstr, INstr, CPstr, ORstr, XORstr
             140E : BB 12 B7 12       
    4209/    1412 : B3 12 AB 12 AF 12   		dw	ANDstr, SUBstr, SBCstr, ADCstr, ADDstr
             1418 : A7 12 A3 12       
    4210/    141C :                     
    4211/    141C : 32 2E FF 2D F8 2D   logop3str	dw	RNSP, RNHL, RNDE, RNBC
             1422 : F1 2D             
    4212/    1424 : 32 2E F8 2D F1 2D   ed_rp_str	dw	RNSP, RNDE, RNBC, RNSP, RNDE, RNBC
             142A : 32 2E F8 2D F1 2D 
    4213/    1430 :                     
    4214/    1430 : C9 12 CD 12 C5 12   dd_2opt:	dw	POPstr, PUSHstr, DECstr, INCstr
             1436 : C1 12             
    4215/    1438 : 32 2E 2C 2E F8 2D   addixrp_tbl:	dw	RNSP, RNIX, RNDE, RNBC
             143E : F1 2D             
    4216/    1440 : 32 2E 2F 2E F8 2D   addiyrp_tbl:	dw	RNSP, RNIY, RNDE, RNBC
             1446 : F1 2D             
    4217/    1448 :                     
    4218/    1448 : C5 12 C1 12 BE 12   ddlogtbl:	dw	DECstr, INCstr, CPstr, ORstr, XORstr, ANDstr, SUBstr
             144E : BB 12 B7 12 B3 12 
             1454 : AB 12             
    4219/    1456 : EF 2D 04 2E 02 2E   dd_ldtbl:	dw	RNA, RNL, RNH, RNE, RND, RNC, RNB
             145C : FD 2D FB 2D F6 2D 
             1462 : F4 2D             
    4220/    1464 :                     
    4221/    1464 : 82 13 7D 13 78 13   ed_noopr:	dw	OTDRstr, INDRstr, CPDRstr, LDDRstr
             146A : 73 13             
    4222/    146C : 6E 13 69 13 64 13   		dw	OTIRstr, INIRstr, CPIRstr, LDIRstr
             1472 : 5F 13             
    4223/    1474 : 5A 13 56 13 52 13   		dw	OUTDstr, INDstr, CPDstr, LDDstr
             147A : 4E 13             
    4224/    147C : 49 13 45 13 41 13   		dw	OUTIstr, INIstr, CPIstr, LDIstr
             1482 : 3D 13             
    4225/    1484 : 39 13 35 13 87 13   		dw	RLDstr, RRDstr, RETIstr, RETNstr
             148A : 8C 13             
    4226/    148C : 2E 13               		dw	NEGstr
    4227/    148E :                     
    4228/    148E : 22 13 1E 13 1A 13   dd_rt_str:	dw	SRLstr, SRAstr, SLAstr, RRstr
             1494 : 17 13             
    4229/    1496 : 14 13 10 13 0C 13   		dw	RLstr, RRCstr, RLCstr
    4230/    149C :                     	
    4231/    149C :                     ;;;
    4232/    149C :                     ;;; GO address
    4233/    149C :                     ;;; 
    4234/    149C :                     
    4235/    149C :                     GO:
    4236/    149C : ED 5B F2 FE         	ld	de, (REGPC)
    4237/    14A0 : ED 53 12 FF         	ld	(goTmp), de	; save go tmp go address
    4238/    14A4 : 23                  	INC	HL
    4239/    14A5 : CD 05 27            	CALL	SKIPSP
    4240/    14A8 : CD 15 27            	CALL	RDHEX
    4241/    14AB : 30 03               	jr	nc, gostmp
    4242/    14AD : B7                  	OR	A
    4243/    14AE : 28 04               	JR	Z, g_stpadr
    4244/    14B0 :                     gostmp:
    4245/    14B0 :                     ;	ld	a, d
    4246/    14B0 :                     ;	cp	(RAM_E + 1) >> 8	; a - 0C0H
    4247/    14B0 :                     ;	jp	nc, ERR		; detect I/O area
    4248/    14B0 : ED 53 12 FF         	LD	(goTmp),DE	; save going address
    4249/    14B4 :                     g_stpadr:
    4250/    14B4 : CD 05 27            	CALL	SKIPSP
    4251/    14B7 : 7E                  	LD	A,(HL)
    4252/    14B8 : B7                  	or	a
    4253/    14B9 : 28 18               	jr	z, GO1
    4254/    14BB : FE 2C               	cp	','
    4255/    14BD : C2 17 02            	jp	nz, ERR
    4256/    14C0 :                     
    4257/    14C0 :                     ; set break point with go command
    4258/    14C0 :                     
    4259/    14C0 : 23                  	INC	HL
    4260/    14C1 : CD 05 27            	CALL	SKIPSP
    4261/    14C4 : CD 15 27            	CALL	RDHEX		; 1st arg.
    4262/    14C7 : DA 17 02            	jp	c, ERR
    4263/    14CA :                     
    4264/    14CA : 21 06 FF            	ld	hl, tmpb_f	; hl: temp break point buffer
    4265/    14CD : CD B9 03            	call	setbpadr
    4266/    14D0 : DA 17 02            	jp	c, ERR		; address is incorrect
    4267/    14D3 :                     
    4268/    14D3 :                     GO1:
    4269/    14D3 : 2A 12 FF            	LD	hl, (goTmp)
    4270/    14D6 : 22 F2 FE            	ld	(REGPC), hl	; set go address
    4271/    14D9 :                     
    4272/    14D9 :                     G0:
    4273/    14D9 :                     ; check Trace mode
    4274/    14D9 :                     
    4275/    14D9 : 3A F6 FE            	ld	a, (tpt1_f)
    4276/    14DC : B7                  	or	a
    4277/    14DD : 28 1A               	jr	z, donot_trace
    4278/    14DF :                     	
    4279/    14DF : 2A 18 FF            	ld	hl,(tmpT)
    4280/    14E2 : 22 F2 FE            	ld	(REGPC), hl	; set trace address
    4281/    14E5 :                     
    4282/    14E5 : 21 F6 FE            	ld	hl, tpt1_f
    4283/    14E8 : 11 F8 FE            	ld	de, tpt1_adr
    4284/    14EB : CD 51 15            	call	set_bp
    4285/    14EE : 21 FA FE            	ld	hl, tpt2_f
    4286/    14F1 : 11 FC FE            	ld	de, tpt2_adr
    4287/    14F4 : CD 51 15            	call	set_bp
    4288/    14F7 : 18 1B               	jr	skp_tbp		; skip set tmp bp and bp, if tracing
    4289/    14F9 :                     
    4290/    14F9 :                     ; set break point
    4291/    14F9 :                     donot_trace:
    4292/    14F9 : 21 FE FE            	ld	hl, bpt1_f
    4293/    14FC : 11 00 FF            	ld	de, bpt1_adr
    4294/    14FF : CD 51 15            	call	set_bp
    4295/    1502 : 21 02 FF            	ld	hl, bpt2_f
    4296/    1505 : 11 04 FF            	ld	de, bpt2_adr
    4297/    1508 : CD 51 15            	call	set_bp
    4298/    150B :                     
    4299/    150B :                     
    4300/    150B :                     ; check go, break pointer
    4301/    150B :                     
    4302/    150B : 21 06 FF            	ld	hl, tmpb_f
    4303/    150E : 11 08 FF            	ld	de, tmpb_adr
    4304/    1511 : CD 51 15            	call	set_bp
    4305/    1514 :                     
    4306/    1514 :                     	;; R register adjustment
    4307/    1514 :                     
    4308/    1514 :                     skp_tbp:
    4309/    1514 : 2A F0 FE            	LD	HL,(REGSP)
    4310/    1517 : F9                  	LD	SP,HL
    4311/    1518 : 2A F2 FE            	LD	HL,(REGPC)
    4312/    151B : E5                  	PUSH	HL
    4313/    151C : DD 2A EC FE         	LD	IX,(REGIX)
    4314/    1520 : FD 2A EE FE         	LD	IY,(REGIY)
    4315/    1524 : 2A E4 FE            	LD	HL,(REGAFX)
    4316/    1527 : E5                  	PUSH	HL
    4317/    1528 : ED 4B E6 FE         	LD	BC,(REGBCX)
    4318/    152C : ED 5B E8 FE         	LD	DE,(REGDEX)
    4319/    1530 : 2A EA FE            	LD	HL,(REGHLX)
    4320/    1533 : D9                  	EXX
    4321/    1534 : F1                  	POP	AF
    4322/    1535 : 08                  	EX	AF,AF'		;'
    4323/    1536 : 2A DC FE            	LD	HL,(REGAF)
    4324/    1539 : E5                  	PUSH	HL
    4325/    153A : ED 4B DE FE         	LD	BC,(REGBC)
    4326/    153E : ED 5B E0 FE         	LD	DE,(REGDE)
    4327/    1542 : 2A E2 FE            	LD	HL,(REGHL)
    4328/    1545 : 3A F4 FE            	LD	A,(REGI)
    4329/    1548 : ED 47               	LD	I,A
    4330/    154A : 3A F5 FE            	LD	A,(REGR)
    4331/    154D : ED 4F               	LD	R,A
    4332/    154F : F1                  	POP	AF
    4333/    1550 : C9                  	RET			; POP PC
    4334/    1551 :                     
    4335/    1551 :                     set_bp:
    4336/    1551 : 7E                  	ld	a, (hl)
    4337/    1552 : B7                  	or	a
    4338/    1553 : C8                  	ret	z
    4339/    1554 :                     
    4340/    1554 : 1A                  	ld	a, (de)
    4341/    1555 : 4F                  	ld	c, a
    4342/    1556 : 13                  	inc	de
    4343/    1557 : 1A                  	ld	a, (de)
    4344/    1558 : 47                  	ld	b, a	; bc = break point address
    4345/    1559 :                     
    4346/    1559 : 3E FF               	ld	a, 0FFH
    4347/    155B : 02                  	ld	(bc), a	; insert RST 38H code
    4348/    155C : C9                  	ret
    4349/    155D :                     	
    4350/    155D :                     ;;;
    4351/    155D :                     ;;; SET memory
    4352/    155D :                     ;;; 
    4353/    155D :                     
    4354/    155D :                     SETM:
    4355/    155D : 23                  	INC	HL
    4356/    155E : CD 05 27            	CALL	SKIPSP
    4357/    1561 : CD 15 27            	CALL	RDHEX
    4358/    1564 :                     
    4359/    1564 : DA 17 02            	jp	c, ERR
    4360/    1567 :                     
    4361/    1567 : CD 05 27            	CALL	SKIPSP
    4362/    156A : 7E                  	LD	A,(HL)
    4363/    156B : B7                  	OR	A
    4364/    156C : C2 17 02            	JP	NZ,ERR
    4365/    156F : 79                  	LD	A,C
    4366/    1570 : B7                  	OR	A
    4367/    1571 : 20 04               	JR	NZ,SM0
    4368/    1573 : ED 5B D7 FE         	LD	DE,(SADDR)
    4369/    1577 :                     
    4370/    1577 :                     
    4371/    1577 :                     SM0:
    4372/    1577 : EB                  	EX	DE,HL
    4373/    1578 :                     SM1:
    4374/    1578 : CD 24 26            	CALL	HEXOUT4
    4375/    157B : E5                  	PUSH	HL
    4376/    157C : 21 0E 2C            	LD	HL,dsap
    4377/    157F : CD 1B 26            	CALL	STROUT
    4378/    1582 : E1                  	POP	HL
    4379/    1583 : 7E                  	LD	A,(HL)
    4380/    1584 : E5                  	PUSH	HL
    4381/    1585 : CD 29 26            	CALL	HEXOUT2
    4382/    1588 : 3E 20               	LD	A,' '
    4383/    158A : CD 8B 2E            	CALL	CONOUT
    4384/    158D : CD 7B 26            	CALL	GETLIN
    4385/    1590 : CD 05 27            	CALL	SKIPSP
    4386/    1593 : 7E                  	LD	A,(HL)
    4387/    1594 : B7                  	OR	A
    4388/    1595 : 20 07               	JR	NZ,SM2
    4389/    1597 :                     	;; Empty  (Increment address)
    4390/    1597 : E1                  	POP	HL
    4391/    1598 : 23                  	INC	HL
    4392/    1599 : 22 D7 FE            	LD	(SADDR),HL
    4393/    159C : 18 DA               	JR	SM1
    4394/    159E :                     SM2:
    4395/    159E : FE 2D               	CP	'-'
    4396/    15A0 : 20 07               	JR	NZ,SM3
    4397/    15A2 :                     	;; '-'  (Decrement address)
    4398/    15A2 : E1                  	POP	HL
    4399/    15A3 : 2B                  	DEC	HL
    4400/    15A4 : 22 D7 FE            	LD	(SADDR),HL
    4401/    15A7 : 18 CF               	JR	SM1
    4402/    15A9 :                     SM3:
    4403/    15A9 : FE 2E               	CP	'.'
    4404/    15AB : 20 07               	JR	NZ,SM4
    4405/    15AD : E1                  	POP	HL
    4406/    15AE : 22 D7 FE            	LD	(SADDR),HL
    4407/    15B1 : C3 CB 01            	JP	WSTART
    4408/    15B4 :                     SM4:
    4409/    15B4 : CD 15 27            	CALL	RDHEX
    4410/    15B7 : B7                  	OR	A
    4411/    15B8 : E1                  	POP	HL
    4412/    15B9 : CA 17 02            	JP	Z,ERR
    4413/    15BC : 73                  	LD	(HL),E
    4414/    15BD : 23                  	INC	HL
    4415/    15BE : 22 D7 FE            	LD	(SADDR),HL	; set value
    4416/    15C1 :                     
    4417/    15C1 :                     	; resave opcode for BP command
    4418/    15C1 : ED 5B 00 FF         	ld	de, (bpt1_adr)
    4419/    15C5 : 1A                  	ld	a, (de)
    4420/    15C6 : 32 FF FE            	ld	(bpt1_op), a
    4421/    15C9 : ED 5B 04 FF         	ld	de, (bpt2_adr)
    4422/    15CD : 1A                  	ld	a, (de)
    4423/    15CE : 32 03 FF            	ld	(bpt2_op), a
    4424/    15D1 :                     
    4425/    15D1 : 18 A5               	JR	SM1
    4426/    15D3 :                     
    4427/    15D3 :                     ;;;
    4428/    15D3 :                     ;;; LOAD HEX file
    4429/    15D3 :                     ;;;
    4430/    15D3 :                     
    4431/    15D3 :                     LOADH:
    4432/    15D3 :                     	; clear brk point
    4433/    15D3 : AF                  	xor	a
    4434/    15D4 : 32 FE FE            	ld	(bpt1_f), a
    4435/    15D7 : 32 02 FF            	ld	(bpt2_f), a
    4436/    15DA :                     	
    4437/    15DA : 23                  	INC	HL
    4438/    15DB : CD 05 27            	CALL	SKIPSP
    4439/    15DE : CD 15 27            	CALL	RDHEX
    4440/    15E1 : CD 05 27            	CALL	SKIPSP
    4441/    15E4 : 7E                  	LD	A,(HL)
    4442/    15E5 : B7                  	OR	A
    4443/    15E6 : C2 17 02            	JP	NZ,ERR
    4444/    15E9 :                     
    4445/    15E9 : 79                  	LD	A,C
    4446/    15EA : B7                  	OR	A
    4447/    15EB : 20 03               	JR	NZ,LH0
    4448/    15ED :                     
    4449/    15ED : 11 00 00            	LD	DE,0		;Offset
    4450/    15F0 :                     LH0:
    4451/    15F0 : CD 3C 2E            	CALL	CONIN
    4452/    15F3 : FE 53               	CP	'S'
    4453/    15F5 : 28 61               	JR	Z,LHS0
    4454/    15F7 :                     LH1:
    4455/    15F7 : FE 3A               	CP	':'
    4456/    15F9 : 28 0D               	JR	Z,LHI0
    4457/    15FB :                     LH2:
    4458/    15FB :                     	;; Skip to EOL
    4459/    15FB : FE 0D               	CP	CR
    4460/    15FD : 28 F1               	JR	Z,LH0
    4461/    15FF : FE 0A               	CP	LF
    4462/    1601 : 28 ED               	JR	Z,LH0
    4463/    1603 :                     LH3:
    4464/    1603 : CD 3C 2E            	CALL	CONIN
    4465/    1606 : 18 F3               	JR	LH2
    4466/    1608 :                     
    4467/    1608 :                     LHI0:
    4468/    1608 : 3E 2E               	ld	a, '.'
    4469/    160A : CD 8B 2E            	call	CONOUT
    4470/    160D :                     
    4471/    160D : CD 40 26            	CALL	HEXIN
    4472/    1610 : 4F                  	LD	C,A		; Checksum
    4473/    1611 : 47                  	LD	B,A		; Length
    4474/    1612 :                     
    4475/    1612 : CD 40 26            	CALL	HEXIN
    4476/    1615 : 67                  	LD	H,A		; Address H
    4477/    1616 : 81                  	ADD	A,C
    4478/    1617 : 4F                  	LD	C,A
    4479/    1618 :                     
    4480/    1618 : CD 40 26            	CALL	HEXIN
    4481/    161B : 6F                  	LD	L,A		; Address L
    4482/    161C : 81                  	ADD	A,C
    4483/    161D : 4F                  	LD	C,A
    4484/    161E :                     
    4485/    161E :                     	;; Add offset
    4486/    161E : 19                  	ADD	HL,DE
    4487/    161F :                     
    4488/    161F : CD 40 26            	CALL	HEXIN
    4489/    1622 : 32 DA FE            	LD	(RECTYP),A
    4490/    1625 : 81                  	ADD	A,C
    4491/    1626 : 4F                  	LD	C,A		; Checksum
    4492/    1627 :                     
    4493/    1627 : 78                  	LD	A,B
    4494/    1628 : B7                  	OR	A
    4495/    1629 : 28 14               	JR	Z,LHI3
    4496/    162B :                     LHI1:
    4497/    162B : CD 40 26            	CALL	HEXIN
    4498/    162E : F5                  	PUSH	AF
    4499/    162F : 81                  	ADD	A,C
    4500/    1630 : 4F                  	LD	C,A		; Checksum
    4501/    1631 :                     
    4502/    1631 : 3A DA FE            	LD	A,(RECTYP)
    4503/    1634 : B7                  	OR	A
    4504/    1635 : 20 05               	JR	NZ,LHI20
    4505/    1637 :                     
    4506/    1637 : F1                  	POP	AF
    4507/    1638 : 77                  	LD	(HL),A
    4508/    1639 : 23                  	INC	HL
    4509/    163A : 18 01               	JR	LHI2
    4510/    163C :                     LHI20:
    4511/    163C : F1                  	POP	AF
    4512/    163D :                     LHI2:
    4513/    163D : 10 EC               	DJNZ	LHI1
    4514/    163F :                     LHI3:
    4515/    163F : CD 40 26            	CALL	HEXIN
    4516/    1642 : 81                  	ADD	A,C
    4517/    1643 : 20 0A               	JR	NZ,LHIE		; Checksum error
    4518/    1645 : 3A DA FE            	LD	A,(RECTYP)
    4519/    1648 : B7                  	OR	A
    4520/    1649 : CA 03 16            	JP	Z,LH3
    4521/    164C : C3 CB 01            	JP	WSTART
    4522/    164F :                     LHIE:
    4523/    164F : 21 E5 2B            	LD	HL,IHEMSG
    4524/    1652 : CD 1B 26            	CALL	STROUT
    4525/    1655 : C3 CB 01            	JP	WSTART
    4526/    1658 :                     	
    4527/    1658 :                     LHS0:
    4528/    1658 : CD 3C 2E            	CALL	CONIN
    4529/    165B : 32 DA FE            	LD	(RECTYP),A
    4530/    165E :                     
    4531/    165E : CD 40 26            	CALL	HEXIN
    4532/    1661 : 47                  	LD	B,A		; Length+3
    4533/    1662 : 4F                  	LD	C,A		; Checksum
    4534/    1663 :                     
    4535/    1663 : CD 40 26            	CALL	HEXIN
    4536/    1666 : 67                  	LD	H,A
    4537/    1667 : 81                  	ADD	A,C
    4538/    1668 : 4F                  	LD	C,A
    4539/    1669 :                     	
    4540/    1669 : CD 40 26            	CALL	HEXIN
    4541/    166C : 6F                  	LD	L,A
    4542/    166D : 81                  	ADD	A,C
    4543/    166E : 4F                  	LD	C,A
    4544/    166F :                     
    4545/    166F : 19                  	ADD	HL,DE
    4546/    1670 :                     
    4547/    1670 : 05                  	DEC	B
    4548/    1671 : 05                  	DEC	B
    4549/    1672 : 05                  	DEC	B
    4550/    1673 : 28 15               	JR	Z,LHS3
    4551/    1675 :                     LHS1:
    4552/    1675 : CD 40 26            	CALL	HEXIN
    4553/    1678 : F5                  	PUSH	AF
    4554/    1679 : 81                  	ADD	A,C
    4555/    167A : 4F                  	LD	C,A		; Checksum
    4556/    167B :                     
    4557/    167B : 3A DA FE            	LD	A,(RECTYP)
    4558/    167E : FE 31               	CP	'1'
    4559/    1680 : 20 05               	JR	NZ,LHS2
    4560/    1682 :                     
    4561/    1682 : F1                  	POP	AF
    4562/    1683 : 77                  	LD	(HL),A
    4563/    1684 : 23                  	INC	HL
    4564/    1685 : 18 01               	JR	LHS20
    4565/    1687 :                     LHS2:
    4566/    1687 : F1                  	POP	AF
    4567/    1688 :                     LHS20:
    4568/    1688 : 10 EB               	DJNZ	LHS1
    4569/    168A :                     LHS3:
    4570/    168A : CD 40 26            	CALL	HEXIN
    4571/    168D : 81                  	ADD	A,C
    4572/    168E : FE FF               	CP	0FFH
    4573/    1690 : 20 12               	JR	NZ,LHSE
    4574/    1692 :                     
    4575/    1692 : 3A DA FE            	LD	A,(RECTYP)
    4576/    1695 : FE 37               	CP	'7'
    4577/    1697 : 28 11               	JR	Z,LHSR
    4578/    1699 : FE 38               	CP	'8'
    4579/    169B : 28 0D               	JR	Z,LHSR
    4580/    169D : FE 39               	CP	'9'
    4581/    169F : 28 09               	JR	Z,LHSR
    4582/    16A1 : C3 03 16            	JP	LH3
    4583/    16A4 :                     LHSE:
    4584/    16A4 : 21 F2 2B            	LD	HL,SHEMSG
    4585/    16A7 : CD 1B 26            	CALL	STROUT
    4586/    16AA :                     LHSR:
    4587/    16AA : C3 CB 01            	JP	WSTART
    4588/    16AD :                     	
    4589/    16AD :                     ;;;
    4590/    16AD :                     ;;; SAVE HEX file
    4591/    16AD :                     ;;;
    4592/    16AD :                     
    4593/    16AD :                     SAVEH:
    4594/    16AD : 23                  	INC	HL
    4595/    16AE : 7E                  	LD	A,(HL)
    4596/    16AF : FE 49               	CP	'I'
    4597/    16B1 : 28 04               	JR	Z,SH0
    4598/    16B3 : FE 53               	CP	'S'
    4599/    16B5 : 20 04               	JR	NZ,SH1
    4600/    16B7 :                     SH0:
    4601/    16B7 : 23                  	INC	HL
    4602/    16B8 : 32 D9 FE            	LD	(HEXMOD),A
    4603/    16BB :                     SH1:
    4604/    16BB : CD 05 27            	CALL	SKIPSP
    4605/    16BE : CD 15 27            	CALL	RDHEX
    4606/    16C1 : B7                  	OR	A
    4607/    16C2 : 28 1C               	JR	Z,SHE
    4608/    16C4 : D5                  	PUSH	DE
    4609/    16C5 : DD E1               	POP	IX		; IX = Start address
    4610/    16C7 : CD 05 27            	CALL	SKIPSP
    4611/    16CA : 7E                  	LD	A,(HL)
    4612/    16CB : FE 2C               	CP	','
    4613/    16CD : 20 11               	JR	NZ,SHE
    4614/    16CF : 23                  	INC	HL
    4615/    16D0 : CD 05 27            	CALL	SKIPSP
    4616/    16D3 : CD 15 27            	CALL	RDHEX		; DE = End address
    4617/    16D6 : B7                  	OR	A
    4618/    16D7 : 28 07               	JR	Z,SHE
    4619/    16D9 : CD 05 27            	CALL	SKIPSP
    4620/    16DC : 7E                  	LD	A,(HL)
    4621/    16DD : B7                  	OR	A
    4622/    16DE : 28 03               	JR	Z,SH2
    4623/    16E0 :                     SHE:
    4624/    16E0 : C3 17 02            	JP	ERR
    4625/    16E3 :                     
    4626/    16E3 :                     SH2:
    4627/    16E3 : DD E5               	PUSH	IX
    4628/    16E5 : E1                  	POP	HL
    4629/    16E6 : EB                  	EX	DE,HL
    4630/    16E7 : 23                  	INC	HL
    4631/    16E8 : B7                  	OR	A
    4632/    16E9 : ED 52               	SBC	HL,DE		; HL = Length
    4633/    16EB :                     SH3:
    4634/    16EB : CD 0B 17            	CALL	SHL00
    4635/    16EE : 7C                  	LD	A,H
    4636/    16EF : B5                  	OR	L
    4637/    16F0 : 20 F9               	JR	NZ,SH3
    4638/    16F2 :                     
    4639/    16F2 : 3A D9 FE            	LD	A,(HEXMOD)
    4640/    16F5 : FE 49               	CP	'I'
    4641/    16F7 : 20 09               	JR	NZ,SH4
    4642/    16F9 :                     	;; End record for Intel HEX
    4643/    16F9 : 21 11 2C            	LD	HL,IHEXER
    4644/    16FC : CD 1B 26            	CALL	STROUT
    4645/    16FF : C3 CB 01            	JP	WSTART
    4646/    1702 :                     SH4:
    4647/    1702 :                     	;; End record for Motorola S record
    4648/    1702 : 21 1F 2C            	LD	HL,SRECER
    4649/    1705 : CD 1B 26            	CALL	STROUT
    4650/    1708 : C3 CB 01            	JP	WSTART
    4651/    170B :                     
    4652/    170B :                     SHL00:
    4653/    170B : 0E 10               	LD	C,16
    4654/    170D : 7C                  	LD	A,H
    4655/    170E : B7                  	OR	A
    4656/    170F : 20 05               	JR	NZ,SHL0
    4657/    1711 : 7D                  	LD	A,L
    4658/    1712 : B9                  	CP	C
    4659/    1713 : 30 01               	JR	NC,SHL0
    4660/    1715 : 4F                  	LD	C,A
    4661/    1716 :                     SHL0:
    4662/    1716 : 06 00               	LD	B,0
    4663/    1718 : B7                  	OR	A
    4664/    1719 : ED 42               	SBC	HL,BC
    4665/    171B : 41                  	LD	B,C
    4666/    171C :                     
    4667/    171C : 3A D9 FE            	LD	A,(HEXMOD)
    4668/    171F : FE 49               	CP	'I'
    4669/    1721 : 20 30               	JR	NZ,SHLS
    4670/    1723 :                     
    4671/    1723 :                     	;; Intel HEX
    4672/    1723 : 3E 3A               	LD	A,':'
    4673/    1725 : CD 8B 2E            	CALL	CONOUT
    4674/    1728 :                     
    4675/    1728 : 78                  	LD	A,B
    4676/    1729 : CD 29 26            	CALL	HEXOUT2		; Length
    4677/    172C : 48                  	LD	C,B		; Checksum
    4678/    172D :                     
    4679/    172D : 7A                  	LD	A,D
    4680/    172E : CD 29 26            	CALL	HEXOUT2
    4681/    1731 : 7A                  	LD	A,D
    4682/    1732 : 81                  	ADD	A,C
    4683/    1733 : 4F                  	LD	C,A
    4684/    1734 :                     	
    4685/    1734 : 7B                  	LD	A,E
    4686/    1735 : CD 29 26            	CALL	HEXOUT2
    4687/    1738 : 7B                  	LD	A,E
    4688/    1739 : 81                  	ADD	A,C
    4689/    173A : 4F                  	LD	C,A
    4690/    173B :                     	
    4691/    173B : AF                  	XOR	A
    4692/    173C : CD 29 26            	CALL	HEXOUT2
    4693/    173F :                     SHLI0:
    4694/    173F : 1A                  	LD	A,(DE)
    4695/    1740 : F5                  	PUSH	AF
    4696/    1741 : CD 29 26            	CALL	HEXOUT2
    4697/    1744 : F1                  	POP	AF
    4698/    1745 : 81                  	ADD	A,C
    4699/    1746 : 4F                  	LD	C,A
    4700/    1747 :                     
    4701/    1747 : 13                  	INC	DE
    4702/    1748 : 10 F5               	DJNZ	SHLI0
    4703/    174A :                     
    4704/    174A : 79                  	LD	A,C
    4705/    174B : ED 44               	NEG
    4706/    174D : CD 29 26            	CALL	HEXOUT2
    4707/    1750 : C3 64 26            	JP	CRLF
    4708/    1753 :                     
    4709/    1753 :                     SHLS:
    4710/    1753 :                     	;; Motorola S record
    4711/    1753 : 3E 53               	LD	A,'S'
    4712/    1755 : CD 8B 2E            	CALL	CONOUT
    4713/    1758 : 3E 31               	LD	A,'1'
    4714/    175A : CD 8B 2E            	CALL	CONOUT
    4715/    175D :                     
    4716/    175D : 78                  	LD	A,B
    4717/    175E : C6 03               	ADD	A,2+1		; DataLength + 2(Addr) + 1(Sum)
    4718/    1760 : 4F                  	LD	C,A
    4719/    1761 : CD 29 26            	CALL	HEXOUT2
    4720/    1764 :                     
    4721/    1764 : 7A                  	LD	A,D
    4722/    1765 : CD 29 26            	CALL	HEXOUT2
    4723/    1768 : 7A                  	LD	A,D
    4724/    1769 : 81                  	ADD	A,C
    4725/    176A : 4F                  	LD	C,A
    4726/    176B :                     	
    4727/    176B : 7B                  	LD	A,E
    4728/    176C : CD 29 26            	CALL	HEXOUT2
    4729/    176F : 7B                  	LD	A,E
    4730/    1770 : 81                  	ADD	A,C
    4731/    1771 : 4F                  	LD	C,A
    4732/    1772 :                     SHLS0:
    4733/    1772 : 1A                  	LD	A,(DE)
    4734/    1773 : F5                  	PUSH	AF
    4735/    1774 : CD 29 26            	CALL	HEXOUT2		; Data
    4736/    1777 : F1                  	POP	AF
    4737/    1778 : 81                  	ADD	A,C
    4738/    1779 : 4F                  	LD	C,A
    4739/    177A :                     
    4740/    177A : 13                  	INC	DE
    4741/    177B : 10 F5               	DJNZ	SHLS0
    4742/    177D :                     
    4743/    177D : 79                  	LD	A,C
    4744/    177E : 2F                  	CPL
    4745/    177F : CD 29 26            	CALL	HEXOUT2
    4746/    1782 : C3 64 26            	JP	CRLF
    4747/    1785 :                     
    4748/    1785 :                     ;;;
    4749/    1785 :                     ;;; Register
    4750/    1785 :                     ;;;
    4751/    1785 :                     
    4752/    1785 :                     REG:
    4753/    1785 : 23                  	INC	HL
    4754/    1786 : CD 05 27            	CALL	SKIPSP
    4755/    1789 : B7                  	OR	A
    4756/    178A : 20 06               	JR	NZ,RG0
    4757/    178C : CD 0B 18            	CALL	RDUMP
    4758/    178F : C3 CB 01            	JP	WSTART
    4759/    1792 :                     RG0:
    4760/    1792 : EB                  	EX	DE,HL
    4761/    1793 : 21 D5 2C            	LD	HL,RNTAB
    4762/    1796 :                     RG1:
    4763/    1796 : BE                  	CP	(HL)
    4764/    1797 : 28 0D               	JR	Z,RG2		; Character match
    4765/    1799 : 4F                  	LD	C,A
    4766/    179A : 23                  	INC	HL
    4767/    179B : 7E                  	LD	A,(HL)
    4768/    179C : B7                  	OR	A
    4769/    179D : 28 69               	JR	Z,RGE		; Found end mark
    4770/    179F : 79                  	LD	A,C
    4771/    17A0 : 01 05 00            	LD	BC,5
    4772/    17A3 : 09                  	ADD	HL,BC		; Next entry
    4773/    17A4 : 18 F0               	JR	RG1
    4774/    17A6 :                     RG2:
    4775/    17A6 : 23                  	INC	HL
    4776/    17A7 : 7E                  	LD	A,(HL)
    4777/    17A8 : FE 0F               	CP	0FH		; Link code
    4778/    17AA : 20 09               	JR	NZ,RG3
    4779/    17AC :                     	;; Next table
    4780/    17AC : 23                  	INC	HL
    4781/    17AD : 4E                  	LD	C,(HL)
    4782/    17AE : 23                  	INC	HL
    4783/    17AF : 66                  	LD	H,(HL)
    4784/    17B0 : 69                  	LD	L,C
    4785/    17B1 : 13                  	INC	DE
    4786/    17B2 : 1A                  	LD	A,(DE)
    4787/    17B3 : 18 E1               	JR	RG1
    4788/    17B5 :                     RG3:
    4789/    17B5 : B7                  	OR	A
    4790/    17B6 : 28 50               	JR	Z,RGE		; Found end mark
    4791/    17B8 :                     
    4792/    17B8 : 4E                  	LD	C,(HL)		; LD C,A???
    4793/    17B9 : 23                  	INC	HL
    4794/    17BA : 5E                  	LD	E,(HL)
    4795/    17BB : 23                  	INC	HL
    4796/    17BC : 56                  	LD	D,(HL)
    4797/    17BD : D5                  	PUSH	DE		; Reg storage address
    4798/    17BE : 23                  	INC	HL
    4799/    17BF : 7E                  	LD	A,(HL)
    4800/    17C0 : 23                  	INC	HL
    4801/    17C1 : 66                  	LD	H,(HL)
    4802/    17C2 : 6F                  	LD	L,A		; HL: Reg name
    4803/    17C3 : CD 1B 26            	CALL	STROUT
    4804/    17C6 : 3E 3D               	LD	A,'='
    4805/    17C8 : CD 8B 2E            	CALL	CONOUT
    4806/    17CB :                     
    4807/    17CB : 79                  	LD	A,C
    4808/    17CC : E6 07               	AND	07H
    4809/    17CE : FE 01               	CP	1
    4810/    17D0 : 20 08               	JR	NZ,RG4
    4811/    17D2 :                     	;; 8 bit register
    4812/    17D2 : E1                  	POP	HL
    4813/    17D3 : 7E                  	LD	A,(HL)
    4814/    17D4 : E5                  	PUSH	HL
    4815/    17D5 : CD 29 26            	CALL	HEXOUT2
    4816/    17D8 : 18 0C               	JR	RG5
    4817/    17DA :                     RG4:
    4818/    17DA :                     	;; 16 bit register
    4819/    17DA : E1                  	POP	HL
    4820/    17DB : E5                  	PUSH	HL
    4821/    17DC : 23                  	INC	HL
    4822/    17DD : 7E                  	LD	A,(HL)
    4823/    17DE : CD 29 26            	CALL	HEXOUT2
    4824/    17E1 : 2B                  	DEC	HL
    4825/    17E2 : 7E                  	LD	A,(HL)
    4826/    17E3 : CD 29 26            	CALL	HEXOUT2
    4827/    17E6 :                     RG5:
    4828/    17E6 : 3E 20               	LD	A,' '
    4829/    17E8 : CD 8B 2E            	CALL	CONOUT
    4830/    17EB : C5                  	PUSH	BC		; C: reg size
    4831/    17EC : CD 7B 26            	CALL	GETLIN
    4832/    17EF : CD 05 27            	CALL	SKIPSP
    4833/    17F2 : CD 15 27            	CALL	RDHEX
    4834/    17F5 : B7                  	OR	A
    4835/    17F6 : 28 0D               	JR	Z,RGR
    4836/    17F8 : C1                  	POP	BC
    4837/    17F9 : E1                  	POP	HL
    4838/    17FA : 79                  	LD	A,C
    4839/    17FB : FE 01               	CP	1
    4840/    17FD : 20 03               	JR	NZ,RG6
    4841/    17FF :                     	;; 8 bit register
    4842/    17FF : 73                  	LD	(HL),E
    4843/    1800 : 18 03               	JR	RG7
    4844/    1802 :                     RG6:
    4845/    1802 :                     	;; 16 bit register
    4846/    1802 : 73                  	LD	(HL),E
    4847/    1803 : 23                  	INC	HL
    4848/    1804 : 72                  	LD	(HL),D
    4849/    1805 :                     RG7:
    4850/    1805 :                     RGR:
    4851/    1805 : C3 CB 01            	JP	WSTART
    4852/    1808 :                     RGE:
    4853/    1808 : C3 17 02            	JP	ERR
    4854/    180B :                     
    4855/    180B :                     RDUMP:
    4856/    180B : 21 2C 2C            	LD	HL,RDTAB
    4857/    180E :                     RD0:
    4858/    180E : 5E                  	LD	E,(HL)
    4859/    180F : 23                  	INC	HL
    4860/    1810 : 56                  	LD	D,(HL)
    4861/    1811 : 23                  	INC	HL
    4862/    1812 : 7A                  	LD	A,D
    4863/    1813 : B3                  	OR	E
    4864/    1814 : CA 64 26            	JP	Z,CRLF		; End
    4865/    1817 : D5                  	push	de
    4866/    1818 : EB                  	EX	DE,HL
    4867/    1819 : CD 1B 26            	CALL	STROUT	; print name of register
    4868/    181C : EB                  	EX	DE,HL
    4869/    181D : D1                  	pop	de
    4870/    181E :                     
    4871/    181E :                     ; flag check
    4872/    181E : 3E 2C               	ld	a, RDSF_H
    4873/    1820 : BA                  	cp	d
    4874/    1821 : 20 07               	jr	nz, rd101
    4875/    1823 : 3E 97               	ld	a, RDSF_L
    4876/    1825 : BB                  	cp	e
    4877/    1826 : 20 02               	jr	nz, rd101
    4878/    1828 : 18 29               	jr	rd20
    4879/    182A :                     
    4880/    182A :                     rd101:
    4881/    182A : 3E 2C               	ld	a, RDSFX_H
    4882/    182C : BA                  	cp	d
    4883/    182D : 20 05               	jr	nz, rd10
    4884/    182F : 3E BE               	ld	a, RDSFX_L
    4885/    1831 : BB                  	cp	e
    4886/    1832 : 28 1F               	jr	z, rd20
    4887/    1834 :                     
    4888/    1834 :                     rd10:
    4889/    1834 : 5E                  	LD	E,(HL)
    4890/    1835 : 23                  	INC	HL
    4891/    1836 : 56                  	LD	D,(HL)
    4892/    1837 : 23                  	INC	HL
    4893/    1838 : 7E                  	LD	A,(HL)
    4894/    1839 : 23                  	INC	HL
    4895/    183A : EB                  	EX	DE,HL
    4896/    183B : FE 01               	CP	1
    4897/    183D : 20 07               	JR	NZ,RD1
    4898/    183F :                     	;; 1 byte
    4899/    183F : 7E                  	LD	A,(HL)
    4900/    1840 : CD 29 26            	CALL	HEXOUT2
    4901/    1843 : EB                  	EX	DE,HL
    4902/    1844 : 18 C8               	JR	RD0
    4903/    1846 :                     RD1:
    4904/    1846 :                     	;; 2 byte
    4905/    1846 : 23                  	INC	HL
    4906/    1847 : 7E                  	LD	A,(HL)
    4907/    1848 : CD 29 26            	CALL	HEXOUT2		; High byte
    4908/    184B : 2B                  	DEC	HL
    4909/    184C : 7E                  	LD	A,(HL)
    4910/    184D : CD 29 26            	CALL	HEXOUT2		; Low byte
    4911/    1850 : EB                  	EX	DE,HL
    4912/    1851 : 18 BB               	JR	RD0
    4913/    1853 :                     
    4914/    1853 :                     ; make flag image string
    4915/    1853 :                     rd20:
    4916/    1853 : 5E                  	LD	E,(HL)
    4917/    1854 : 23                  	INC	HL
    4918/    1855 : 56                  	LD	D,(HL)
    4919/    1856 : 23                  	INC	HL
    4920/    1857 : 1A                  	ld	a, (de)		; get flag values
    4921/    1858 :                     
    4922/    1858 : D5                  	push	de
    4923/    1859 : E5                  	push	hl
    4924/    185A :                     
    4925/    185A :                     ; make flag image
    4926/    185A :                     
    4927/    185A : 21 30 FF            	ld	hl, F_bit
    4928/    185D : 01 87 18            	ld	bc, F_bit_on
    4929/    1860 : 11 8F 18            	ld	de, F_bit_off
    4930/    1863 : F5                  	push	af		; adjustment SP. DO NOT DELETE THIS LINE!
    4931/    1864 :                     
    4932/    1864 :                     flg_loop:
    4933/    1864 : F1                  	pop	af		; "push af" before loop back
    4934/    1865 : CB 27               	sla	a
    4935/    1867 : 30 06               	jr	nc, flg_off
    4936/    1869 : F5                  	push	af
    4937/    186A : 0A                  	ld	a, (bc)
    4938/    186B : 77                  	ld	(hl), a
    4939/    186C : F1                  	pop	af
    4940/    186D : 18 04               	jr	flg_nxt
    4941/    186F :                     flg_off:
    4942/    186F : F5                  	push	af
    4943/    1870 : 1A                  	ld	a, (de)
    4944/    1871 : 77                  	ld	(hl), a
    4945/    1872 : F1                  	pop	af
    4946/    1873 :                     
    4947/    1873 :                     flg_nxt:
    4948/    1873 : 03                  	inc	bc
    4949/    1874 : 13                  	inc	de
    4950/    1875 : 23                  	inc	hl
    4951/    1876 :                     
    4952/    1876 : F5                  	push	af
    4953/    1877 : 7E                  	ld	a, (hl)
    4954/    1878 : B7                  	or	a		;check delimiter
    4955/    1879 : 20 E9               	jr	nz, flg_loop
    4956/    187B :                     
    4957/    187B : F1                  	pop	af		; restore stack position
    4958/    187C : 21 30 FF            	ld	hl, F_bit
    4959/    187F : CD 1B 26            	call	STROUT		; print flag register for bit imaze
    4960/    1882 :                     
    4961/    1882 : E1                  	pop	hl
    4962/    1883 : D1                  	pop	de
    4963/    1884 :                     
    4964/    1884 : 23                  	inc	hl
    4965/    1885 : 18 87               	JR	RD0
    4966/    1887 :                     
    4967/    1887 : 53 5A 2E 48 2E 50   F_bit_on:	db	"SZ.H.PNC"
             188D : 4E 43             
    4968/    188F : 2E 2E 2E 2E 2E 2E   F_bit_off:	db	"........"
             1895 : 2E 2E             
    4969/    1897 :                     
    4970/    1897 :                     ;--------------------------------------------------
    4971/    1897 :                     ;
    4972/    1897 :                     ; Minimal assemble
    4973/    1897 :                     ;
    4974/    1897 :                     ;--------------------------------------------------
    4975/    1897 :                     
    4976/    1897 : =80H                 dm_bit	equ	80h
    4977/    1897 :                     
    4978/    1897 :                     ope_cds:
    4979/    1897 :                     ; 4 bytes string
    4980/    1897 : 49 4E 49 52 B9      	db	"INIR",	dm_bit | 57
    4981/    189C : 49 4E 44 52 BB      	db	"INDR",	dm_bit | 59
    4982/    18A1 : 4F 55 54 49 BD      	db	"OUTI",	dm_bit | 61
    4983/    18A6 : 4F 54 49 52 BE      	db	"OTIR",	dm_bit | 62
    4984/    18AB : 4F 55 54 44 BF      	db	"OUTD",	dm_bit | 63
    4985/    18B0 : 4F 54 44 52 C0      	db	"OTDR",	dm_bit | 64
    4986/    18B5 : 48 41 4C 54 B3      	db	"HALT",	dm_bit | 51
    4987/    18BA : 52 45 54 49 AF      	db	"RETI",	dm_bit | 47
    4988/    18BF : 52 45 54 4E B0      	db	"RETN",	dm_bit | 48
    4989/    18C4 : 44 4A 4E 5A AC      	db	"DJNZ",	dm_bit | 44
    4990/    18C9 : 43 41 4C 4C AD      	db	"CALL",	dm_bit | 45
    4991/    18CE : 43 50 44 52 A8      	db	"CPDR",	dm_bit | 40
    4992/    18D3 : 4C 44 49 52 83      	db	"LDIR",	dm_bit | 03
    4993/    18D8 : 4C 44 44 52 85      	db	"LDDR",	dm_bit | 05
    4994/    18DD : 50 55 53 48 88      	db	"PUSH",	dm_bit | 08
    4995/    18E2 : 52 4C 43 41 8A      	db	"RLCA",	dm_bit | 10
    4996/    18E7 : 52 52 43 41 8E      	db	"RRCA",	dm_bit | 14
    4997/    18EC : 43 50 49 52 A6      	db	"CPIR",	dm_bit | 38
    4998/    18F1 :                     
    4999/    18F1 :                     ; 3 bytes string
    5000/    18F1 : 4C 44 49 82         	db	"LDI",	dm_bit | 02
    5001/    18F5 : 4C 44 44 84         	db	"LDD",	dm_bit | 04
    5002/    18F9 : 45 58 58 87         	db	"EXX",	dm_bit | 07
    5003/    18FD : 50 4F 50 89         	db	"POP",	dm_bit | 09
    5004/    1901 : 52 4C 41 8B         	db	"RLA",	dm_bit | 11
    5005/    1905 : 52 4C 43 8C         	db	"RLC",	dm_bit | 12
    5006/    1909 : 52 52 41 8F         	db	"RRA",	dm_bit | 15
    5007/    190D : 52 52 43 90         	db	"RRC",	dm_bit | 16
    5008/    1911 : 53 4C 41 92         	db	"SLA",	dm_bit | 18
    5009/    1915 : 53 52 41 93         	db	"SRA",	dm_bit | 19
    5010/    1919 : 53 52 4C 94         	db	"SRL",	dm_bit | 20
    5011/    191D : 41 44 44 95         	db	"ADD",	dm_bit | 21
    5012/    1921 : 41 44 43 96         	db	"ADC",	dm_bit | 22
    5013/    1925 : 49 4E 43 97         	db	"INC",	dm_bit | 23
    5014/    1929 : 53 55 42 98         	db	"SUB",	dm_bit | 24
    5015/    192D : 53 42 43 99         	db	"SBC",	dm_bit | 25
    5016/    1931 : 44 45 43 9A         	db	"DEC",	dm_bit | 26
    5017/    1935 : 41 4E 44 9B         	db	"AND",	dm_bit | 27
    5018/    1939 : 58 4F 52 9D         	db	"XOR",	dm_bit | 29
    5019/    193D : 43 50 4C 9E         	db	"CPL",	dm_bit | 30
    5020/    1941 : 4E 45 47 9F         	db	"NEG",	dm_bit | 31
    5021/    1945 : 43 43 46 A0         	db	"CCF",	dm_bit | 32
    5022/    1949 : 53 43 46 A1         	db	"SCF",	dm_bit | 33
    5023/    194D : 42 49 54 A2         	db	"BIT",	dm_bit | 34
    5024/    1951 : 53 45 54 A3         	db	"SET",	dm_bit | 35
    5025/    1955 : 52 45 53 A4         	db	"RES",	dm_bit | 36
    5026/    1959 : 43 50 49 A5         	db	"CPI",	dm_bit | 37
    5027/    195D : 43 50 44 A7         	db	"CPD",	dm_bit | 39
    5028/    1961 : 52 45 54 AE         	db	"RET",	dm_bit | 46
    5029/    1965 : 52 53 54 B1         	db	"RST",	dm_bit | 49
    5030/    1969 : 4E 4F 50 B2         	db	"NOP",	dm_bit | 50
    5031/    196D : 49 4E 49 B8         	db	"INI",	dm_bit | 56
    5032/    1971 : 49 4E 44 BA         	db	"IND",	dm_bit | 58
    5033/    1975 : 4F 55 54 BC         	db	"OUT",	dm_bit | 60
    5034/    1979 : 44 41 41 C1         	db	"DAA",	dm_bit | 65
    5035/    197D : 52 4C 44 C2         	db	"RLD",	dm_bit | 66
    5036/    1981 : 52 52 44 C3         	db	"RRD",	dm_bit | 67
    5037/    1985 : 4F 52 47 C4         	db	"ORG",	dm_bit | 68
    5038/    1989 :                     
    5039/    1989 :                     ; 2 bytes string
    5040/    1989 : 45 58 86            	db	"EX",	dm_bit | 06
    5041/    198C : 52 4C 8D            	db	"RL",	dm_bit | 13
    5042/    198F : 52 52 91            	db	"RR",	dm_bit | 17
    5043/    1992 : 4F 52 9C            	db	"OR",	dm_bit | 28
    5044/    1995 : 43 50 A9            	db	"CP",	dm_bit | 41
    5045/    1998 : 4A 50 AA            	db	"JP",	dm_bit | 42
    5046/    199B : 4A 52 AB            	db	"JR",	dm_bit | 43
    5047/    199E : 49 4D B6            	db	"IM",	dm_bit | 54
    5048/    19A1 : 49 4E B7            	db	"IN",	dm_bit | 55
    5049/    19A4 : 44 49 B4            	db	"DI",	dm_bit | 52
    5050/    19A7 : 45 49 B5            	db	"EI",	dm_bit | 53
    5051/    19AA : 4C 44 81            	db	"LD",	dm_bit | 01
    5052/    19AD : 44 42 C5            	db	"DB",	dm_bit | 69
    5053/    19B0 : 44 57 C6            	db	"DW",	dm_bit | 70
    5054/    19B3 : 00                  	db	0	; delimiter
    5055/    19B4 :                     
    5056/    19B4 :                     operand_cds:
    5057/    19B4 :                     ; 4 bytes string
    5058/    19B4 : 28 42 43 29 9A      	db	"(BC)",	dm_bit | 26
    5059/    19B9 : 28 44 45 29 9B      	db	"(DE)",	dm_bit | 27
    5060/    19BE : 28 48 4C 29 9C      	db	"(HL)",	dm_bit | 28
    5061/    19C3 : 28 49 58 29 9D      	db	"(IX)",	dm_bit | 29
    5062/    19C8 : 28 49 59 29 9E      	db	"(IY)",	dm_bit | 30
    5063/    19CD : 28 53 50 29 A0      	db	"(SP)",	dm_bit | 32
    5064/    19D2 :                     
    5065/    19D2 :                     ; 3 bytes string
    5066/    19D2 : 28 43 29 9F         	db	"(C)",	dm_bit | 31
    5067/    19D6 : 41 46 27 83         	db	"AF'",	dm_bit | 3
    5068/    19DA :                     
    5069/    19DA :                     ; 2 bytes string
    5070/    19DA : 41 46 82            	db	"AF",	dm_bit | 2
    5071/    19DD : 42 43 85            	db	"BC",	dm_bit | 5
    5072/    19E0 : 44 45 88            	db	"DE",	dm_bit | 8
    5073/    19E3 : 48 4C 8B            	db	"HL",	dm_bit | 11
    5074/    19E6 : 49 58 8E            	db	"IX",	dm_bit | 14
    5075/    19E9 : 49 59 8F            	db	"IY",	dm_bit | 15
    5076/    19EC : 53 50 90            	db	"SP",	dm_bit | 16
    5077/    19EF : 4E 5A 94            	db	"NZ",	dm_bit | 20
    5078/    19F2 : 4E 43 95            	db	"NC",	dm_bit | 21
    5079/    19F5 : 50 4F 97            	db	"PO",	dm_bit | 23
    5080/    19F8 : 50 45 98            	db	"PE",	dm_bit | 24
    5081/    19FB :                     
    5082/    19FB :                     ; 1 bytes string
    5083/    19FB : 41 81               	db	"A",  	dm_bit | 1
    5084/    19FD : 42 84               	db	"B",	dm_bit | 4
    5085/    19FF : 43 86               	db	"C",	dm_bit | 6
    5086/    1A01 : 44 87               	db	"D",	dm_bit | 7
    5087/    1A03 : 45 89               	db	"E",	dm_bit | 9
    5088/    1A05 : 48 8A               	db	"H",	dm_bit | 10
    5089/    1A07 : 4C 8C               	db	"L",	dm_bit | 12
    5090/    1A09 : 49 8D               	db	"I",	dm_bit | 13
    5091/    1A0B : 52 91               	db	"R",	dm_bit | 17
    5092/    1A0D : 5A 92               	db	"Z",	dm_bit | 18
    5093/    1A0F : 4D 93               	db	"M",	dm_bit | 19
    5094/    1A11 : 50 96               	db	"P",	dm_bit | 22
    5095/    1A13 : 00                  	db	0	; delimiter
    5096/    1A14 :                     
    5097/    1A14 :                     opr_cd1:
    5098/    1A14 : 28 49 58 2B A1      	db	"(IX+",	dm_bit | 33
    5099/    1A19 : 28 49 59 2B A2      	db	"(IY+",	dm_bit | 34
    5100/    1A1E : 28 49 58 2D A4      	db	"(IX-",	dm_bit | 36
    5101/    1A23 : 28 49 59 2D A5      	db	"(IY-",	dm_bit | 37
    5102/    1A28 : 00                  	db	0	; delimiter
    5103/    1A29 :                     
    5104/    1A29 :                     ;----------------------------------------------
    5105/    1A29 :                     ; A[<address>] : input line assemble mode
    5106/    1A29 :                     ; A[.]<cr> : exit assemble mode
    5107/    1A29 :                     ;----------------------------------------------
    5108/    1A29 :                     line_asm:
    5109/    1A29 : 23                  	inc	hl
    5110/    1A2A : CD 89 25            	call	skp_sp
    5111/    1A2D : B7                  	or	a
    5112/    1A2E : 28 11               	jr	z, skpa_adr
    5113/    1A30 : CD 15 27            	call	RDHEX		; get DE: address
    5114/    1A33 : DA 17 02            	jp	c, ERR
    5115/    1A36 : ED 53 1B FF         	ld	(asm_adr), de	; set start address
    5116/    1A3A :                     
    5117/    1A3A : CD 89 25            	call	skp_sp
    5118/    1A3D : B7                  	or	a
    5119/    1A3E : C2 17 02            	jp	nz, ERR
    5120/    1A41 :                     	
    5121/    1A41 :                     	; init work area
    5122/    1A41 :                     skpa_adr:
    5123/    1A41 : 2A 1B FF            	ld	hl, (asm_adr)
    5124/    1A44 : 22 1D FF            	ld	(tasm_adr), hl
    5125/    1A47 :                     	
    5126/    1A47 :                     	; print address
    5127/    1A47 :                     
    5128/    1A47 :                     next_asm:
    5129/    1A47 : AF                  	xor	a
    5130/    1A48 : 32 1F FF            	ld	(element_cnt), a
    5131/    1A4B : 32 21 FF            	ld	(opc_cd), a
    5132/    1A4E : 32 22 FF            	ld	(opr1_cd), a
    5133/    1A51 : 32 23 FF            	ld	(opr2_cd), a
    5134/    1A54 :                     
    5135/    1A54 : 2A 1D FF            	ld	hl, (tasm_adr)
    5136/    1A57 : CD 24 26            	call	HEXOUT4
    5137/    1A5A : 21 0E 2C            	ld	hl, dsap
    5138/    1A5D : CD 1B 26            	call	STROUT
    5139/    1A60 :                     
    5140/    1A60 :                     ;-----------------------------
    5141/    1A60 :                     ; get a line from console
    5142/    1A60 :                     ;-----------------------------
    5143/    1A60 : 21 39 FF            	ld	hl, ky_flg
    5144/    1A63 : CB CE               	set	NO_LF>>1, (hl)
    5145/    1A65 :                     
    5146/    1A65 : CD 7B 26            	call	GETLIN
    5147/    1A68 :                     
    5148/    1A68 : E5                  	push	hl
    5149/    1A69 : 21 39 FF            	ld	hl, ky_flg
    5150/    1A6C : CB 8E               	res	NO_LF>>1, (hl)
    5151/    1A6E : E1                  	pop	hl
    5152/    1A6F :                     
    5153/    1A6F : CD D5 25            	call	recorrect
    5154/    1A72 : 7E                  	ld	a, (hl)
    5155/    1A73 : FE 1B               	cp	ESC
    5156/    1A75 : 28 0D               	jr	z, ext_asm
    5157/    1A77 : FE 2E               	cp	'.'
    5158/    1A79 : 28 09               	jr	z, ext_asm
    5159/    1A7B : B7                  	or	a		; NULL?
    5160/    1A7C : C2 13 1B            	jp	nz, cont_asm
    5161/    1A7F : CD 90 1A            	call	lf_out
    5162/    1A82 : 18 C3               	jr	next_asm
    5163/    1A84 :                     
    5164/    1A84 :                     ext_asm:
    5165/    1A84 : CD 90 1A            	call	lf_out
    5166/    1A87 : 2A 1D FF            	ld	hl, (tasm_adr)
    5167/    1A8A : 22 1B FF            	ld	(asm_adr), hl	; save new address
    5168/    1A8D : C3 CB 01            	jp	WSTART		; exit assemble mode
    5169/    1A90 :                     
    5170/    1A90 :                     lf_out:
    5171/    1A90 : 3E 0A               	ld	a, LF
    5172/    1A92 : C3 8B 2E            	jp	CONOUT
    5173/    1A95 :                     
    5174/    1A95 :                     asm_err:
    5175/    1A95 : 21 95 13            	ld	hl, com_errm
    5176/    1A98 :                     asm_err1:
    5177/    1A98 : CD 90 1A            	call	lf_out
    5178/    1A9B : CD 1B 26            	call	STROUT
    5179/    1A9E : 21 FF 2B            	ld	hl, ERRMSG
    5180/    1AA1 : CD 1B 26            	call	STROUT
    5181/    1AA4 : 18 A1               	jr	next_asm
    5182/    1AA6 :                     
    5183/    1AA6 :                     ;-------------------------------------------------
    5184/    1AA6 :                     ; post operation
    5185/    1AA6 :                     ;-------------------------------------------------
    5186/    1AA6 :                     cout_sp:
    5187/    1AA6 : 3A 21 FF            	ld	a, (opc_cd)
    5188/    1AA9 : FE 44               	cp	68
    5189/    1AAB : 28 37               	jr	z, skp_outm
    5190/    1AAD : FE 45               	cp	69
    5191/    1AAF : 28 38               	jr	z, dmp_db
    5192/    1AB1 : FE 46               	cp	70
    5193/    1AB3 : 28 3F               	jr	z, dmp_dw
    5194/    1AB5 :                     
    5195/    1AB5 : 3E 20               	ld	a, ' '
    5196/    1AB7 : 0E 26               	ld	c, BUFLEN-2	; clear
    5197/    1AB9 : 21 CE FF            	ld	hl, line_buf	; disassemble string buffer
    5198/    1ABC :                     cout_sp1:
    5199/    1ABC : 77                  	ld	(hl), a
    5200/    1ABD : 23                  	inc	hl
    5201/    1ABE : 0D                  	dec	c
    5202/    1ABF : 20 FB               	jr	nz, cout_sp1
    5203/    1AC1 : 3E 0D               	ld	a, CR
    5204/    1AC3 : 77                  	ld	(hl), a
    5205/    1AC4 : 23                  	inc	hl
    5206/    1AC5 : AF                  	xor	a
    5207/    1AC6 : 77                  	ld	(hl), a		; set delimitor
    5208/    1AC7 : CD 1B 26            	call	STROUT
    5209/    1ACA :                     
    5210/    1ACA : 2A 1D FF            	ld	hl, (tasm_adr)	; disassemble address
    5211/    1ACD : 11 CE FF            	ld	de, line_buf	; disassemble string buffer
    5212/    1AD0 : D5                  	push	de
    5213/    1AD1 : CD 46 09            	call	get_disasm_st
    5214/    1AD4 : E1                  	pop	hl
    5215/    1AD5 : CD 1B 26            	call	STROUT		; cousole out result inline assemble
    5216/    1AD8 :                     cout_sp2:
    5217/    1AD8 : 2A 1D FF            	ld	hl, (tasm_adr)	; disassemble address
    5218/    1ADB : CD 0B 1B            	call	setbytec
    5219/    1ADE : 22 1D FF            	ld	(tasm_adr), hl	; next address
    5220/    1AE1 : C3 47 1A            	jp	next_asm
    5221/    1AE4 :                     
    5222/    1AE4 :                     skp_outm:
    5223/    1AE4 : CD 90 1A            	call	lf_out
    5224/    1AE7 : 18 EF               	jr	cout_sp2
    5225/    1AE9 :                     
    5226/    1AE9 :                     dmp_db:
    5227/    1AE9 : CD 01 1B            	call	setdsadr
    5228/    1AEC : CD 0B 1B            	call	setbytec
    5229/    1AEF : 22 D2 FE            	ld	(deaddr), hl
    5230/    1AF2 : 18 08               	jr	prtdmp
    5231/    1AF4 :                     
    5232/    1AF4 :                     dmp_dw:
    5233/    1AF4 : CD 01 1B            	call	setdsadr
    5234/    1AF7 : 23                  	inc	hl
    5235/    1AF8 : 23                  	inc	hl
    5236/    1AF9 : 22 D2 FE            	ld	(deaddr), hl
    5237/    1AFC :                     prtdmp:	
    5238/    1AFC : CD 0A 08            	call	dpm
    5239/    1AFF : 18 D7               	jr	cout_sp2
    5240/    1B01 :                     
    5241/    1B01 :                     setdsadr:
    5242/    1B01 : CD 90 1A            	call	lf_out
    5243/    1B04 : 2A 1D FF            	ld	hl, (tasm_adr)
    5244/    1B07 : 22 D0 FE            	ld	(dsaddr), hl
    5245/    1B0A : C9                  	ret
    5246/    1B0B :                     
    5247/    1B0B :                     setbytec:
    5248/    1B0B : 3A 20 FF            	ld	a, (byte_count)
    5249/    1B0E : 4F                  	ld	c, a
    5250/    1B0F : AF                  	xor	a
    5251/    1B10 : 47                  	ld	b, a
    5252/    1B11 : 09                  	add	hl, bc
    5253/    1B12 : C9                  	ret
    5254/    1B13 :                     
    5255/    1B13 :                     ;----------------------------
    5256/    1B13 :                     ; analize input data
    5257/    1B13 :                     ;----------------------------
    5258/    1B13 :                     cont_asm:
    5259/    1B13 : CD 62 24            	call	analize_input
    5260/    1B16 : DA 95 1A            	jp	c, asm_err		;error
    5261/    1B19 :                     
    5262/    1B19 :                     ; make machine code
    5263/    1B19 :                     
    5264/    1B19 : 3A 1F FF            	ld	a, (element_cnt)
    5265/    1B1C : FE 01               	cp	1
    5266/    1B1E : CA EE 20            	jp	z, mk_e1
    5267/    1B21 : FE 02               	cp	2
    5268/    1B23 : CA 78 21            	jp	z, mk_e2
    5269/    1B26 :                     
    5270/    1B26 :                     ;333333333333333333333333333333333333333
    5271/    1B26 :                     ;
    5272/    1B26 :                     ; make machine code,
    5273/    1B26 :                     ; element_cnt = 3 (ex. LD SP, HL)
    5274/    1B26 :                     ;
    5275/    1B26 :                     ;333333333333333333333333333333333333333
    5276/    1B26 :                     
    5277/    1B26 : =0DH                 el3_um	equ	el3_stbe - el3_stb
    5278/    1B26 :                     
    5279/    1B26 : 3A 21 FF            mk_e3:	ld	a, (opc_cd)
    5280/    1B29 : 01 0D 00            	ld	bc, el3_um
    5281/    1B2C : 21 3E 1B            	ld	hl, el3_stb
    5282/    1B2F : ED B1               	cpir
    5283/    1B31 : C2 95 1A            	jp	nz, asm_err
    5284/    1B34 :                     	
    5285/    1B34 : 21 4B 1B            	ld	hl, el3_jtb
    5286/    1B37 :                     
    5287/    1B37 :                     jp_each:
    5288/    1B37 : 09                  	add	hl, bc		; offset : BC = BC * 2
    5289/    1B38 : 09                  	add	hl, bc		; HL = ent_el2 + offset
    5290/    1B39 : 4E                  	ld	c, (hl)
    5291/    1B3A : 23                  	inc	hl
    5292/    1B3B : 46                  	ld	b, (hl)
    5293/    1B3C : C5                  	push	bc
    5294/    1B3D : C9                  	ret
    5295/    1B3E :                     
    5296/    1B3E : 01                  el3_stb:	db	1			; normal, DD, FD, ED
    5297/    1B3F : 06 15               		db	6, 21 			; normal, DD, FD
    5298/    1B41 : 16 19               		db	22, 25			; normal, DD, FD, ED
    5299/    1B43 : 2B                  		db	43 			; normal
    5300/    1B44 : 37 3C               		db	55, 60			; normal, ED
    5301/    1B46 : 2A 2D               		db	42, 45			; normal
    5302/    1B48 : 22 24 23            		db	34, 36, 35 		; CB, DD, FD
    5303/    1B4B :                     el3_stbe:	
    5304/    1B4B :                     
    5305/    1B4B : 75 1B               el3_jtb:	dw	el3_35
    5306/    1B4D : 93 1B               		dw	el3_36
    5307/    1B4F : B1 1B               		dw	el3_34
    5308/    1B51 : 32 1C               		dw	el3_45
    5309/    1B53 : 3F 1C               		dw	el3_42
    5310/    1B55 : 5F 1C               		dw	el3_60
    5311/    1B57 : 68 1C               		dw	el3_55
    5312/    1B59 : A8 1C               		dw	el3_43
    5313/    1B5B : DD 1C               		dw	el3_25
    5314/    1B5D : E5 1C               		dw	el3_22
    5315/    1B5F : 5E 1D               		dw	el3_21
    5316/    1B61 : E0 1D               		dw	el3_6
    5317/    1B63 : 6A 1E               		dw	el3_1
    5318/    1B65 :                     
    5319/    1B65 :                     
    5320/    1B65 :                     ;
    5321/    1B65 :                     ; SET section
    5322/    1B65 :                     ;
    5323/    1B65 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5324/    1B65 :                     
    5325/    1B65 : C0 C8 D0 D8 E0 E8   set_mcb:	db	0C0h, 0C8h, 0D0h, 0D8h, 0E0h, 0E8h, 0F0h, 0F8h
             1B6B : F0 F8             
    5326/    1B6D : C6 CE D6 DE E6 EE   set_xyt:	db	0C6h, 0CEh, 0D6h, 0DEh, 0E6h, 0EEh, 0F6h, 0FEh
             1B73 : F6 FE             
    5327/    1B75 :                     
    5328/    1B75 :                     el3_35: ; SET  ( CB, DD, FD )
    5329/    1B75 :                     
    5330/    1B75 : 21 65 1B            	ld	hl, set_mcb
    5331/    1B78 : 22 2C FF            	ld	(cb_mcw), hl
    5332/    1B7B : 21 6D 1B            	ld	hl, set_xyt
    5333/    1B7E : 22 2E FF            	ld	(cb_xyw), hl
    5334/    1B81 : 18 3A               	jr	bit_res_set
    5335/    1B83 :                     
    5336/    1B83 :                     ;
    5337/    1B83 :                     ; RES section
    5338/    1B83 :                     ;
    5339/    1B83 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5340/    1B83 :                     
    5341/    1B83 : 80 88 90 98 A0 A8   res_mcb:	db	80h, 88h, 90h, 98h, 0A0h, 0A8h, 0B0h, 0B8h
             1B89 : B0 B8             
    5342/    1B8B : 86 8E 96 9E A6 AE   res_xyt:	db	86h, 8Eh, 96h, 9Eh, 0A6h, 0AEh, 0B6h, 0BEh
             1B91 : B6 BE             
    5343/    1B93 :                     
    5344/    1B93 :                     el3_36: ; RES  ( CB, DD, FD )
    5345/    1B93 :                     
    5346/    1B93 : 21 83 1B            	ld	hl, res_mcb
    5347/    1B96 : 22 2C FF            	ld	(cb_mcw), hl
    5348/    1B99 : 21 8B 1B            	ld	hl, res_xyt
    5349/    1B9C : 22 2E FF            	ld	(cb_xyw), hl
    5350/    1B9F : 18 1C               	jr	bit_res_set
    5351/    1BA1 :                     
    5352/    1BA1 :                     ;
    5353/    1BA1 :                     ; BIT section
    5354/    1BA1 :                     ;
    5355/    1BA1 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5356/    1BA1 :                     
    5357/    1BA1 : =8H                  bit_mcbn	equ	bit_mcbe - bit_mcb
    5358/    1BA1 : 40 48 50 58 60 68   bit_mcb:	db	40h, 48h, 50h, 58h, 60h, 68h, 70h, 78h
             1BA7 : 70 78             
    5359/    1BA9 :                     bit_mcbe:
    5360/    1BA9 : 46 4E 56 5E 66 6E   bit_xyt:	db	46h, 4Eh, 56h, 5Eh, 66h, 6Eh, 76h, 7Eh
             1BAF : 76 7E             
    5361/    1BB1 :                     
    5362/    1BB1 :                     
    5363/    1BB1 :                     el3_34: ; BIT  ( CB, DD, FD )
    5364/    1BB1 :                     
    5365/    1BB1 : 21 A1 1B            	ld	hl, bit_mcb
    5366/    1BB4 : 22 2C FF            	ld	(cb_mcw), hl
    5367/    1BB7 : 21 A9 1B            	ld	hl, bit_xyt
    5368/    1BBA : 22 2E FF            	ld	(cb_xyw), hl
    5369/    1BBD :                     
    5370/    1BBD :                     bit_res_set:
    5371/    1BBD : 3A 22 FF            	ld	a, (opr1_cd)
    5372/    1BC0 : FE 19               	cp	25
    5373/    1BC2 : C2 95 1A            	jp	nz, asm_err
    5374/    1BC5 :                     
    5375/    1BC5 : 2A 24 FF            	ld	hl, (opr_num25)
    5376/    1BC8 : 7C                  	ld	a, h
    5377/    1BC9 : B7                  	or	a
    5378/    1BCA : C2 95 1A            	jp	nz, asm_err
    5379/    1BCD : 7D                  	ld	a, l
    5380/    1BCE : FE 08               	cp	8
    5381/    1BD0 : D2 95 1A            	jp	nc, asm_err
    5382/    1BD3 :                     
    5383/    1BD3 :                     	; HL : 0 - 7
    5384/    1BD3 :                     
    5385/    1BD3 : 3A 23 FF            	ld	a, (opr2_cd)
    5386/    1BD6 : FE 21               	cp	33
    5387/    1BD8 : 28 2C               	jr	z, bit_ixp
    5388/    1BDA : FE 24               	cp	36
    5389/    1BDC : 28 3A               	jr	z, bit_ixm
    5390/    1BDE : FE 22               	cp	34
    5391/    1BE0 : 28 3B               	jr	z, bit_iyp
    5392/    1BE2 : FE 25               	cp	37
    5393/    1BE4 : 28 3F               	jr	z, bit_iym
    5394/    1BE6 :                     ;
    5395/    1BE6 :                     ; CB : bit n, [r | (hl)]
    5396/    1BE6 :                     ;
    5397/    1BE6 : ED 4B 2C FF         	ld	bc, (cb_mcw)
    5398/    1BEA : 09                  	add	hl, bc
    5399/    1BEB : 56                  	ld	d, (hl)		; get MC base
    5400/    1BEC :                     
    5401/    1BEC : 3A 23 FF            	ld	a, (opr2_cd)
    5402/    1BEF : 21 3D 1E            	ld	hl, r_hl_nn
    5403/    1BF2 : 01 08 00            	ld	bc, bit_mcbn
    5404/    1BF5 : ED B1               	cpir
    5405/    1BF7 : C2 95 1A            	jp	nz, asm_err
    5406/    1BFA :                     
    5407/    1BFA : 79                  	ld	a, c
    5408/    1BFB : FE 07               	cp	7
    5409/    1BFD : 28 03               	jr	z, el3_341
    5410/    1BFF :                     
    5411/    1BFF : 3E 06               	ld	a, 6
    5412/    1C01 : 91                  	sub	c
    5413/    1C02 :                     el3_341:
    5414/    1C02 : 82                  	add	a, d		; make 2nd MC
    5415/    1C03 : C3 0E 24            	jp	el2_130
    5416/    1C06 :                     
    5417/    1C06 :                     	; HL : 0 - 7
    5418/    1C06 :                     
    5419/    1C06 :                     bit_ixp:
    5420/    1C06 : 3A 2B FF            	ld	a, (opr_num33)
    5421/    1C09 :                     bit_ixp1:
    5422/    1C09 : 5F                  	ld	e, a
    5423/    1C0A : 16 DD               	ld	d, 0DDh
    5424/    1C0C :                     
    5425/    1C0C :                     ; adjust I/F
    5426/    1C0C :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    5427/    1C0C :                     
    5428/    1C0C :                     el3_342:
    5429/    1C0C : ED 4B 2E FF         	ld	bc, (cb_xyw)
    5430/    1C10 : 09                  	add	hl, bc
    5431/    1C11 : 4B                  	ld	c, e		; adjust I/F
    5432/    1C12 : 5E                  	ld	e, (hl)		; 4th MC
    5433/    1C13 : 3E CB               	ld	a, 0CBh
    5434/    1C15 : C3 31 24            	jp	mc_end41	; save 4byte MC
    5435/    1C18 :                     
    5436/    1C18 :                     bit_ixm:
    5437/    1C18 : 3A 2A FF            	ld	a, (opr_num36)
    5438/    1C1B : 18 EC               	jr	bit_ixp1
    5439/    1C1D :                     
    5440/    1C1D :                     
    5441/    1C1D :                     bit_iyp:
    5442/    1C1D : 3A 29 FF            	ld	a, (opr_num34)
    5443/    1C20 :                     bit_iyp1:
    5444/    1C20 : 5F                  	ld	e, a
    5445/    1C21 : 16 FD               	ld	d, 0FDh
    5446/    1C23 : 18 E7               	jr	el3_342
    5447/    1C25 :                     
    5448/    1C25 :                     bit_iym:
    5449/    1C25 : 3A 28 FF            	ld	a, (opr_num37)
    5450/    1C28 : 18 F6               	jr	bit_iyp1
    5451/    1C2A :                     
    5452/    1C2A :                     ;
    5453/    1C2A :                     ; CALL section
    5454/    1C2A :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5455/    1C2A :                     ;
    5456/    1C2A : EC E4 F4 D4 C4 FC   call_mc1t:	db	0ECh, 0E4h, 0F4h, 0D4h, 0C4h, 0FCh, 0CCh, 0DCh
             1C30 : CC DC             
    5457/    1C32 :                     
    5458/    1C32 :                     el3_45: ; CALL ( normal )
    5459/    1C32 :                     
    5460/    1C32 : 11 2A 1C            	ld	de, call_mc1t
    5461/    1C35 : 18 0B               	jr	el3_421
    5462/    1C37 :                     ;
    5463/    1C37 :                     ; JP section
    5464/    1C37 :                     ; ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
    5465/    1C37 :                     ;
    5466/    1C37 : =8H                  jp_mc1tm	equ	jp_mc1te - jp_mc1t
    5467/    1C37 : EA E2 F2 D2 C2 FA   jp_mc1t:	db	0EAh, 0E2h, 0F2h, 0D2h, 0C2h, 0FAh, 0CAh, 0DAh
             1C3D : CA DA             
    5468/    1C3F :                     jp_mc1te:
    5469/    1C3F :                     
    5470/    1C3F :                     el3_42: ; JP   ( normal )
    5471/    1C3F :                     
    5472/    1C3F : 11 37 1C            	ld	de, jp_mc1t
    5473/    1C42 :                     
    5474/    1C42 :                     el3_421:
    5475/    1C42 : 21 7F 22            	ld	hl, ret_no
    5476/    1C45 : 01 08 00            	ld	bc, jp_mc1tm
    5477/    1C48 : 3A 22 FF            	ld	a, (opr1_cd)
    5478/    1C4B : ED B1               	cpir
    5479/    1C4D : C2 95 1A            	jp	nz, asm_err
    5480/    1C50 :                     
    5481/    1C50 : 3A 23 FF            	ld	a, (opr2_cd)
    5482/    1C53 : FE 19               	cp	25
    5483/    1C55 : C2 95 1A            	jp	nz, asm_err
    5484/    1C58 :                     
    5485/    1C58 : 62                  	ld	h, d		; DE : MC target table
    5486/    1C59 : 6B                  	ld	l, e		; DE : MC target table
    5487/    1C5A : 09                  	add	hl, bc
    5488/    1C5B : 7E                  	ld	a, (hl)		; get 1st MC
    5489/    1C5C : C3 02 22            	jp	el2_451
    5490/    1C5F :                     
    5491/    1C5F :                     ;
    5492/    1C5F :                     ; OUT section
    5493/    1C5F :                     ;
    5494/    1C5F : =6H                  in_selm		equ	ld_e2_tbl1 - in_selt
    5495/    1C5F :                     
    5496/    1C5F :                     el3_60: ; OUT  ( normal, ED )
    5497/    1C5F :                     
    5498/    1C5F : 11 D3 41            	ld	de, 41D3H
    5499/    1C62 : ED 4B 22 FF         	ld	bc, (opr1_cd)	; c = (opr1_cd), b = (opr2_cd)
    5500/    1C66 : 18 0B               	jr	el3_550
    5501/    1C68 :                     
    5502/    1C68 :                     ;
    5503/    1C68 :                     ; IN section
    5504/    1C68 :                     ;
    5505/    1C68 :                     el3_55: ; IN   ( normal, ED )
    5506/    1C68 :                     
    5507/    1C68 : 11 DB 40            	ld	de, 40DBH
    5508/    1C6B : 3A 22 FF            	ld	a, (opr1_cd)
    5509/    1C6E : 47                  	ld	b, a
    5510/    1C6F : 3A 23 FF            	ld	a, (opr2_cd)
    5511/    1C72 : 4F                  	ld	c, a
    5512/    1C73 :                     
    5513/    1C73 :                     el3_550:
    5514/    1C73 : 79                  	ld	a, c
    5515/    1C74 : FE 23               	cp	35
    5516/    1C76 : 28 1F               	jr	z, in_a_nn
    5517/    1C78 : FE 1F               	cp	31
    5518/    1C7A : C2 95 1A            	jp	nz, asm_err
    5519/    1C7D :                     
    5520/    1C7D : 78                  	ld	a, b
    5521/    1C7E : FE 01               	cp	1
    5522/    1C80 : 28 0F               	jr	z, el3_551	; passing search
    5523/    1C82 :                     	
    5524/    1C82 : 21 27 1E            	ld	hl, in_selt
    5525/    1C85 : 01 06 00            	ld	bc, in_selm
    5526/    1C88 : CD CC 1C            	call	mkmc_sh
    5527/    1C8B : DA 95 1A            	jp	c, asm_err
    5528/    1C8E : 7A                  	ld	a, d
    5529/    1C8F : 18 03               	jr	el3_552
    5530/    1C91 :                     	
    5531/    1C91 :                     el3_551:
    5532/    1C91 : 7A                  	ld	a, d
    5533/    1C92 : C6 38               	add	a, 38h		; get 2nd MC
    5534/    1C94 :                     el3_552:
    5535/    1C94 : C3 5C 24            	jp	el2_5411
    5536/    1C97 :                     
    5537/    1C97 :                     in_a_nn:
    5538/    1C97 : 2A 26 FF            	ld	hl, (opr_num35)
    5539/    1C9A : 7C                  	ld	a, h
    5540/    1C9B : B7                  	or	a
    5541/    1C9C : C2 95 1A            	jp	nz, asm_err
    5542/    1C9F : 7D                  	ld	a, l
    5543/    1CA0 : F5                  	push	af		; adjust I/F
    5544/    1CA1 : 7B                  	ld	a, e		; 1st MC
    5545/    1CA2 : 18 25               	jr	el3_431		; save 2byte MC (el2_441)
    5546/    1CA4 :                     	
    5547/    1CA4 :                     ;
    5548/    1CA4 :                     ; JR section
    5549/    1CA4 :                     ;
    5550/    1CA4 : 14 12 15 06         jr_cct:	db	20, 18, 21, 6
    5551/    1CA8 :                     
    5552/    1CA8 :                     el3_43: ; JR   ( normal )
    5553/    1CA8 :                     
    5554/    1CA8 : 21 A4 1C            	ld	hl, jr_cct
    5555/    1CAB : 01 04 00            	ld	bc, 4
    5556/    1CAE : 16 20               	ld	d, 20h		; base MC
    5557/    1CB0 : 3A 22 FF            	ld	a, (opr1_cd)
    5558/    1CB3 : CD CC 1C            	call	mkmc_sh
    5559/    1CB6 : DA 95 1A            	jp	c, asm_err
    5560/    1CB9 :                     
    5561/    1CB9 : 3A 23 FF            	ld	a, (opr2_cd)
    5562/    1CBC : FE 19               	cp	25		; number?
    5563/    1CBE : C2 95 1A            	jp	nz, asm_err
    5564/    1CC1 :                     
    5565/    1CC1 : CD AB 25            	call	calc_reladr
    5566/    1CC4 : DA 95 1A            	jp	c, asm_err
    5567/    1CC7 :                     	
    5568/    1CC7 : F5                  	push	af		; adjust I/F
    5569/    1CC8 : 7A                  	ld	a, d		; adjust I/F
    5570/    1CC9 :                     el3_431:
    5571/    1CC9 : C3 24 22            	jp	el2_441		; save 2byte MC
    5572/    1CCC :                     ;
    5573/    1CCC :                     ; hl : search table
    5574/    1CCC :                     ; bc : loop counter
    5575/    1CCC :                     ; d  : base MC 
    5576/    1CCC :                     ;
    5577/    1CCC :                     ; output:
    5578/    1CCC :                     ;	  CF=1 : error
    5579/    1CCC :                     ;	  CF=0 : D = MC
    5580/    1CCC :                     mkmc_sh:
    5581/    1CCC : ED A1               	cpi
    5582/    1CCE : 28 0C               	jr	z, mkmc_shed
    5583/    1CD0 :                     	
    5584/    1CD0 : 5F                  	ld	e, a	; save a
    5585/    1CD1 : 7A                  	ld	a, d
    5586/    1CD2 : C6 08               	add	a, 8
    5587/    1CD4 : 57                  	ld	d, a
    5588/    1CD5 :                     
    5589/    1CD5 : 79                  	ld	a, c
    5590/    1CD6 : B0                  	or	b
    5591/    1CD7 : 7B                  	ld	a, e	; restore a
    5592/    1CD8 : 20 F2               	jr	nz, mkmc_sh
    5593/    1CDA : 37                  	scf
    5594/    1CDB : C9                  	ret
    5595/    1CDC :                     
    5596/    1CDC :                     mkmc_shed:
    5597/    1CDC : C9                  	ret
    5598/    1CDD :                     
    5599/    1CDD :                     ;
    5600/    1CDD :                     ; ADC section
    5601/    1CDD :                     ;
    5602/    1CDD :                     
    5603/    1CDD :                     el3_25: ; SBC  ( normal, DD, FD, ED )
    5604/    1CDD :                     
    5605/    1CDD : 11 9F 42            	ld	de, 429fh
    5606/    1CE0 : 3E DE               	ld	a, 0DEh
    5607/    1CE2 : 08                  	ex	af, af'
    5608/    1CE3 : 18 06               	jr	el3_221
    5609/    1CE5 :                     ;
    5610/    1CE5 :                     ; ADC section
    5611/    1CE5 :                     ;
    5612/    1CE5 :                     ; defined other section
    5613/    1CE5 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    5614/    1CE5 :                     ; ld_rr_:	db	25
    5615/    1CE5 :                     ; ex_sr_:	db	33, 36, 34, 37
    5616/    1CE5 :                     ; r_hl_nne:
    5617/    1CE5 :                     
    5618/    1CE5 : =9H                  adc_MC	equ	ex_sr_ - r_hl_nn
    5619/    1CE5 : =4H                  adc_3MC	equ	r_hl_nne - ex_sr_
    5620/    1CE5 :                     
    5621/    1CE5 :                     el3_22: ; ADC  ( normal, DD, FD, ED )
    5622/    1CE5 :                     
    5623/    1CE5 : 11 8F 4A            	ld	de, 4a8fh
    5624/    1CE8 : 3E CE               	ld	a, 0CEh
    5625/    1CEA : 08                  	ex	af, af'
    5626/    1CEB :                     
    5627/    1CEB :                     el3_221:
    5628/    1CEB : 3A 22 FF            	ld	a, (opr1_cd)
    5629/    1CEE : FE 01               	cp	1		; A?
    5630/    1CF0 : 28 2A               	jr	z, adc_a_
    5631/    1CF2 : FE 0B               	cp	11		; HL?
    5632/    1CF4 : C2 95 1A            	jp	nz, asm_err
    5633/    1CF7 :                     
    5634/    1CF7 :                     ; adc hl,[ BC | DE | HL | SP ]
    5635/    1CF7 :                     
    5636/    1CF7 : 3A 23 FF            	ld	a, (opr2_cd)
    5637/    1CFA : FE 05               	cp	5
    5638/    1CFC : 28 19               	jr	z, adc_hl_bc
    5639/    1CFE : FE 08               	cp	8
    5640/    1D00 : 28 11               	jr	z, adc_hl_de
    5641/    1D02 : FE 0B               	cp	11
    5642/    1D04 : 28 09               	jr	z, adc_hl_hl
    5643/    1D06 : FE 10               	cp	16
    5644/    1D08 : C2 95 1A            	jp	nz, asm_err
    5645/    1D0B :                     
    5646/    1D0B :                     adc_hl_sp:
    5647/    1D0B : 3E 30               	ld	a, 30h
    5648/    1D0D : 18 09               	jr	adc_hl_
    5649/    1D0F :                     adc_hl_hl:
    5650/    1D0F : 3E 20               	ld	a, 20h
    5651/    1D11 : 18 05               	jr	adc_hl_
    5652/    1D13 :                     adc_hl_de:
    5653/    1D13 : 3E 10               	ld	a, 10h
    5654/    1D15 : 18 01               	jr	adc_hl_
    5655/    1D17 :                     adc_hl_bc:
    5656/    1D17 : AF                  	xor	a
    5657/    1D18 :                     adc_hl_:
    5658/    1D18 : 82                  	add	a, d		; make 2nd MC
    5659/    1D19 :                     
    5660/    1D19 : C3 5C 24            	jp	el2_5411
    5661/    1D1C :                     
    5662/    1D1C :                     adc_a_:
    5663/    1D1C : 3A 23 FF            	ld	a, (opr2_cd)
    5664/    1D1F : 21 3D 1E            	ld	hl, r_hl_nn
    5665/    1D22 : 01 09 00            	ld	bc, adc_MC
    5666/    1D25 : ED B1               	cpir
    5667/    1D27 : 20 18               	jr	nz, chk_adc3mc
    5668/    1D29 :                     
    5669/    1D29 : 79                  	ld	a, c
    5670/    1D2A : FE 08               	cp	8
    5671/    1D2C : 28 10               	jr	z, adc_a_a
    5672/    1D2E : B7                  	or	a
    5673/    1D2F : 28 05               	jr	z, adc_a_n
    5674/    1D31 : 7B                  	ld	a, e
    5675/    1D32 : 91                  	sub	c		; make MC 1
    5676/    1D33 :                     adc_a_x:
    5677/    1D33 : C3 01 21            	jp	st_mc11
    5678/    1D36 :                     	
    5679/    1D36 :                     adc_a_n:
    5680/    1D36 : 2A 24 FF            	ld	hl, (opr_num25)
    5681/    1D39 : 08                  	ex	af, af'		; get 1st MC
    5682/    1D3A : 57                  	ld	d, a		; adjust I/F
    5683/    1D3B : C3 FA 1E            	jp	ld_r251
    5684/    1D3E :                     
    5685/    1D3E :                     adc_a_a:
    5686/    1D3E :                     ;	inc	e
    5687/    1D3E : 7B                  	ld	a, e
    5688/    1D3F : 18 F2               	jr	adc_a_x
    5689/    1D41 :                     
    5690/    1D41 :                     chk_adc3mc:
    5691/    1D41 : 21 46 1E            	ld	hl, ex_sr_
    5692/    1D44 : 01 04 00            	ld	bc, adc_3MC
    5693/    1D47 : ED B1               	cpir
    5694/    1D49 : C2 95 1A            	jp	nz, asm_err
    5695/    1D4C :                     
    5696/    1D4C : 21 28 FF            	ld	hl, opr_num37
    5697/    1D4F : 09                  	add	hl, bc
    5698/    1D50 : 56                  	ld	d, (hl)		; 3rd MC
    5699/    1D51 :                     
    5700/    1D51 : 79                  	ld	a, c
    5701/    1D52 : 0E FD               	ld	c, 0FDH		; 1st MC
    5702/    1D54 : FE 02               	cp	2
    5703/    1D56 : 38 02               	jr	c, adc_fd
    5704/    1D58 :                     
    5705/    1D58 : 0E DD               	ld	c, 0DDH		; 1st MC
    5706/    1D5A :                     
    5707/    1D5A :                     adc_fd:
    5708/    1D5A : 1D                  	dec	e		; get 2nd MC
    5709/    1D5B : C3 3D 1F            	jp	ld_bc_n42	; save 3MC
    5710/    1D5E :                     ;
    5711/    1D5E :                     ; ADD section
    5712/    1D5E :                     ;
    5713/    1D5E :                     el3_21: ; ADD  ( normal, DD, FD )
    5714/    1D5E :                     
    5715/    1D5E : 11 87 09            	ld	de, 0987h
    5716/    1D61 : 3E C6               	ld	a, 0C6h
    5717/    1D63 : 08                  	ex	af, af'
    5718/    1D64 :                     
    5719/    1D64 : 3A 23 FF            	ld	a, (opr2_cd)
    5720/    1D67 : 47                  	ld	b, a
    5721/    1D68 : 3A 22 FF            	ld	a, (opr1_cd)
    5722/    1D6B : FE 01               	cp	1
    5723/    1D6D : 28 AD               	jr	z, adc_a_
    5724/    1D6F : FE 0B               	cp	11
    5725/    1D71 : 28 47               	jr	z, add_hl_
    5726/    1D73 : FE 0E               	cp	14
    5727/    1D75 : 28 09               	jr	z, add_ix_
    5728/    1D77 : FE 0F               	cp	15
    5729/    1D79 : C2 95 1A            	jp	nz, asm_err
    5730/    1D7C :                     ;;
    5731/    1D7C :                     ;;
    5732/    1D7C :                     add_iy_:
    5733/    1D7C : 0E FD               	ld	c, 0FDh
    5734/    1D7E : 18 02               	jr	el3_211
    5735/    1D80 :                     ;;
    5736/    1D80 :                     ;;
    5737/    1D80 :                     add_ix_:
    5738/    1D80 : 0E DD               	ld	c, 0DDh
    5739/    1D82 :                     el3_211:
    5740/    1D82 : 78                  	ld	a, b
    5741/    1D83 : FE 05               	cp	5
    5742/    1D85 : 28 19               	jr	z, add_xy_bc
    5743/    1D87 : FE 08               	cp	8
    5744/    1D89 : 28 19               	jr	z, add_xy_de
    5745/    1D8B : FE 0E               	cp	14
    5746/    1D8D : 28 19               	jr	z, add_ix_ix
    5747/    1D8F : FE 0F               	cp	15
    5748/    1D91 : CA B2 1D            	jp	z, add_iy_iy
    5749/    1D94 : FE 10               	cp	16
    5750/    1D96 : C2 95 1A            	jp	nz, asm_err
    5751/    1D99 :                     add_xy_sp:
    5752/    1D99 : 3E 39               	ld	a, 39h
    5753/    1D9B :                     el3_212:
    5754/    1D9B : F5                  	push	af		; adjust I/F
    5755/    1D9C : 79                  	ld	a, c
    5756/    1D9D : C3 24 22            	jp	el2_441
    5757/    1DA0 :                     
    5758/    1DA0 :                     add_xy_bc:
    5759/    1DA0 : 3E 09               	ld	a, 9h
    5760/    1DA2 : 18 F7               	jr	el3_212
    5761/    1DA4 :                     add_xy_de:
    5762/    1DA4 : 3E 19               	ld	a, 19h
    5763/    1DA6 : 18 F3               	jr	el3_212
    5764/    1DA8 :                     add_ix_ix:
    5765/    1DA8 : 79                  	ld	a, c
    5766/    1DA9 : FE DD               	cp	0ddh
    5767/    1DAB : C2 95 1A            	jp	nz, asm_err
    5768/    1DAE :                     add_xy_xy:
    5769/    1DAE : 3E 29               	ld	a, 29h
    5770/    1DB0 : 18 E9               	jr	el3_212
    5771/    1DB2 :                     add_iy_iy:
    5772/    1DB2 : 79                  	ld	a, c
    5773/    1DB3 : FE FD               	cp	0fdh
    5774/    1DB5 : C2 95 1A            	jp	nz, asm_err
    5775/    1DB8 : 18 F4               	jr	add_xy_xy
    5776/    1DBA :                     
    5777/    1DBA :                     ;;
    5778/    1DBA :                     ;;
    5779/    1DBA :                     add_hl_:
    5780/    1DBA : 78                  	ld	a, b
    5781/    1DBB : FE 05               	cp	5
    5782/    1DBD : 28 12               	jr	z, add_hl_bc
    5783/    1DBF : FE 08               	cp	8
    5784/    1DC1 : 28 13               	jr	z, add_hl_de
    5785/    1DC3 : FE 0B               	cp	11
    5786/    1DC5 : 28 14               	jr	z, add_hl_hl
    5787/    1DC7 : FE 10               	cp	16
    5788/    1DC9 : C2 95 1A            	jp	nz, asm_err
    5789/    1DCC :                     add_hl_sp:
    5790/    1DCC : 3E 39               	ld	a, 39h
    5791/    1DCE : C3 33 1D            	jp	adc_a_x
    5792/    1DD1 :                     add_hl_bc:
    5793/    1DD1 : 3E 09               	ld	a, 09h
    5794/    1DD3 : C3 33 1D            	jp	adc_a_x
    5795/    1DD6 :                     add_hl_de:
    5796/    1DD6 : 3E 19               	ld	a, 19h
    5797/    1DD8 : C3 33 1D            	jp	adc_a_x
    5798/    1DDB :                     add_hl_hl:
    5799/    1DDB : 3E 29               	ld	a, 29h
    5800/    1DDD : C3 33 1D            	jp	adc_a_x
    5801/    1DE0 :                     
    5802/    1DE0 :                     ;
    5803/    1DE0 :                     ; EX section
    5804/    1DE0 :                     ;
    5805/    1DE0 :                     
    5806/    1DE0 :                     el3_6:  ; EX   ( normal, DD, FD )
    5807/    1DE0 :                     
    5808/    1DE0 : 3A 23 FF            	ld	a, (opr2_cd)
    5809/    1DE3 : 47                  	ld	b, a
    5810/    1DE4 : 3A 22 FF            	ld	a, (opr1_cd)
    5811/    1DE7 : FE 02               	cp	2
    5812/    1DE9 : 28 26               	jr	z, ex_af_
    5813/    1DEB : FE 08               	cp	8
    5814/    1DED : 28 2C               	jr	z, ex_de_
    5815/    1DEF : FE 20               	cp	32
    5816/    1DF1 : C2 95 1A            	jp	nz, asm_err
    5817/    1DF4 :                     
    5818/    1DF4 :                     ; ex (sp),
    5819/    1DF4 : 78                  	ld	a, b
    5820/    1DF5 : 1E E3               	ld	e, 0E3h
    5821/    1DF7 :                     
    5822/    1DF7 : FE 0B               	cp	11		; hl
    5823/    1DF9 : 28 13               	jr	z, ex_sp_hl
    5824/    1DFB : FE 0E               	cp	14
    5825/    1DFD : 16 DD               	ld	d, 0ddh
    5826/    1DFF : 28 07               	jr	z, ex_sp_ix
    5827/    1E01 : FE 0F               	cp	15
    5828/    1E03 : C2 95 1A            	jp	nz, asm_err
    5829/    1E06 : 16 FD               	ld	d, 0fdh
    5830/    1E08 :                     ex_sp_ix:
    5831/    1E08 : 7B                  	ld	a, e
    5832/    1E09 : F5                  	push	af		; adjust I/F
    5833/    1E0A : 7A                  	ld	a, d
    5834/    1E0B : C3 24 22            	jp	el2_441
    5835/    1E0E :                     
    5836/    1E0E :                     ex_sp_hl:
    5837/    1E0E : 7B                  	ld	a, e
    5838/    1E0F : 18 12               	jr	el3_61
    5839/    1E11 :                     
    5840/    1E11 :                     ex_af_:
    5841/    1E11 : 78                  	ld	a, b
    5842/    1E12 : FE 03               	cp	3
    5843/    1E14 : C2 95 1A            	jp	nz, asm_err
    5844/    1E17 : 3E 08               	ld	a, 08h		; 1st MC
    5845/    1E19 : 18 08               	jr	el3_61
    5846/    1E1B :                     
    5847/    1E1B :                     ex_de_:
    5848/    1E1B : 78                  	ld	a, b
    5849/    1E1C : FE 0B               	cp	11		; hl
    5850/    1E1E : C2 95 1A            	jp	nz, asm_err
    5851/    1E21 : 3E EB               	ld	a, 0ebh		; 1st MC
    5852/    1E23 :                     el3_61:
    5853/    1E23 : C3 01 21            	jp	st_mc11
    5854/    1E26 :                     
    5855/    1E26 :                     ;
    5856/    1E26 :                     ; LD section
    5857/    1E26 :                     ;
    5858/    1E26 :                     
    5859/    1E26 :                     ; ld_en1 = 7 (1, 4, 6, 7, 9, 10, 12)
    5860/    1E26 :                     ; ld_en2 = 5 (5, 8, 11, 14, 15)
    5861/    1E26 :                     ; ld_en3 = 4 (33, 36, 34, 37 )
    5862/    1E26 :                     ; ld_en4 =  7 (13, 16, 17, 26, 27, 28, 35)
    5863/    1E26 : =7H                  ld_en1		equ	ld_e2_tbl1 - ld_e2_tbl
    5864/    1E26 : =5H                  ld_en2		equ	ld_e2_tbl2 - ld_e2_tbl1
    5865/    1E26 : =4H                  ld_en3		equ	ld_e2_tbl3 - ld_e2_tbl2
    5866/    1E26 : =7H                  ld_en4		equ	ld_e2_tble - ld_e2_tbl3
    5867/    1E26 :                     
    5868/    1E26 : 01                  ld_e2_tbl:	db	1
    5869/    1E27 : 04 06 07 09 0A 0C   in_selt:	db	4, 6, 7, 9, 10, 12
    5870/    1E2D : 05 08 0B 0E 0F      ld_e2_tbl1:	db	5, 8, 11, 14, 15
    5871/    1E32 : 21 24 22 25         ld_e2_tbl2:	db	33, 36, 34, 37
    5872/    1E36 : 0D                  ld_e2_tbl3:	db	13
    5873/    1E37 : 10                  		db	16
    5874/    1E38 : 11                  		db	17
    5875/    1E39 : 1A                  		db	26
    5876/    1E3A : 1B                  		db	27
    5877/    1E3B : 1C                  		db	28
    5878/    1E3C : 23                  		db	35
    5879/    1E3D :                     ld_e2_tble:
    5880/    1E3D :                     
    5881/    1E3D : =0DH                 rhlnnxy		equ	r_hl_nne - r_hl_nn
    5882/    1E3D : =8H                  ld_rrn		equ	ld_rr_ -  r_hl_nn
    5883/    1E3D : =0AH                 ld_rxyn_sp	equ	lda_spe - ld_rr_
    5884/    1E3D :                     
    5885/    1E3D : =5H                  m_num		equ	r_hl_nne - ld_rr_	; except No.0 - 4  (IX+,IY+,IX-,IY-,nn)
    5886/    1E3D :                     
    5887/    1E3D : 01 04 06 07 09 0A   r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
             1E43 : 0C 1C             
    5888/    1E45 : 19                  ld_rr_:		db	25
    5889/    1E46 : 21 24 22 25         ex_sr_:		db	33, 36, 34, 37
    5890/    1E4A :                     r_hl_nne:
    5891/    1E4A : 1A                  lda_sp:		db	26 ; LD A (BC)
    5892/    1E4B : 1B                  		db	27 ; LD A (DE)
    5893/    1E4C : 0D                  		db	13 ; LD A I
    5894/    1E4D : 11                  		db	17 ; LD A R
    5895/    1E4E : 23                  		db	35 ; LD A (1234H)
    5896/    1E4F :                     lda_spe:
    5897/    1E4F :                     
    5898/    1E4F : 68                  ld1_base:	db	68h	; L
    5899/    1E50 : 60                  		db	60h	; H
    5900/    1E51 : 58                  		db	58h	; E
    5901/    1E52 : 50                  		db	50h	; D
    5902/    1E53 : 48                  		db	48h	; C
    5903/    1E54 : 40                  		db	40h	; B
    5904/    1E55 : 78                  		db	78h	; A
    5905/    1E56 :                     
    5906/    1E56 : B2 1E               ld_r_jt:	dw	ld_r35 ; LD A (1234H)
    5907/    1E58 : C3 1E               		dw	ld_r17 ; LD A R
    5908/    1E5A : C8 1E               		dw	ld_r13 ; LD A I
    5909/    1E5C : CC 1E               		dw	ld_r27 ; LD A (DE)
    5910/    1E5E : D1 1E               		dw	ld_r26 ; LD A (BC)
    5911/    1E60 : D6 1E               		dw	ld_r37
    5912/    1E62 : E4 1E               		dw	ld_r34
    5913/    1E64 : E9 1E               		dw	ld_r36
    5914/    1E66 : F1 1E               		dw	ld_r33
    5915/    1E68 : F6 1E               		dw	ld_r25
    5916/    1E6A :                     
    5917/    1E6A :                     ; LD XXXX, XXXX
    5918/    1E6A :                     el3_1:
    5919/    1E6A : 3A 22 FF            	ld	a, (opr1_cd)
    5920/    1E6D : 21 26 1E            	ld	hl, ld_e2_tbl
    5921/    1E70 : 01 07 00            	ld	bc, ld_en1
    5922/    1E73 : ED B1               	cpir
    5923/    1E75 : C2 08 1F            	jp	nz, el3_11
    5924/    1E78 :                     	
    5925/    1E78 : 21 4F 1E            	ld	hl, ld1_base
    5926/    1E7B : 09                  	add	hl, bc
    5927/    1E7C : 56                  	ld	d, (hl)		; met MC base code
    5928/    1E7D :                     
    5929/    1E7D : 3A 23 FF            	ld	a, (opr2_cd)
    5930/    1E80 : 21 3D 1E            	ld	hl, r_hl_nn
    5931/    1E83 : 01 08 00            	ld	bc, ld_rrn
    5932/    1E86 : ED B1               	cpir
    5933/    1E88 : 20 0C               	jr	nz, el3_125
    5934/    1E8A :                     	
    5935/    1E8A : 79                  	ld	a, c
    5936/    1E8B : FE 07               	cp	7		; A param?
    5937/    1E8D : 28 03               	jr	z, el3_12
    5938/    1E8F : 3E 06               	ld	a, 6
    5939/    1E91 : 91                  	sub	c		; make B, C, D, E, H, L, (HL) param
    5940/    1E92 :                     el3_12:
    5941/    1E92 : B2                  	or	d		; make MC
    5942/    1E93 : C3 01 21            	jp	st_mc11	
    5943/    1E96 :                     
    5944/    1E96 :                     
    5945/    1E96 :                     el3_125:
    5946/    1E96 : 21 45 1E            	ld	hl, ld_rr_
    5947/    1E99 : 01 0A 00            	ld	bc, ld_rxyn_sp
    5948/    1E9C : ED B1               	cpir
    5949/    1E9E : C2 95 1A            	jp	nz, asm_err
    5950/    1EA1 :                     
    5951/    1EA1 : 79                  	ld	a, c
    5952/    1EA2 : FE 05               	cp	5		; check LD A, special
    5953/    1EA4 : 30 06               	jr	nc, el3_126
    5954/    1EA6 :                     
    5955/    1EA6 : 7A                  	ld	a, d
    5956/    1EA7 : FE 78               	cp	78h		; LD A ?
    5957/    1EA9 : C2 95 1A            	jp	nz, asm_err	; err, if B, C, D, E, H, L, (HL)
    5958/    1EAC :                     
    5959/    1EAC :                     el3_126:
    5960/    1EAC : 21 56 1E            	ld	hl, ld_r_jt
    5961/    1EAF : C3 37 1B            	jp	jp_each
    5962/    1EB2 :                     
    5963/    1EB2 :                     ld_r35: ; LD A,(1234H)
    5964/    1EB2 : 3E 3A               	ld	a, 3ah		; 1st MC
    5965/    1EB4 :                     
    5966/    1EB4 : 2A 1D FF            	ld	hl, (tasm_adr)
    5967/    1EB7 : 77                  	ld	(hl), a
    5968/    1EB8 : 23                  	inc	hl
    5969/    1EB9 : ED 5B 26 FF         	ld	de, (opr_num35)
    5970/    1EBD : 73                  	ld	(hl), e
    5971/    1EBE : 23                  	inc	hl
    5972/    1EBF : 72                  	ld	(hl), d
    5973/    1EC0 : C3 0E 22            	jp	mc_end3
    5974/    1EC3 :                     
    5975/    1EC3 :                     ld_r17: ; LD A,R
    5976/    1EC3 : 3E 5F               	ld	a, 5fh
    5977/    1EC5 :                     ld_r171:
    5978/    1EC5 : C3 5C 24            	jp	el2_5411
    5979/    1EC8 :                     	
    5980/    1EC8 :                     ld_r13: ; LD A,I
    5981/    1EC8 : 3E 57               	ld	a, 57h
    5982/    1ECA : 18 F9               	jr	ld_r171
    5983/    1ECC :                     
    5984/    1ECC :                     ld_r27: ; LD A,(DE)
    5985/    1ECC : 3E 1A               	ld	a, 1ah
    5986/    1ECE : C3 01 21            	jp	st_mc11
    5987/    1ED1 :                     	
    5988/    1ED1 :                     ld_r26: ; LD A,(BC)
    5989/    1ED1 : 3E 0A               	ld	a, 0ah
    5990/    1ED3 : C3 01 21            	jp	st_mc11
    5991/    1ED6 :                     
    5992/    1ED6 :                     ld_r37:	; LD r,(IY-nn)
    5993/    1ED6 : 3A 28 FF            	ld	a, (opr_num37)
    5994/    1ED9 :                     ld_r371:
    5995/    1ED9 : 4F                  	ld	c, a
    5996/    1EDA : 1E FD               	ld	e, 0FDH
    5997/    1EDC :                     ld_r372:
    5998/    1EDC : 3E 06               	ld	a, 6
    5999/    1EDE : B2                  	or	d		; make 2nd MC
    6000/    1EDF : 57                  	ld	d, a		; adjust I/F
    6001/    1EE0 : 7B                  	ld	a, e		; adjust I/F
    6002/    1EE1 : C3 19 23            	jp	cp_xy1
    6003/    1EE4 :                     
    6004/    1EE4 :                     ld_r34: ; LD r,(IY+nn)
    6005/    1EE4 : 3A 29 FF            	ld	a, (opr_num34)
    6006/    1EE7 : 18 F0               	jr	ld_r371
    6007/    1EE9 :                     
    6008/    1EE9 :                     ld_r36: ; LD r,(IX-nn)
    6009/    1EE9 : 3A 2A FF            	ld	a, (opr_num36)
    6010/    1EEC :                     ld_r361:
    6011/    1EEC : 4F                  	ld	c, a
    6012/    1EED : 1E DD               	ld	e, 0DDH
    6013/    1EEF : 18 EB               	jr	ld_r372
    6014/    1EF1 :                     
    6015/    1EF1 :                     ld_r33: ; LD r,(IX+nn)
    6016/    1EF1 : 3A 2B FF            	ld	a, (opr_num33)
    6017/    1EF4 : 18 F6               	jr	ld_r361
    6018/    1EF6 :                     
    6019/    1EF6 :                     ld_r25: ; LD r, nn
    6020/    1EF6 : 7A                  	ld	a, d		; get 1st MC base
    6021/    1EF7 : D6 3A               	sub	3ah		; get 1st MC
    6022/    1EF9 : 57                  	ld	d, a
    6023/    1EFA :                     
    6024/    1EFA :                     ld_r251:
    6025/    1EFA : 2A 24 FF            	ld	hl, (opr_num25)
    6026/    1EFD : 7C                  	ld	a, h
    6027/    1EFE : B7                  	or	a
    6028/    1EFF : C2 95 1A            	jp	nz, asm_err
    6029/    1F02 : 7D                  	ld	a, l
    6030/    1F03 : F5                  	push	af		; adjust I/F
    6031/    1F04 : 7A                  	ld	a, d		; adjust I/F
    6032/    1F05 : C3 24 22            	jp	el2_441
    6033/    1F08 :                     
    6034/    1F08 :                     ;
    6035/    1F08 :                     ; LD rp16, nnnn
    6036/    1F08 :                     ; LD rp16, (nnnn)
    6037/    1F08 :                     ; rp16 : BC, DE, HL, IX, IY
    6038/    1F08 :                     ; ld_e2_tbl1:	db	5, 8, 11, 14, 15
    6039/    1F08 :                     
    6040/    1F08 :                     el3_11:
    6041/    1F08 :                     ;	hl = ld_e2_tbl1
    6042/    1F08 : 01 05 00            	ld	bc, ld_en2
    6043/    1F0B : ED B1               	cpir
    6044/    1F0D : 20 74               	jr	nz, el3_1_2
    6045/    1F0F : 79                  	ld	a, c
    6046/    1F10 : B7                  	or	a
    6047/    1F11 : 28 6C               	jr	z, ld_iy_n4
    6048/    1F13 : FE 01               	cp	1
    6049/    1F15 : 28 4E               	jr	z, ld_ix_n4
    6050/    1F17 : FE 02               	cp	2
    6051/    1F19 : 28 35               	jr	z, ld_hl_n4
    6052/    1F1B : FE 03               	cp	3
    6053/    1F1D : 28 29               	jr	z, ld_de_n4
    6054/    1F1F :                     
    6055/    1F1F :                     
    6056/    1F1F :                     ; LD BC, nnnn; LD BC, (nnnn)
    6057/    1F1F :                     ld_bc_n4:
    6058/    1F1F : 16 ED               	ld	d, 0EDH		; 1st MC
    6059/    1F21 : 1E 4B               	ld	e, 4bh		; 2nd MC
    6060/    1F23 : 0E 01               	ld	c, 1		; 1st MC
    6061/    1F25 :                     
    6062/    1F25 :                     ld_bc_n40:
    6063/    1F25 : 3A 23 FF            	ld	a, (opr2_cd)
    6064/    1F28 : FE 19               	cp	25
    6065/    1F2A : 28 0A               	jr	z, ld_bc_n41
    6066/    1F2C :                     
    6067/    1F2C : 7B                  	ld	a, e		; 2nd MC
    6068/    1F2D : 21 26 FF            	ld	hl, opr_num35
    6069/    1F30 : 4E                  	ld	c, (hl)		; 3rd MC
    6070/    1F31 : 23                  	inc	hl
    6071/    1F32 : 5E                  	ld	e, (hl)		; 4th MC
    6072/    1F33 : C3 31 24            	jp	mc_end41
    6073/    1F36 :                     
    6074/    1F36 :                     ld_bc_n41:
    6075/    1F36 : 21 24 FF            	ld	hl, opr_num25
    6076/    1F39 : 5E                  	ld	e, (hl)		; 2rd MC
    6077/    1F3A : 23                  	inc	hl
    6078/    1F3B : 56                  	ld	d, (hl)		; 3rd MC
    6079/    1F3C : 79                  	ld	a, c		; 1st MC
    6080/    1F3D :                     
    6081/    1F3D :                     ld_bc_n42:
    6082/    1F3D : 2A 1D FF            	ld	hl, (tasm_adr)
    6083/    1F40 : 71                  	ld	(hl), c		; save 1st MC
    6084/    1F41 : 23                  	inc	hl
    6085/    1F42 : 73                  	ld	(hl), e
    6086/    1F43 : 23                  	inc	hl
    6087/    1F44 : 72                  	ld	(hl), d
    6088/    1F45 : C3 0E 22            	jp	mc_end3
    6089/    1F48 :                     	
    6090/    1F48 :                     ; LD DE, nnnn; LD DE, (nnnn)
    6091/    1F48 :                     ld_de_n4:
    6092/    1F48 : 16 ED               	ld	d, 0EDH		; 1st MC
    6093/    1F4A : 1E 5B               	ld	e, 5bh		; 2nd MC
    6094/    1F4C : 0E 11               	ld	c, 11h		; 1st MC
    6095/    1F4E : 18 D5               	jr	ld_bc_n40
    6096/    1F50 :                     
    6097/    1F50 :                     ; LD HL, nnnn; LD HL, (nnnn)
    6098/    1F50 :                     ld_hl_n4:
    6099/    1F50 : 0E 21               	ld	c, 21h
    6100/    1F52 : ED 5B 24 FF         	ld	de, (opr_num25)
    6101/    1F56 : 3A 23 FF            	ld	a, (opr2_cd)
    6102/    1F59 : FE 19               	cp	25
    6103/    1F5B : 28 E0               	jr	z, ld_bc_n42
    6104/    1F5D : 0E 2A               	ld	c, 2Ah
    6105/    1F5F : ED 5B 26 FF         	ld	de, (opr_num35)
    6106/    1F63 : 18 D8               	jr	ld_bc_n42
    6107/    1F65 :                     
    6108/    1F65 :                     ; LD IX, nnnn; LD IX, (nnnn)
    6109/    1F65 :                     ld_ix_n4:
    6110/    1F65 : 16 DD               	ld	d, 0DDh		; 1st MC
    6111/    1F67 :                     
    6112/    1F67 :                     ld_ix_n40:
    6113/    1F67 : 0E 21               	ld	c, 21h
    6114/    1F69 : 21 24 FF            	ld	hl, opr_num25
    6115/    1F6C :                     
    6116/    1F6C : 3A 23 FF            	ld	a, (opr2_cd)
    6117/    1F6F : FE 19               	cp	25
    6118/    1F71 : 28 05               	jr	z, ld_ix_n42
    6119/    1F73 :                     
    6120/    1F73 : 0E 2A               	ld	c, 2Ah
    6121/    1F75 : 21 26 FF            	ld	hl, opr_num35
    6122/    1F78 :                     
    6123/    1F78 :                     ld_ix_n42:
    6124/    1F78 : 79                  	ld	a, c		; 2nd MC
    6125/    1F79 : 4E                  	ld	c, (hl)		; 3rd MC
    6126/    1F7A : 23                  	inc	hl
    6127/    1F7B : 5E                  	ld	e, (hl)		; 4th MC
    6128/    1F7C : C3 31 24            	jp	mc_end41
    6129/    1F7F :                     
    6130/    1F7F :                     ; LD IY, nnnn; LD IY, (nnnn)
    6131/    1F7F :                     ld_iy_n4:
    6132/    1F7F : 16 FD               	ld	d, 0FDh		; 1st MC
    6133/    1F81 : 18 E4               	jr	ld_ix_n40
    6134/    1F83 :                     
    6135/    1F83 :                     ;
    6136/    1F83 :                     ; LD ([IX|IY][+|-]nn), [r|nn]
    6137/    1F83 :                     ;
    6138/    1F83 :                     ;ld_e2_tbl2:	db	33, 36, 34, 37
    6139/    1F83 :                     ; LD (IX | IY +|- nn), r | nn
    6140/    1F83 :                     el3_1_2:
    6141/    1F83 :                     ;	hl = ld_e2_tbl2
    6142/    1F83 : 01 04 00            	ld	bc, ld_en3
    6143/    1F86 : ED B1               	cpir
    6144/    1F88 : 20 3F               	jr	nz, el3_13
    6145/    1F8A :                     	
    6146/    1F8A : 21 28 FF            	ld	hl, opr_num37
    6147/    1F8D : 09                  	add	hl, bc
    6148/    1F8E : 56                  	ld	d, (hl)		; get 3rd MC
    6149/    1F8F :                     
    6150/    1F8F : 79                  	ld	a, c
    6151/    1F90 : 1E FD               	ld	e, 0FDh		; 1st MC
    6152/    1F92 : FE 02               	cp	2
    6153/    1F94 : 38 02               	jr	c, el3_121
    6154/    1F96 : 1E DD               	ld	e, 0DDh		; 1st MC
    6155/    1F98 :                     
    6156/    1F98 :                     ; reg_A = (opr2_cd)
    6157/    1F98 :                     ; if (reg_A = 25) 2nd_MC = 36h
    6158/    1F98 :                     ; else {
    6159/    1F98 :                     ;     if (Reg_C = 6) 2nd_MC =77h
    6160/    1F98 :                     ;     else 2nd_MC = 75h - reg_C
    6161/    1F98 :                     ; }
    6162/    1F98 :                     el3_121: ; check element No.3
    6163/    1F98 : 3A 23 FF            	ld	a, (opr2_cd)
    6164/    1F9B : FE 19               	cp	25
    6165/    1F9D : 28 1A               	jr	z, ld_xynln
    6166/    1F9F :                     
    6167/    1F9F : 21 26 1E            	ld	hl, ld_e2_tbl
    6168/    1FA2 : 01 07 00            	ld	bc, ld_en1
    6169/    1FA5 : ED B1               	cpir
    6170/    1FA7 : C2 95 1A            	jp	nz, asm_err
    6171/    1FAA :                     
    6172/    1FAA : 79                  	ld	a, c
    6173/    1FAB : FE 06               	cp	6
    6174/    1FAD : 3E 77               	ld	a, 077h		; a : 2nd MC
    6175/    1FAF : 28 03               	jr	z, mc2_77
    6176/    1FB1 :                     
    6177/    1FB1 : 3E 75               	ld	a, 75h
    6178/    1FB3 : 91                  	sub	c	; a : 2nd MC
    6179/    1FB4 :                     
    6180/    1FB4 :                      ; adjust 1: c, 2: e, 3: d
    6181/    1FB4 :                     mc2_77:
    6182/    1FB4 : 4B                  	ld	c, e		; adjust I/F
    6183/    1FB5 : 5F                  	ld	e, a		; adjust I/F
    6184/    1FB6 : C3 3D 1F            	jp	ld_bc_n42
    6185/    1FB9 :                     
    6186/    1FB9 :                     ld_xynln: ; 4byte MC 
    6187/    1FB9 :                     	  ; LD ([IX|IY] [+|-]), nn
    6188/    1FB9 :                     	  ; 2nd MC = 36h
    6189/    1FB9 :                     
    6190/    1FB9 : 2A 24 FF            	ld	hl, (opr_num25)
    6191/    1FBC : 7C                  	ld	a, h
    6192/    1FBD : B7                  	or	a
    6193/    1FBE : C2 95 1A            	jp	nz, asm_err
    6194/    1FC1 :                     
    6195/    1FC1 :                     ; adjust I/F
    6196/    1FC1 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6197/    1FC1 :                     
    6198/    1FC1 : 3E 36               	ld	a, 36h		; 2nd MC
    6199/    1FC3 : 4A                  	ld	c, d		; 3rd MC
    6200/    1FC4 : 53                  	ld	d, e		; 1st MC
    6201/    1FC5 : 5D                  	ld	e, l		; 4th MC
    6202/    1FC6 : C3 31 24            	jp	mc_end41
    6203/    1FC9 :                     
    6204/    1FC9 :                     ;
    6205/    1FC9 :                     ; 35 : ld (nnnn), reg
    6206/    1FC9 :                     ; 28 : ld (hl), r | nn
    6207/    1FC9 :                     ; 16 : ld SP, hl | ix | iy | nnnn | (nnnn)
    6208/    1FC9 :                     ; 27 : LD (DE), A
    6209/    1FC9 :                     ; 26 : LD (BC), A
    6210/    1FC9 :                     ; 17 : LD R, A
    6211/    1FC9 :                     ; 13 : LD I, A
    6212/    1FC9 :                     ;
    6213/    1FC9 :                     el3_13:
    6214/    1FC9 :                     ;	hl = ld_e2_tbl3
    6215/    1FC9 : 01 07 00            	ld	bc, ld_en4
    6216/    1FCC : ED B1               	cpir
    6217/    1FCE : C2 95 1A            	jp	nz, asm_err
    6218/    1FD1 : 21 D7 1F            	ld	hl, el3_14
    6219/    1FD4 : C3 37 1B            	jp	jp_each
    6220/    1FD7 :                     
    6221/    1FD7 :                     ; jump table
    6222/    1FD7 : F3 1F               el3_14:		dw	el3_s35
    6223/    1FD9 : 28 20               		dw	el3_s28
    6224/    1FDB : 95 20               		dw	el3_s27
    6225/    1FDD : 99 20               		dw	el3_s26
    6226/    1FDF : 9E 20               		dw	el3_s17
    6227/    1FE1 : 57 20               		dw	el3_s16
    6228/    1FE3 : A3 20               		dw	el3_s13
    6229/    1FE5 :                     
    6230/    1FE5 : =7H                  ldnr_n	equ	ldnr_c - ldnr_t
    6231/    1FE5 :                     
    6232/    1FE5 : 01 0B 05 08 10 0E   ldnr_t:		db	1, 11, 5, 8, 16, 14, 15
             1FEB : 0F                
    6233/    1FEC : 22 22 73 53 43 22   ldnr_c:		db	22h, 22h, 73h, 53h, 43h, 22h, 32h
             1FF2 : 32                
    6234/    1FF3 :                     
    6235/    1FF3 :                     el3_s35: ; ld (nnnn), reg
    6236/    1FF3 :                     
    6237/    1FF3 : 3A 23 FF            	ld	a, (opr2_cd)
    6238/    1FF6 :                     
    6239/    1FF6 : 21 E5 1F            	ld	hl, ldnr_t
    6240/    1FF9 : 01 07 00            	ld	bc, ldnr_n
    6241/    1FFC : ED B1               	cpir
    6242/    1FFE : C2 95 1A            	jp	nz, asm_err
    6243/    2001 :                     
    6244/    2001 : 21 EC 1F            	ld	hl, ldnr_c
    6245/    2004 : 09                  	add	hl, bc
    6246/    2005 : 79                  	ld	a, c
    6247/    2006 : 4E                  	ld	c, (hl)		; 1st MC
    6248/    2007 :                     
    6249/    2007 : 2A 26 FF            	ld	hl, (opr_num35)
    6250/    200A : FE 05               	cp	5
    6251/    200C : 38 05               	jr	c, el3_s351
    6252/    200E :                     
    6253/    200E :                      ; adjust 1: c, 2: e, 3: d
    6254/    200E :                     
    6255/    200E : 5D                  	ld	e, l			; 2nd MC
    6256/    200F : 54                  	ld	d, h			; 3rd MC
    6257/    2010 : C3 3D 1F            	jp	ld_bc_n42
    6258/    2013 :                     
    6259/    2013 :                     el3_s351:
    6260/    2013 : FE 02               	cp	2
    6261/    2015 : 38 08               	jr	c, el3_s352
    6262/    2017 :                      ; ED
    6263/    2017 :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6264/    2017 :                     
    6265/    2017 : 16 ED               	ld	d, 0EDH			; 1st MC
    6266/    2019 :                     el3_s353:
    6267/    2019 : 79                  	ld	a, c			; 2nd MC
    6268/    201A : 4D                  	ld	c, l			; 3rd MC
    6269/    201B : 5C                  	ld	e, h			; 4th mc
    6270/    201C : C3 31 24            	jp	mc_end41
    6271/    201F :                     
    6272/    201F :                     el3_s352: ; DD, FD
    6273/    201F : 16 FD               	ld	d, 0FDh			; 1st MC
    6274/    2021 : B7                  	or	a
    6275/    2022 : 28 F5               	jr	z, el3_s353
    6276/    2024 : 16 DD               	ld	d, 0DDh			; 1st MC
    6277/    2026 : 18 F1               	jr	el3_s353
    6278/    2028 :                     
    6279/    2028 :                     ; ld (hl), r | nn
    6280/    2028 :                     el3_s28:
    6281/    2028 : 3A 23 FF            	ld	a, (opr2_cd)
    6282/    202B : FE 19               	cp	25
    6283/    202D : 28 19               	jr	z, el3_s281
    6284/    202F : FE 01               	cp	1
    6285/    2031 : 28 11               	jr	z, el3_s282
    6286/    2033 : 21 27 1E            	ld	hl, ld_e2_tbl + 1
    6287/    2036 : 01 06 00            	ld	bc, ld_en1 - 1
    6288/    2039 : ED B1               	cpir
    6289/    203B : C2 95 1A            	jp	nz, asm_err
    6290/    203E : 3E 75               	ld	a, 75h
    6291/    2040 : 91                  	sub	c
    6292/    2041 :                     el3_s283:
    6293/    2041 : C3 01 21            	jp	st_mc11
    6294/    2044 :                     
    6295/    2044 :                     el3_s282: ; LD (HL), A
    6296/    2044 : 3E 77               	ld	a, 77h
    6297/    2046 : 18 F9               	jr	el3_s283
    6298/    2048 :                     
    6299/    2048 :                     el3_s281: ; LD (HL), nn
    6300/    2048 : 2A 24 FF            	ld	hl, (opr_num25)
    6301/    204B : 7C                  	ld	a, h
    6302/    204C : B7                  	or	a
    6303/    204D : C2 95 1A            	jp	nz, asm_err
    6304/    2050 :                     
    6305/    2050 : 7D                  	ld	a, l
    6306/    2051 : F5                  	push	af		; adjust I/F
    6307/    2052 : 3E 36               	ld	a, 36h		; 1st MC
    6308/    2054 : C3 24 22            	jp	el2_441
    6309/    2057 :                     
    6310/    2057 :                     el3_s16: ; ld SP, hl | ix | iy | nnnn | (nnnn)
    6311/    2057 :                     
    6312/    2057 : 3A 23 FF            	ld	a, (opr2_cd)
    6313/    205A : FE 0B               	cp	11
    6314/    205C : 28 1D               	jr	z, el3_s161
    6315/    205E : FE 0E               	cp	14
    6316/    2060 : 28 1D               	jr	z, el3_s162
    6317/    2062 : FE 0F               	cp	15
    6318/    2064 : 28 1D               	jr	z, el3_s163
    6319/    2066 : FE 19               	cp	25
    6320/    2068 : 28 22               	jr	z, el3_s164
    6321/    206A : FE 23               	cp	35
    6322/    206C : C2 95 1A            	jp	nz, asm_err
    6323/    206F :                     
    6324/    206F :                     ; LD SP, (nnnn)
    6325/    206F :                     ; d: 1st MC, a: 2nd MC, c: 3rd MC, e: 4th MC
    6326/    206F :                     
    6327/    206F : 16 ED               	ld	d, 0edh		; 1st MC
    6328/    2071 : 3E 7B               	ld	a, 7bh		; 2nd MC
    6329/    2073 : 2A 26 FF            	ld	hl, (opr_num35)
    6330/    2076 : 4D                  	ld	c, l		; 3rd MC
    6331/    2077 : 5C                  	ld	e, h		; 4th MC
    6332/    2078 : C3 31 24            	jp	mc_end41
    6333/    207B :                     	
    6334/    207B :                     
    6335/    207B :                     el3_s161: ; LD SP, HL
    6336/    207B : 3E F9               	ld	a, 0f9h
    6337/    207D : 18 1C               	jr	el3_s261
    6338/    207F :                     
    6339/    207F :                     el3_s162: ; LD SP, IX
    6340/    207F : 16 DD               	ld	d, 0DDh
    6341/    2081 : 18 02               	jr	el3_s1631
    6342/    2083 :                     	
    6343/    2083 :                     el3_s163: ; LD SP, IY
    6344/    2083 : 16 FD               	ld	d, 0FDh
    6345/    2085 :                     el3_s1631:
    6346/    2085 : 3E F9               	ld	a, 0f9h
    6347/    2087 : F5                  	push	af		; adjust I/F
    6348/    2088 : 7A                  	ld	a, d
    6349/    2089 : C3 24 22            	jp	el2_441
    6350/    208C :                     
    6351/    208C :                     el3_s164: ; LD SP, nnnn
    6352/    208C :                     ; adjust 1: c, 2: e, 3: d
    6353/    208C :                     
    6354/    208C : 0E 31               	ld	c, 31h		; 1st MC
    6355/    208E : ED 5B 24 FF         	ld	de, (opr_num25)	; e: 2nd MC, d: 3rd MC
    6356/    2092 : C3 3D 1F            	jp	ld_bc_n42
    6357/    2095 :                     
    6358/    2095 :                     el3_s27: ; LD (DE), A
    6359/    2095 : 3E 12               	ld	a, 12h		; set MC
    6360/    2097 : 18 02               	jr	el3_s261
    6361/    2099 :                     	
    6362/    2099 :                     el3_s26: ; LD (BC), A
    6363/    2099 : 3E 02               	ld	a, 2h		; set MC
    6364/    209B :                     el3_s261:
    6365/    209B : C3 01 21            	jp	st_mc11
    6366/    209E :                     	
    6367/    209E :                     el3_s17: ; LD R, A
    6368/    209E : 3E 4F               	ld	a, 4fh		; set 2nd MC
    6369/    20A0 : C3 5C 24            	jp	el2_5411
    6370/    20A3 :                     
    6371/    20A3 :                     el3_s13: ; LD I, A
    6372/    20A3 : 3E 47               	ld	a, 47h		; set 2nd MC
    6373/    20A5 : C3 5C 24            	jp	el2_5411
    6374/    20A8 :                     
    6375/    20A8 :                     ;1111111111111111111111111111111111
    6376/    20A8 :                     ;
    6377/    20A8 :                     ; element count = 1 
    6378/    20A8 :                     ;
    6379/    20A8 :                     ;1111111111111111111111111111111111
    6380/    20A8 :                     
    6381/    20A8 : =0EH                 e1s	equ	e1_e - e1_s
    6382/    20A8 : =15H                 e1s1	equ	e1_e1 - e1_s1
    6383/    20A8 :                     
    6384/    20A8 :                     e1_s: ;------------------------------------------------
    6385/    20A8 : 07 0A 0B 0E 0F 1E   elem1_cd:	db	7, 10, 11, 14, 15, 30, 32
             20AE : 20                
    6386/    20AF : 21 2E 32 33 34 35   		db	33, 46, 50, 51, 52, 53, 65
             20B5 : 41                
    6387/    20B6 :                     e1_e: ;------------------------------------------------
    6388/    20B6 :                     
    6389/    20B6 : 27 FB F3 76 00 C9   elem1_opcd:	db	27H, 0FBH, 0F3H, 76H, 00H, 0C9H, 37H
             20BC : 37                
    6390/    20BD : 3F 2F 1F 0F 17 07   		db	3FH, 2FH, 1FH, 0FH, 17H, 07H, 0D9H
             20C3 : D9                
    6391/    20C4 :                     
    6392/    20C4 :                     e1_s1: ; ----------------------------------------------
    6393/    20C4 : 27 28 25 26 3A 3B   elem1_cd1:	db	39, 40, 37, 38, 58, 59, 56
             20CA : 38                
    6394/    20CB : 39 04 05 02 03 1F   		db	57, 4,  5,  2,  3,  31, 64
             20D1 : 40                
    6395/    20D2 : 3E 3F 3D 2F 30 42   		db	62, 63, 61, 47, 48, 66, 67
             20D8 : 43                
    6396/    20D9 :                     e1_e1: ; ----------------------------------------------
    6397/    20D9 :                     
    6398/    20D9 : 67 6F 45 4D A3 AB   elem1_opcd1:	db	 67h,  6Fh,  45h,  4Dh, 0A3h, 0ABh, 0B3h
             20DF : B3                
    6399/    20E0 : BB 44 B0 A0 B8 A8   		db	0BBh,  44h, 0B0h, 0A0h, 0B8h, 0A8h, 0B2h
             20E6 : B2                
    6400/    20E7 : A2 BA AA B1 A1 B9   		db	0A2h, 0BAh, 0AAh, 0B1h, 0A1h, 0B9h, 0A9h
             20ED : A9                
    6401/    20EE :                     
    6402/    20EE :                     ;
    6403/    20EE :                     ; make machine code,
    6404/    20EE :                     ; element_cnt = 1 (ex. NOP)
    6405/    20EE :                     ; output : 1 byte Machine code
    6406/    20EE :                     ;
    6407/    20EE :                     mk_e1:	; 1byte MC
    6408/    20EE : 3A 21 FF            	ld	a, (opc_cd)
    6409/    20F1 : 01 0E 00            	ld	bc, e1s
    6410/    20F4 : 21 A8 20            	ld	hl, elem1_cd
    6411/    20F7 : ED B1               	cpir
    6412/    20F9 : C2 0D 21            	jp	nz, mk_e11
    6413/    20FC :                     	
    6414/    20FC : 21 B6 20            	ld	hl, elem1_opcd
    6415/    20FF :                     
    6416/    20FF :                     st_mc1:
    6417/    20FF : 09                  	add	hl, bc
    6418/    2100 :                     	; get MC
    6419/    2100 : 7E                  	ld	a, (hl)
    6420/    2101 :                     st_mc11:
    6421/    2101 : 2A 1D FF            	ld	hl, (tasm_adr)
    6422/    2104 : 77                  	ld	(hl), a
    6423/    2105 : 3E 01               	ld	a, 1
    6424/    2107 :                     
    6425/    2107 :                     mc_end:
    6426/    2107 : 32 20 FF            	ld	(byte_count), a	; set MC bytes
    6427/    210A : C3 A6 1A            	jp	cout_sp
    6428/    210D :                     
    6429/    210D :                     mk_e11: ; 2byte MC (0EDh, XX)
    6430/    210D : 01 15 00            	ld	bc, e1s1
    6431/    2110 : 21 C4 20            	ld	hl, elem1_cd1
    6432/    2113 : ED B1               	cpir
    6433/    2115 : C2 95 1A            	jp	nz, asm_err
    6434/    2118 :                     	
    6435/    2118 : 2A 1D FF            	ld	hl, (tasm_adr)
    6436/    211B : 3E ED               	ld	a, 0EDH
    6437/    211D : 77                  	ld	(hl), a		; set MC No.1
    6438/    211E : 23                  	inc	hl
    6439/    211F : EB                  	ex	de, hl
    6440/    2120 :                     
    6441/    2120 : 21 D9 20            	ld	hl, elem1_opcd1
    6442/    2123 : 09                  	add	hl, bc
    6443/    2124 :                     	; get MC
    6444/    2124 : 7E                  	ld	a, (hl)
    6445/    2125 : 12                  	ld	(de), a		; set MC No.2
    6446/    2126 :                     
    6447/    2126 :                     mc_end2:
    6448/    2126 : 3E 02               	ld	a, 2
    6449/    2128 : 18 DD               	jr	mc_end
    6450/    212A :                     
    6451/    212A :                     ;2222222222222222222222222222222222222222222222
    6452/    212A :                     ;
    6453/    212A :                     ; element count = 2 
    6454/    212A :                     ;
    6455/    212A :                     ;2222222222222222222222222222222222222222222222
    6456/    212A :                     
    6457/    212A : =1AH                 e2s	equ	e2_e - e2_s
    6458/    212A :                     
    6459/    212A :                     e2_s:
    6460/    212A :                     elem2_cd:
    6461/    212A : 08 09               	db	8, 9			; DD, FD
    6462/    212C : 17 1A               	db	23, 26			; DD, FD
    6463/    212E : 18 1B 1C 1D 29      	db	24, 27, 28 ,29, 41	; DD, FD
    6464/    2133 : 2A                  	db	42			; DD, FD
    6465/    2134 : 2E                  	db	46
    6466/    2135 : 31                  	db	49
    6467/    2136 : 2B                  	db	43
    6468/    2137 : 2C                  	db	44
    6469/    2138 : 2D                  	db	45
    6470/    2139 :                     ; CB
    6471/    2139 : 0C                  	db	12			; DD, FD
    6472/    213A : 10                  	db	16			; DD, FD
    6473/    213B : 0D                  	db	13			; DD, FD
    6474/    213C : 11                  	db	17			; DD, FD
    6475/    213D : 12                  	db	18			; DD, FD
    6476/    213E : 13                  	db	19			; DD, FD
    6477/    213F : 14                  	db	20			; DD, FD
    6478/    2140 :                     ; ED
    6479/    2140 : 36                  	db	54			; ED
    6480/    2141 : 44                  	db	68			; ORG
    6481/    2142 : 45                  	db	69			; DB
    6482/    2143 : 46                  	db	70			; DW
    6483/    2144 :                     e2_e:
    6484/    2144 :                     
    6485/    2144 :                     ent_el2:
    6486/    2144 : 8C 21               	dw	el2_70		; DW
    6487/    2146 : A1 21               	dw	el2_69		; DB
    6488/    2148 : DA 21               	dw	el2_68		; ORG
    6489/    214A : 40 24               	dw	el2_54		; IM
    6490/    214C : DA 23               	dw	el2_20		; SRL
    6491/    214E : DF 23               	dw	el2_19		; SRA
    6492/    2150 : E4 23               	dw	el2_18		; SLA
    6493/    2152 : E9 23               	dw	el2_17		; RR
    6494/    2154 : EE 23               	dw	el2_13		; RL
    6495/    2156 : F3 23               	dw	el2_16		; RRC
    6496/    2158 : F8 23               	dw	el2_12		; RLC
    6497/    215A :                     
    6498/    215A : F8 21               	dw	el2_45		; CALL nnnn
    6499/    215C : 13 22               	dw	el2_44		; DJNZ e
    6500/    215E : 2E 22               	dw	el2_43		; jR e
    6501/    2160 : 41 22               	dw	el2_49		; RST nn
    6502/    2162 : 6B 22               	dw	el2_46		; RET CC
    6503/    2164 : 8F 22               	dw	el2_42		; JP (HL), JP nnnn
    6504/    2166 :                     
    6505/    2166 :                     ; code base 0a0h, or 00h, 08h, 10h, 18h
    6506/    2166 : C9 22               	dw	el2_41		; CP
    6507/    2168 : CD 22               	dw	el2_29		; XOR
    6508/    216A : D1 22               	dw	el2_28		; OR
    6509/    216C : D5 22               	dw	el2_27		; AND
    6510/    216E :                     
    6511/    216E : D9 22               	dw	el2_24		; SUB
    6512/    2170 :                     
    6513/    2170 : 5B 23               	dw	el2_26		; DEC
    6514/    2172 : 60 23               	dw	el2_23		; INC
    6515/    2174 :                     
    6516/    2174 : A2 23               	dw	el2_9		; POP
    6517/    2176 : A6 23               	dw	el2_8		; PUSH
    6518/    2178 :                     
    6519/    2178 :                     ;
    6520/    2178 :                     ; make machine code,
    6521/    2178 :                     ; element_cnt = 2 (ex. PUSH AF)
    6522/    2178 :                     ; output : 1 to 3 bytes Machine code
    6523/    2178 :                     ;
    6524/    2178 :                     
    6525/    2178 :                     mk_e2:
    6526/    2178 : 3A 21 FF            	ld	a, (opc_cd)
    6527/    217B : 01 1A 00            	ld	bc, e2s
    6528/    217E : 21 2A 21            	ld	hl, elem2_cd
    6529/    2181 : ED B1               	cpir
    6530/    2183 : C2 95 1A            	jp	nz, asm_err
    6531/    2186 :                     	
    6532/    2186 : 21 44 21            	ld	hl, ent_el2
    6533/    2189 : C3 37 1B            	jp	jp_each
    6534/    218C :                     
    6535/    218C :                     el2_70: ; DW
    6536/    218C : 3A 22 FF            	ld	a, (opr1_cd)
    6537/    218F : FE 19               	cp	25
    6538/    2191 : C2 95 1A            	jp	nz, asm_err
    6539/    2194 :                     
    6540/    2194 : 2A 1D FF            	ld	hl, (tasm_adr)
    6541/    2197 : ED 4B 24 FF         	ld	bc, (opr_num25)
    6542/    219B : 71                  	ld	(hl), c
    6543/    219C : 23                  	inc	hl
    6544/    219D : 70                  	ld	(hl), b
    6545/    219E : C3 26 21            	jp	mc_end2
    6546/    21A1 :                     
    6547/    21A1 :                     el2_69: ; DB
    6548/    21A1 : 3A 22 FF            	ld	a, (opr1_cd)
    6549/    21A4 : FE 19               	cp	25
    6550/    21A6 : 28 20               	jr	z, el2_691
    6551/    21A8 : FE 26               	cp	38
    6552/    21AA : C2 95 1A            	jp	nz, asm_err
    6553/    21AD :                     	
    6554/    21AD : 2A 24 FF            	ld	hl, (opr_num25)
    6555/    21B0 :                     
    6556/    21B0 : AF                  	xor	a
    6557/    21B1 : 4F                  	ld	c, a
    6558/    21B2 : ED 5B 1D FF         	ld	de, (tasm_adr)
    6559/    21B6 :                     
    6560/    21B6 :                     el2_692:
    6561/    21B6 : 7E                  	ld	a, (hl)
    6562/    21B7 : FE 22               	cp	'"'
    6563/    21B9 : 28 09               	jr	z, cpstrend
    6564/    21BB : B7                  	or	a
    6565/    21BC : 28 06               	jr	z, cpstrend
    6566/    21BE :                     
    6567/    21BE : 12                  	ld	(de), a
    6568/    21BF : 23                  	inc	hl
    6569/    21C0 : 13                  	inc	de
    6570/    21C1 : 0C                  	inc	c
    6571/    21C2 : 18 F2               	jr	el2_692
    6572/    21C4 :                     
    6573/    21C4 :                     cpstrend:
    6574/    21C4 : 79                  	ld	a, c
    6575/    21C5 : C3 07 21            	jp	mc_end
    6576/    21C8 :                     
    6577/    21C8 :                     el2_691:
    6578/    21C8 : ED 4B 24 FF         	ld	bc, (opr_num25)
    6579/    21CC : 78                  	ld	a, b
    6580/    21CD : B7                  	or	a
    6581/    21CE : C2 95 1A            	jp	nz, asm_err
    6582/    21D1 :                     
    6583/    21D1 : 2A 1D FF            	ld	hl, (tasm_adr)
    6584/    21D4 : 71                  	ld	(hl), c
    6585/    21D5 : 3E 01               	ld	a, 1
    6586/    21D7 : C3 07 21            	jp	mc_end
    6587/    21DA :                     
    6588/    21DA :                     el2_68: ; ORG
    6589/    21DA : 3A 22 FF            	ld	a, (opr1_cd)
    6590/    21DD : FE 19               	cp	25
    6591/    21DF : C2 95 1A            	jp	nz, asm_err
    6592/    21E2 :                     
    6593/    21E2 : AF                  	xor	a
    6594/    21E3 : 2A 24 FF            	ld	hl, (opr_num25)
    6595/    21E6 : 01 00 80            	ld	bc, RAM_B
    6596/    21E9 : ED 42               	sbc	hl, bc
    6597/    21EB : DA 95 1A            	jp	c, asm_err
    6598/    21EE :                     
    6599/    21EE :                     ;	ld	bc, RAM_E + 1
    6600/    21EE :                     ;	ld	hl, (opr_num25)
    6601/    21EE :                     ;	sbc	hl, bc
    6602/    21EE :                     ;	jr	c, asm_err
    6603/    21EE :                     
    6604/    21EE :                     okram:
    6605/    21EE : 2A 24 FF            	ld	hl, (opr_num25)
    6606/    21F1 : 22 1D FF            	ld	(tasm_adr), hl
    6607/    21F4 : AF                  	xor	a
    6608/    21F5 : C3 07 21            	jp	mc_end
    6609/    21F8 :                     
    6610/    21F8 :                     ; CALL nnnn
    6611/    21F8 :                     el2_45:
    6612/    21F8 : 3A 22 FF            	ld	a, (opr1_cd)
    6613/    21FB : FE 19               	cp	25
    6614/    21FD : C2 95 1A            	jp	nz, asm_err
    6615/    2200 :                     
    6616/    2200 : 3E CD               	ld	a, 0CDH
    6617/    2202 :                     
    6618/    2202 :                     el2_451:
    6619/    2202 : 2A 1D FF            	ld	hl, (tasm_adr)
    6620/    2205 : 77                  	ld	(hl), a		; save op_code
    6621/    2206 : 23                  	inc	hl
    6622/    2207 : ED 5B 24 FF         	ld	de, (opr_num25)
    6623/    220B : 73                  	ld	(hl), e
    6624/    220C : 23                  	inc	hl
    6625/    220D : 72                  	ld	(hl), d
    6626/    220E :                     
    6627/    220E :                     mc_end3:
    6628/    220E : 3E 03               	ld	a, 3
    6629/    2210 : C3 07 21            	jp	mc_end
    6630/    2213 :                     
    6631/    2213 :                     ; DJNZ relative number
    6632/    2213 :                     el2_44:
    6633/    2213 : 3A 22 FF            	ld	a, (opr1_cd)
    6634/    2216 : FE 19               	cp	25
    6635/    2218 : C2 95 1A            	jp	nz, asm_err
    6636/    221B :                     
    6637/    221B : CD AB 25            	call	calc_reladr
    6638/    221E : DA 95 1A            	jp	c, asm_err
    6639/    2221 : F5                  	push	af
    6640/    2222 : 3E 10               	ld	a, 10H
    6641/    2224 :                     el2_441:
    6642/    2224 : 2A 1D FF            	ld	hl, (tasm_adr)
    6643/    2227 : 77                  	ld	(hl), a		; save op_code
    6644/    2228 : 23                  	inc	hl
    6645/    2229 : F1                  	pop	af
    6646/    222A : 77                  	ld	(hl), a
    6647/    222B : C3 26 21            	jp	mc_end2
    6648/    222E :                     
    6649/    222E :                     ;ovr_msg:
    6650/    222E :                     ;	db	"Over. ", 0
    6651/    222E :                     
    6652/    222E :                     ; JR e
    6653/    222E :                     el2_43:
    6654/    222E : 3A 22 FF            	ld	a, (opr1_cd)
    6655/    2231 : FE 19               	cp	25
    6656/    2233 : C2 95 1A            	jp	nz, asm_err
    6657/    2236 : CD AB 25            	call	calc_reladr
    6658/    2239 : DA 95 1A            	jp	c, asm_err
    6659/    223C : F5                  	push	af
    6660/    223D : 3E 18               	ld	a, 18H
    6661/    223F : 18 E3               	jr	el2_441
    6662/    2241 :                     
    6663/    2241 :                     ; RST
    6664/    2241 :                     el2_49:
    6665/    2241 : 2A 24 FF            	ld	hl, (opr_num25)
    6666/    2244 : 7C                  	ld	a, h
    6667/    2245 : B7                  	or	a
    6668/    2246 : C2 95 1A            	jp	nz, asm_err
    6669/    2249 : 7D                  	ld	a, l
    6670/    224A : 21 5B 22            	ld	hl, rst_no
    6671/    224D : 01 08 00            	ld	bc, 8
    6672/    2250 : ED B1               	cpir
    6673/    2252 : C2 95 1A            	jp	nz, asm_err
    6674/    2255 :                     
    6675/    2255 : 21 63 22            	ld	hl, rst_cd
    6676/    2258 : C3 FF 20            	jp	st_mc1		; get and store MC code
    6677/    225B :                     
    6678/    225B : 00 08 10 18 20 28   rst_no:	db	0, 8, 10H, 18H, 20H, 28H, 30H, 38H
             2261 : 30 38             
    6679/    2263 : FF F7 EF E7 DF D7   rst_cd:	db	0FFH, 0F7H, 0EFH, 0E7H, 0DFH, 0D7H, 0CFH, 0C7H
             2269 : CF C7             
    6680/    226B :                     
    6681/    226B :                     ;ill_num:	db	"Ill-No. ", 0
    6682/    226B :                     
    6683/    226B :                     ; RET CC
    6684/    226B :                     el2_46:
    6685/    226B : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6686/    226E : 21 7F 22            	ld	hl, ret_no
    6687/    2271 : 01 08 00            	ld	bc, 8
    6688/    2274 : ED B1               	cpir
    6689/    2276 : C2 95 1A            	jp	nz, asm_err
    6690/    2279 :                     
    6691/    2279 : 21 87 22            	ld	hl, ret_cd
    6692/    227C : C3 FF 20            	jp	st_mc1		; get and store MC code
    6693/    227F :                     
    6694/    227F : 06 12 13 14 15 16   ret_no:	db	6, 18, 19, 20, 21, 22, 23, 24
             2285 : 17 18             
    6695/    2287 : E8 E0 F0 D0 C0 F8   ret_cd:	db	0E8H, 0E0H, 0F0H, 0D0H, 0C0H, 0F8H, 0C8H, 0D8H
             228D : C8 D8             
    6696/    228F :                     
    6697/    228F :                     ; JP (HL), JP nnnn, JP (IX), JP (IY)
    6698/    228F :                     el2_42:
    6699/    228F : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6700/    2292 : FE 19               	cp	25
    6701/    2294 : 28 21               	jr	z, jpnnnn	; JP nnnn
    6702/    2296 : 2E E9               	ld	l, 0E9H
    6703/    2298 : FE 1C               	cp	28		; (HL)?
    6704/    229A : 28 17               	jr	z, jphl
    6705/    229C : FE 1D               	cp	29		; (IX)?
    6706/    229E : 28 0C               	jr	z, jpix
    6707/    22A0 : FE 1E               	cp	30		; (IY)?
    6708/    22A2 : C2 95 1A            	jp	nz, asm_err
    6709/    22A5 :                     
    6710/    22A5 :                     ; JP (IY)
    6711/    22A5 : 7D                  	ld	a, l
    6712/    22A6 : F5                  	push	af
    6713/    22A7 : 3E FD               	ld	a, 0FDH
    6714/    22A9 : C3 24 22            	jp	el2_441
    6715/    22AC :                     
    6716/    22AC :                     ; JP (IX)
    6717/    22AC :                     jpix:
    6718/    22AC : 7D                  	ld	a, l
    6719/    22AD : F5                  	push	af
    6720/    22AE : 3E DD               	ld	a, 0DDH
    6721/    22B0 : C3 24 22            	jp	el2_441
    6722/    22B3 :                     
    6723/    22B3 :                     ; JP (HL)
    6724/    22B3 :                     jphl:
    6725/    22B3 : 7D                  	ld	a, l
    6726/    22B4 : C3 01 21            	jp	st_mc11		; set JP (HL) MC code
    6727/    22B7 :                     
    6728/    22B7 :                     ; JP nnnn
    6729/    22B7 :                     jpnnnn:
    6730/    22B7 : 3E C3               	ld	a, 0c3h
    6731/    22B9 : C3 02 22            	jp	el2_451		; save OP and jmp address
    6732/    22BC :                     
    6733/    22BC :                     ;
    6734/    22BC :                     ; CP, XOR, OR, AND, SUB section
    6735/    22BC :                     ;
    6736/    22BC :                     ; (defined already)
    6737/    22BC :                     ;rhlnnxy	equ	r_hl_nne - r_hl_nn
    6738/    22BC :                     ;m_num		equ	5	; except No.0 - 4  (IX+,IY+,IX-,IY-,nnnn)
    6739/    22BC :                     ;r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6740/    22BC :                     ;		db	25
    6741/    22BC :                     ;ex_sr_:	db	33, 36, 34, 37
    6742/    22BC :                     ;r_hl_nne:
    6743/    22BC :                     ;
    6744/    22BC : 06 06 06 06 46      base1:		db	06H, 06H, 06H, 06H, 46h
    6745/    22C1 : 06 05 04 03 02 01   		db	06H, 05H, 04H, 03H, 02H, 01H, 00H, 07H
             22C7 : 00 07             
    6746/    22C9 :                     
    6747/    22C9 :                     el2_41: ; CP
    6748/    22C9 : 16 B8               	ld	d, 0b8h
    6749/    22CB : 18 0E               	jr	and_cp
    6750/    22CD :                     
    6751/    22CD :                     el2_29: ; XOR
    6752/    22CD : 16 A8               	ld	d, 0a8h
    6753/    22CF : 18 0A               	jr	and_cp
    6754/    22D1 :                     
    6755/    22D1 :                     el2_28: ; OR
    6756/    22D1 : 16 B0               	ld	d, 0b0h
    6757/    22D3 : 18 06               	jr	and_cp
    6758/    22D5 :                     
    6759/    22D5 :                     el2_27: ; AND
    6760/    22D5 : 16 A0               	ld	d, 0a0h
    6761/    22D7 : 18 02               	jr	and_cp
    6762/    22D9 :                     
    6763/    22D9 :                     el2_24: ; SUB
    6764/    22D9 : 16 90               	ld	d, 090h
    6765/    22DB :                     
    6766/    22DB :                     and_cp:
    6767/    22DB : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6768/    22DE : 21 3D 1E            	ld	hl, r_hl_nn
    6769/    22E1 : 01 0D 00            	ld	bc, rhlnnxy
    6770/    22E4 : ED B1               	cpir
    6771/    22E6 : C2 95 1A            	jp	nz, asm_err
    6772/    22E9 :                     
    6773/    22E9 : 21 BC 22            	ld	hl, base1
    6774/    22EC : 09                  	add	hl, bc
    6775/    22ED : 7E                  	ld	a, (hl)
    6776/    22EE : B2                  	or	a, d		; make code operand1
    6777/    22EF : 57                  	ld	d, a		; save operand1
    6778/    22F0 : 79                  	ld	a, c
    6779/    22F1 : FE 05               	cp	m_num		; check IX+,IY+,IX-,IY-,nnnn
    6780/    22F3 : DA FA 22            	jp	c, el2_410
    6781/    22F6 : 7A                  	ld	a, d		; restore
    6782/    22F7 : C3 01 21            	jp	st_mc11
    6783/    22FA :                     	
    6784/    22FA :                     ; IX+,IY+,IX-,IY-,nnnn
    6785/    22FA :                     el2_410:
    6786/    22FA : FE 04               	cp	4 		; cp nn ?
    6787/    22FC : 38 0E               	jr	c, cp_ixiy	; no, IX+,IY+,IX-,IY-
    6788/    22FE :                     
    6789/    22FE :                     ; CP nn
    6790/    22FE : 2A 24 FF            	ld	hl, (opr_num25)
    6791/    2301 : 7C                  	ld	a, h
    6792/    2302 : B7                  	or	a
    6793/    2303 : C2 95 1A            	jp	nz, asm_err
    6794/    2306 :                     
    6795/    2306 : 7D                  	ld	a, l
    6796/    2307 :                     el2_411:
    6797/    2307 : F5                  	push	af		; adjust save I/F
    6798/    2308 : 7A                  	ld	a, d		; restore cp opecode
    6799/    2309 : C3 24 22            	jp	el2_441
    6800/    230C :                     	
    6801/    230C :                     ; CP (IX+nn), CP (IY+nn), CP (IX-nn), CP (IY-nn)
    6802/    230C :                     
    6803/    230C :                     cp_ixiy:
    6804/    230C : FE 02               	cp	2
    6805/    230E : 3E FD               	ld	a, 0FDH
    6806/    2310 : 38 02               	jr	c, cp_iy
    6807/    2312 : 3E DD               	ld	a, 0DDH
    6808/    2314 :                     cp_iy:
    6809/    2314 : 21 28 FF            	ld	hl, opr_num37
    6810/    2317 : 09                  	add	hl, bc
    6811/    2318 : 4E                  	ld	c, (hl)
    6812/    2319 :                     cp_xy1:	
    6813/    2319 : 2A 1D FF            	ld	hl, (tasm_adr)
    6814/    231C : 77                  	ld	(hl), a		; save op_code
    6815/    231D : 7A                  	ld	a, d		; restore 2nd operand
    6816/    231E : 23                  	inc	hl
    6817/    231F : 77                  	ld	(hl), a
    6818/    2320 : 23                  	inc	hl
    6819/    2321 : 71                  	ld	(hl), c
    6820/    2322 : C3 0E 22            	jp	mc_end3
    6821/    2325 :                     
    6822/    2325 :                     ;
    6823/    2325 :                     ; DEC, INC section
    6824/    2325 :                     ;
    6825/    2325 :                     
    6826/    2325 : =12H                 di_nbs		equ	d_i_tbe - d_i_tb
    6827/    2325 : =6H                  di_ixynum	equ	d_i_tbe - dix_tbl
    6828/    2325 : =4H                  di_ixnnum	equ	d_i_tbe - dixn_tbl
    6829/    2325 : =2H                  di_iynnum	equ	d_i_tbe - diyn_tbl
    6830/    2325 :                     
    6831/    2325 : 01 04 05 06 07 08   d_i_tb:		db	1, 4, 5, 6, 7, 8
    6832/    232B : 09 0A 0B 0C 10 1C   		db	9, 10, 11, 12, 16, 28
    6833/    2331 : 0E 0F               dix_tbl:	db	14, 15		; IX, IY
    6834/    2333 : 21 24               dixn_tbl:	db	33, 36		; IX+nn, IX-nn
    6835/    2335 : 22 25               diyn_tbl:	db	34, 37		; IY+nn, IY-nn
    6836/    2337 :                     d_i_tbe:
    6837/    2337 :                     
    6838/    2337 : 35 35               DEC_opr:	db	35h, 35h	; IY-, IY+
    6839/    2339 : 35 35               		db	35h, 35h	; IX-, IX+
    6840/    233B : 2B 2B               		db	2bh, 2bh 	; IY, IX
    6841/    233D : 35 3B 2D 2B 25 1D   		db	35h, 3Bh, 2Dh, 2Bh, 25h, 1Dh
    6842/    2343 : 1B 15 0D 0B 05 3D   		db	1Bh, 15h, 0Dh, 0Bh, 05h, 3Dh
    6843/    2349 :                     
    6844/    2349 : 34 34               INC_opr:	db	34h, 34h	; IY-, IY+
    6845/    234B : 34 34               		db	34h, 34h	; IX-, IX+
    6846/    234D : 23 23               		db	23h, 23h	; IY,  IX
    6847/    234F : 34 33 2C 23 24 1C   		db	34h, 33h, 2Ch, 23h, 24h, 1Ch
    6848/    2355 : 13 14 0C 03 04 3C   		db	13h, 14h, 0Ch, 03h, 04h, 3Ch
    6849/    235B :                     
    6850/    235B :                     el2_26: ; DEC
    6851/    235B : 11 37 23            	ld	de, DEC_opr
    6852/    235E : 18 03               	jr	el2_di
    6853/    2360 :                     
    6854/    2360 :                     el2_23: ; INC
    6855/    2360 : 11 49 23            	ld	de, INC_opr
    6856/    2363 :                     
    6857/    2363 :                     el2_di:
    6858/    2363 : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6859/    2366 : 21 25 23            	ld	hl, d_i_tb
    6860/    2369 : 01 12 00            	ld	bc, di_nbs
    6861/    236C : ED B1               	cpir
    6862/    236E : 62                  	ld	h, d
    6863/    236F : 6B                  	ld	l, e
    6864/    2370 : C2 95 1A            	jp	nz, asm_err
    6865/    2373 :                     
    6866/    2373 : 79                  	ld	a, c
    6867/    2374 : 16 FD               	ld	d, 0FDH		; set IY extended OP
    6868/    2376 : FE 06               	cp	di_ixynum
    6869/    2378 : D2 FF 20            	jp	nc, st_mc1	; 1 MC code
    6870/    237B :                     
    6871/    237B : 09                  	add	hl, bc
    6872/    237C : 7E                  	ld	a, (hl)		; get 2nd operand
    6873/    237D : 5F                  	ld	e, a		; save
    6874/    237E : 79                  	ld	a, c
    6875/    237F : FE 04               	cp	di_ixnnum
    6876/    2381 : 38 08               	jr	c, di_3mc
    6877/    2383 :                     	
    6878/    2383 :                     	; 2 MC. : INC IX, IY, DEC IX, IY
    6879/    2383 :                     	
    6880/    2383 : 28 02               	jr	z, di_iy
    6881/    2385 : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6882/    2387 :                     di_iy:
    6883/    2387 : 7B                  	ld	a, e		; restoe 2nd operand
    6884/    2388 : C3 07 23            	jp	el2_411		; 2 MC (IX, IY)
    6885/    238B :                     
    6886/    238B :                     	; 3 MC. : INC (IX+nn) etc,.
    6887/    238B :                     di_3mc:
    6888/    238B : FE 02               	cp	di_iynnum	; IY+-nn?
    6889/    238D : 38 02               	jr	c, di_3mc1
    6890/    238F : 16 DD               	ld	d, 0DDH		; set IX extended OP
    6891/    2391 :                     di_3mc1:
    6892/    2391 : 7A                  	ld	a, d		; adjust I/F
    6893/    2392 : 53                  	ld	d, e		; adjust I/F
    6894/    2393 : C3 14 23            	jp	cp_iy		; make 3 MC
    6895/    2396 :                     	
    6896/    2396 :                     ;
    6897/    2396 :                     ; PUSH, POP section
    6898/    2396 :                     ;
    6899/    2396 :                     
    6900/    2396 : =6H                  pp_no		equ	pp_tble - pp_tbl
    6901/    2396 : =2H                  pp_ixiy		equ	pp_tble - pp_ixy
    6902/    2396 :                     
    6903/    2396 : 02 05 08 0B         pp_tbl:		db	2, 5, 8, 11
    6904/    239A : 0E 0F               pp_ixy:		db	14, 15
    6905/    239C :                     pp_tble:	
    6906/    239C :                     
    6907/    239C : E0 E0               pp_base:	db	0E0h, 0E0h ; IY, IX
    6908/    239E : E0 D0 C0 F0         		db	0E0h, 0D0h, 0C0h, 0f0h
    6909/    23A2 :                     
    6910/    23A2 :                     el2_9:  ; POP
    6911/    23A2 : 16 01               	ld	d, 01h		; base code for pop operand
    6912/    23A4 : 18 02               	jr	el2_81
    6913/    23A6 :                     
    6914/    23A6 :                     el2_8:  ; PUSH
    6915/    23A6 : 16 05               	ld	d, 05h
    6916/    23A8 :                     
    6917/    23A8 :                     el2_81:
    6918/    23A8 : 21 96 23            	ld	hl, pp_tbl
    6919/    23AB : 01 06 00            	ld	bc, pp_no
    6920/    23AE : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    6921/    23B1 : ED B1               	cpir
    6922/    23B3 : C2 95 1A            	jp	nz, asm_err
    6923/    23B6 :                     
    6924/    23B6 : 21 9C 23            	ld	hl, pp_base
    6925/    23B9 : 09                  	add	hl, bc
    6926/    23BA : 7E                  	ld	a, (hl)
    6927/    23BB : B2                  	or	d		; make opecode
    6928/    23BC : 57                  	ld	d, a		; save
    6929/    23BD :                     
    6930/    23BD : 79                  	ld	a, c
    6931/    23BE : FE 02               	cp	pp_ixiy
    6932/    23C0 : 7A                  	ld	a, d		; restore
    6933/    23C1 : D2 01 21            	jp	nc, st_mc11	; 1 MC code
    6934/    23C4 :                     
    6935/    23C4 : 1E FD               	ld	e, 0FDH		; set IY extended OP
    6936/    23C6 : 79                  	ld	a, c
    6937/    23C7 : B7                  	or	a		; IY
    6938/    23C8 : 28 02               	jr	z, el2_82
    6939/    23CA : 1E DD               	ld	e, 0DDH		; set IX code
    6940/    23CC :                     el2_82:
    6941/    23CC : 7A                  	ld	a, d
    6942/    23CD : F5                  	push	af		; adjust I/F
    6943/    23CE : 7B                  	ld	a, e		; adjust I/F
    6944/    23CF : C3 24 22            	jp	el2_441		; make 2 MC
    6945/    23D2 :                     
    6946/    23D2 :                     ;
    6947/    23D2 :                     ; SRL, SRA, SLA, RR, RL, RRC, RLC section
    6948/    23D2 :                     ;
    6949/    23D2 :                     
    6950/    23D2 :                     
    6951/    23D2 :                     ; already defined
    6952/    23D2 :                     ; r_hl_nn:	db	1, 4, 6, 7, 9, 10, 12, 28
    6953/    23D2 :                     ;		db	25
    6954/    23D2 :                     ; ex_sr_:		db	33, 36, 34, 37
    6955/    23D2 :                     
    6956/    23D2 : =8H                  sr_num		equ	8
    6957/    23D2 : =4H                  ex_sr_num	equ	ld_en3
    6958/    23D2 :                     
    6959/    23D2 :                     ;SRL_cd:	db	3Eh, 3Dh, 3Ch, 3Bh, 3Ah, 39h, 38h, 3Fh
    6960/    23D2 :                     ;SRA_cd:	db	2Eh, 2Dh, 2Ch, 2Bh, 2Ah, 29h, 28h, 2Fh
    6961/    23D2 :                     ;RR_cd:		db	1Eh, 1Dh, 1Ch, 1Bh, 1Ah, 19h, 18h, 1Fh
    6962/    23D2 :                     ;RRC_cd:	db	0Eh, 0Dh, 0Ch, 0Bh, 0Ah, 09h, 08h, 0Fh
    6963/    23D2 :                     ;SLA_cd:	db	26h, 25h, 24h, 23h, 22h, 21h, 20h, 27h
    6964/    23D2 :                     ;RL_cd:		db	16h, 15h, 14h, 13h, 12h, 11h, 10h, 17h
    6965/    23D2 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6966/    23D2 :                     ;RLC_cd:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
    6967/    23D2 :                     
    6968/    23D2 : =0H                  RLC_or	equ	0
    6969/    23D2 : =10H                 RL_or	equ	10h
    6970/    23D2 : =20H                 SLA_or	equ	20h
    6971/    23D2 : =8H                  RRC_or	equ	08h
    6972/    23D2 : =18H                 RR_or	equ	18h
    6973/    23D2 : =28H                 SRA_or	equ	28h
    6974/    23D2 : =38H                 SRL_or	equ	38h
    6975/    23D2 :                     
    6976/    23D2 : 06 05 04 03 02 01   SR_base:	db	06h, 05h, 04h, 03h, 02h, 01h, 00h, 07h
             23D8 : 00 07             
    6977/    23DA :                     
    6978/    23DA :                     
    6979/    23DA :                     
    6980/    23DA :                     el2_20:	; SRL
    6981/    23DA : 11 3E 38            	ld	de, (SRL_or << 8) | 3Eh
    6982/    23DD : 18 1C               	jr	sr_lookfor
    6983/    23DF :                     el2_19:	; SRA
    6984/    23DF : 11 2E 28            	ld	de, (SRA_or << 8) | 2Eh
    6985/    23E2 : 18 17               	jr	sr_lookfor
    6986/    23E4 :                     el2_18:	; SLA
    6987/    23E4 : 11 26 20            	ld	de, (SLA_or << 8) | 26h
    6988/    23E7 : 18 12               	jr	sr_lookfor
    6989/    23E9 :                     el2_17:	; RR
    6990/    23E9 : 11 1E 18            	ld	de, (RR_or << 8) | 1Eh
    6991/    23EC : 18 0D               	jr	sr_lookfor
    6992/    23EE :                     el2_13:	; RL
    6993/    23EE : 11 16 10            	ld	de, (RL_or << 8) | 16h
    6994/    23F1 : 18 08               	jr	sr_lookfor
    6995/    23F3 :                     el2_16:	; RRC
    6996/    23F3 : 11 0E 08            	ld	de, (RRC_or << 8) | 0Eh
    6997/    23F6 : 18 03               	jr	sr_lookfor
    6998/    23F8 :                     el2_12:	; RLC
    6999/    23F8 : 11 06 00            	ld	de, (RLC_or << 8) | 06h
    7000/    23FB :                     
    7001/    23FB :                     sr_lookfor:
    7002/    23FB : 3A 22 FF            	ld	a, (opr1_cd)	; get code number of operand No.1
    7003/    23FE : 21 3D 1E            	ld	hl, r_hl_nn
    7004/    2401 : 01 08 00            	ld	bc, sr_num
    7005/    2404 : ED B1               	cpir
    7006/    2406 : 20 0C               	jr	nz, nxt_sr
    7007/    2408 :                     
    7008/    2408 : 21 D2 23            	ld	hl, SR_base
    7009/    240B : 09                  	add	hl, bc
    7010/    240C : 7E                  	ld	a, (hl)
    7011/    240D : B2                  	or	d		; make 2nd opcode
    7012/    240E :                     
    7013/    240E :                     el2_130:
    7014/    240E : F5                  	push	af		; adjust I/F
    7015/    240F : 3E CB               	ld	a, 0cbh		; set OP code
    7016/    2411 : C3 24 22            	jp	el2_441
    7017/    2414 :                     
    7018/    2414 :                     nxt_sr:
    7019/    2414 : 21 46 1E            	ld	hl, ex_sr_
    7020/    2417 : 01 04 00            	ld	bc, ex_sr_num
    7021/    241A : ED B1               	cpir
    7022/    241C : C2 95 1A            	jp	nz, asm_err
    7023/    241F :                     
    7024/    241F : 16 FD               	ld	d, 0FDh		; for IY
    7025/    2421 : 79                  	ld	a, c
    7026/    2422 : FE 02               	cp	2
    7027/    2424 : 38 02               	jr	c, sr_iy1
    7028/    2426 : 16 DD               	ld	d, 0DDh		; for IX
    7029/    2428 :                     
    7030/    2428 :                     sr_iy1:	; D: opecode, E : code operand4
    7031/    2428 :                     
    7032/    2428 : 21 28 FF            	ld	hl, opr_num37
    7033/    242B : 09                  	add	hl, bc
    7034/    242C : 4E                  	ld	c, (hl)
    7035/    242D : 23                  	inc	hl
    7036/    242E : 46                  	ld	b, (hl)
    7037/    242F : 3E CB               	ld	a, 0CBH
    7038/    2431 :                     
    7039/    2431 :                     mc_end41:
    7040/    2431 : 2A 1D FF            	ld	hl, (tasm_adr)
    7041/    2434 : 72                  	ld	(hl), d		; save 1st MC
    7042/    2435 : 23                  	inc	hl
    7043/    2436 : 77                  	ld	(hl), a		; save 2nd MC 
    7044/    2437 : 23                  	inc	hl
    7045/    2438 : 71                  	ld	(hl), c		; save 3rd MC (8bit litelal)
    7046/    2439 : 23                  	inc	hl
    7047/    243A : 73                  	ld	(hl), e		; save 4th MC
    7048/    243B :                     mc_end4:
    7049/    243B : 3E 04               	ld	a, 4
    7050/    243D : C3 07 21            	jp	mc_end
    7051/    2440 :                     
    7052/    2440 :                     ;
    7053/    2440 :                     ; IM section
    7054/    2440 :                     ;
    7055/    2440 :                     el2_54:	; IM
    7056/    2440 : 3A 25 FF            	ld	a, (opr_num25+1)	; get high byte
    7057/    2443 : B7                  	or	a
    7058/    2444 : C2 95 1A            	jp	nz, asm_err
    7059/    2447 : 3A 24 FF            	ld	a, (opr_num25)		; get low byte
    7060/    244A : FE 03               	cp	3
    7061/    244C : D2 95 1A            	jp	nc, asm_err
    7062/    244F :                     
    7063/    244F : 0E 46               	ld	c, 046h		; IM 0
    7064/    2451 : B7                  	or	a
    7065/    2452 : 28 07               	jr	z, el2_541
    7066/    2454 :                     
    7067/    2454 : 0E 56               	ld	c, 056h		; IM 1
    7068/    2456 : 3D                  	dec	a
    7069/    2457 : 28 02               	jr	z, el2_541
    7070/    2459 : 0E 5E               	ld	c, 05Eh		; IM 2
    7071/    245B :                     
    7072/    245B :                     el2_541:
    7073/    245B : 79                  	ld	a, c
    7074/    245C :                     
    7075/    245C :                     el2_5411:
    7076/    245C : F5                  	push	af		; adjust I/F
    7077/    245D : 3E ED               	ld	a, 0EDh		; set MC 1
    7078/    245F : C3 24 22            	jp	el2_441
    7079/    2462 :                     
    7080/    2462 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    7081/    2462 :                     ; get opecode
    7082/    2462 :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    7083/    2462 :                     analize_input:
    7084/    2462 : CD 25 25            	call	sch_opecode
    7085/    2465 : D8                  	ret	c		; error return
    7086/    2466 : 32 21 FF            	ld	(opc_cd), a	; save code number of opecode
    7087/    2469 : CD 9C 24            	call	inc_element
    7088/    246C :                     
    7089/    246C : 7E                  	ld	a, (hl)
    7090/    246D : B7                  	or	a
    7091/    246E : C8                  	ret	z		; no operand
    7092/    246F : FE 20               	cp	a, ' '		; check opecode delimiter
    7093/    2471 : C2 9A 24            	jp	nz, sx_err	; not space then syntax error
    7094/    2474 :                     
    7095/    2474 :                     	; get code of operand 1
    7096/    2474 :                     
    7097/    2474 : CD A4 24            	call	analize_opr
    7098/    2477 : D8                  	ret	c		; error
    7099/    2478 : 32 22 FF            	ld	(opr1_cd), a	; save operand code to opr1
    7100/    247B : 08                  	ex	af, af'
    7101/    247C : CD 9C 24            	call	inc_element
    7102/    247F : 08                  	ex	af, af'
    7103/    2480 : FE 26               	cp	38		; check operand code 38:='"'
    7104/    2482 : C8                  	ret	z
    7105/    2483 : 7E                  	ld	a, (hl)
    7106/    2484 : B7                  	or	a
    7107/    2485 : C8                  	ret	z		; no operand2
    7108/    2486 : FE 2C               	cp	a, ','		; check opecode delimiter
    7109/    2488 : 20 10               	jr	nz, sx_err
    7110/    248A :                     
    7111/    248A :                     	; get code of operand 2
    7112/    248A :                     
    7113/    248A : CD A4 24            	call	analize_opr
    7114/    248D : D8                  	ret	c		; error
    7115/    248E : 32 23 FF            	ld	(opr2_cd), a	; save operand code to opr1
    7116/    2491 : CD 9C 24            	call	inc_element
    7117/    2494 :                     
    7118/    2494 : 7E                  	ld	a, (hl)
    7119/    2495 : B7                  	or	a
    7120/    2496 : 20 02               	jr	nz, sx_err	; error end
    7121/    2498 : C9                  	ret
    7122/    2499 :                     
    7123/    2499 :                     an_err:
    7124/    2499 : F1                  	pop	af
    7125/    249A :                     sx_err:
    7126/    249A : 37                  	scf
    7127/    249B : C9                  	ret
    7128/    249C :                     
    7129/    249C :                     inc_element:
    7130/    249C : 3A 1F FF            	ld	a, (element_cnt)
    7131/    249F : 3C                  	inc	a
    7132/    24A0 : 32 1F FF            	ld	(element_cnt), a
    7133/    24A3 : C9                  	ret
    7134/    24A4 :                     
    7135/    24A4 :                     ;------------------------
    7136/    24A4 :                     ; HL : input buffer
    7137/    24A4 :                     ;------------------------
    7138/    24A4 :                     analize_opr:
    7139/    24A4 : 23                  	inc	hl		; HL : top of operand strings point
    7140/    24A5 : CD 1B 25            	call	sch_operand1
    7141/    24A8 : D0                  	ret	nc		; match, then retrun
    7142/    24A9 :                     	
    7143/    24A9 :                     	; search (IX+, (IY+, (IX-, (IY-
    7144/    24A9 :                     
    7145/    24A9 : CD 20 25            	call	sch_operand1_1
    7146/    24AC : 38 40               	jr	c, nxt_a1	; jump, in not match
    7147/    24AE :                     
    7148/    24AE :                     	; analize "nn)"
    7149/    24AE :                     
    7150/    24AE : F5                  	push	af		; save operand code
    7151/    24AF : CD 4E 25            	call	get_number	; DE : binary
    7152/    24B2 : DA 99 24            	jp	c, an_err
    7153/    24B5 :                     	
    7154/    24B5 : 7A                  	ld	a, d
    7155/    24B6 : B7                  	or	a
    7156/    24B7 : 20 E0               	jr	nz, an_err	; over 255
    7157/    24B9 :                     	
    7158/    24B9 : 7E                  	ld	a, (hl)
    7159/    24BA : FE 29               	cp	')'
    7160/    24BC : 20 DB               	jr	nz, an_err
    7161/    24BE :                     
    7162/    24BE : 23                  	inc	hl
    7163/    24BF : F1                  	pop	af		; restore operand code
    7164/    24C0 :                     
    7165/    24C0 : F5                  	push	af
    7166/    24C1 : FE 21               	cp 	33		; IX+?
    7167/    24C3 : 20 05               	jr	nz, nxt_a2
    7168/    24C5 : 01 2B FF            	ld	bc, opr_num33
    7169/    24C8 : 18 07               	jr	nxt_a21
    7170/    24CA :                     
    7171/    24CA :                     nxt_a2:
    7172/    24CA : FE 22               	cp 	34		; IY+?
    7173/    24CC : 20 0B               	jr	nz, nxt_a3
    7174/    24CE : 01 29 FF            	ld	bc, opr_num34
    7175/    24D1 :                     
    7176/    24D1 :                     nxt_a21:
    7177/    24D1 : 7B                  	ld	a, e
    7178/    24D2 : FE 80               	cp	80H
    7179/    24D4 : 30 C3               	jr	nc, an_err
    7180/    24D6 :                     
    7181/    24D6 :                     nxt_a22:
    7182/    24D6 : 02                  	ld	(bc),a		; save binary
    7183/    24D7 : F1                  	pop	af
    7184/    24D8 : C9                  	ret
    7185/    24D9 :                     	
    7186/    24D9 :                     nxt_a3:
    7187/    24D9 : FE 24               	cp 	36		; IX-?
    7188/    24DB : 20 0C               	jr	nz, nxt_a4
    7189/    24DD : 01 2A FF            	ld	bc, opr_num36
    7190/    24E0 :                     
    7191/    24E0 :                     nxt_a31:
    7192/    24E0 : 7B                  	ld	a, e
    7193/    24E1 : FE 81               	cp	81H
    7194/    24E3 : 30 B4               	jr	nc, an_err
    7195/    24E5 : ED 44               	neg
    7196/    24E7 : 18 ED               	jr	nxt_a22
    7197/    24E9 :                     	
    7198/    24E9 :                     nxt_a4:	; IY-
    7199/    24E9 : 01 28 FF            	ld	bc, opr_num37
    7200/    24EC : 18 F2               	jr	nxt_a31
    7201/    24EE :                     
    7202/    24EE :                     ; check '('
    7203/    24EE :                     nxt_a1:
    7204/    24EE : 7E                  	ld	a, (hl)
    7205/    24EF : FE 28               	cp	'('
    7206/    24F1 : 20 12               	jr	nz, chk_strings
    7207/    24F3 :                     	
    7208/    24F3 :                     	; get number
    7209/    24F3 :                     	
    7210/    24F3 : 23                  	inc	hl
    7211/    24F4 : CD 4E 25            	call	get_number
    7212/    24F7 : D8                  	ret	c		; error number
    7213/    24F8 :                     
    7214/    24F8 : 7E                  	ld	a, (hl)
    7215/    24F9 : FE 29               	cp	')'
    7216/    24FB : 20 9D               	jr	nz, sx_err
    7217/    24FD :                     
    7218/    24FD : 23                  	inc	hl
    7219/    24FE : ED 53 26 FF         	ld	(opr_num35),de	; save binary
    7220/    2502 : 3E 23               	ld	a, 35		; set operand code
    7221/    2504 : C9                  	ret			; normal end
    7222/    2505 :                     
    7223/    2505 :                     chk_strings:
    7224/    2505 : FE 22               	cp	'"'
    7225/    2507 : 20 07               	jr	nz, only_num
    7226/    2509 : 23                  	inc	hl
    7227/    250A : 22 24 FF            	ld	(opr_num25), hl
    7228/    250D : 3E 26               	ld	a, 38
    7229/    250F : C9                  	ret
    7230/    2510 :                     
    7231/    2510 :                     only_num:
    7232/    2510 : CD 4E 25            	call	get_number
    7233/    2513 : D8                  	ret	c		; error number
    7234/    2514 : ED 53 24 FF         	ld	(opr_num25),de	; save binary
    7235/    2518 : 3E 19               	ld	a, 25		; set operand code
    7236/    251A : C9                  	ret			; normal end
    7237/    251B :                     
    7238/    251B :                     ;------------------
    7239/    251B :                     ; HL : input buffer
    7240/    251B :                     ;------------------
    7241/    251B :                     sch_operand1:
    7242/    251B : 11 B4 19            	ld	de, operand_cds
    7243/    251E : 18 0B               	jr	sh_0
    7244/    2520 :                     
    7245/    2520 :                     ;------------------
    7246/    2520 :                     ; HL : input buffer
    7247/    2520 :                     ; search (IX+, (IY+, (IX-, (IY-
    7248/    2520 :                     ;------------------
    7249/    2520 :                     sch_operand1_1:
    7250/    2520 : 11 14 1A            	ld	de, opr_cd1
    7251/    2523 : 18 06               	jr	sh_0
    7252/    2525 :                     
    7253/    2525 :                     ;----------------------------------------------------------
    7254/    2525 :                     ; Search code number of opecode from input strings
    7255/    2525 :                     ; 
    7256/    2525 :                     ; output:
    7257/    2525 :                     ; if mach opecode ; HL : next point of input strings
    7258/    2525 :                     ;		    A  : a code number of opecode
    7259/    2525 :                     ; not mach	  ; CF = 1
    7260/    2525 :                     ;----------------------------------------------------------
    7261/    2525 :                     sch_opecode:
    7262/    2525 : 21 CE FF            	ld	hl, line_buf
    7263/    2528 : 11 97 18            	ld	de, ope_cds
    7264/    252B :                     
    7265/    252B :                     sh_0:
    7266/    252B : E5                  	push	hl
    7267/    252C :                     sh_1:
    7268/    252C : 1A                  	ld	a, (de)
    7269/    252D : BE                  	cp	(hl)
    7270/    252E : 20 04               	jr	nz, sch_next
    7271/    2530 :                     	
    7272/    2530 :                     	; match
    7273/    2530 : 23                  	inc	hl
    7274/    2531 : 13                  	inc	de
    7275/    2532 : 18 F8               	jr	sh_1
    7276/    2534 :                     
    7277/    2534 :                     sch_next:
    7278/    2534 : E6 80               	and	dm_bit		; delimiter?
    7279/    2536 : 20 0E               	jr	nz, ok_match
    7280/    2538 :                     	
    7281/    2538 :                     skip_next:
    7282/    2538 : 13                  	inc	de
    7283/    2539 : 1A                  	ld	a, (de)
    7284/    253A : E6 80               	and	dm_bit
    7285/    253C : 28 FA               	jr	z, skip_next
    7286/    253E :                     
    7287/    253E :                     	; detect delimiter string
    7288/    253E :                     
    7289/    253E : 13                  	inc	de		; next search strings
    7290/    253F :                     	
    7291/    253F : 1A                  	ld	a, (de)
    7292/    2540 : B7                  	or	a		; tabel end?
    7293/    2541 : 28 08               	jr	z, n_end	; yes, no match return
    7294/    2543 :                     
    7295/    2543 : E1                  	pop	hl
    7296/    2544 : 18 E5               	jr	sh_0		; search again
    7297/    2546 :                     
    7298/    2546 :                     	; match opecode strings
    7299/    2546 :                     	; a : opecode number
    7300/    2546 :                     
    7301/    2546 :                     ok_match:
    7302/    2546 : 1A                  	ld	a, (de)
    7303/    2547 : E6 7F               	and	a, 7Fh		; mask dm_bit, get code of opecode
    7304/    2549 : D1                  	pop	de		; discard top string address
    7305/    254A : C9                  	ret
    7306/    254B :                     	
    7307/    254B :                     ; no opecode strings maching
    7308/    254B :                     n_end:
    7309/    254B : E1                  	pop	hl
    7310/    254C : 37                  	scf
    7311/    254D : C9                  	ret
    7312/    254E :                     
    7313/    254E :                     ;---------------------
    7314/    254E :                     ; HL : string buffer
    7315/    254E :                     ;
    7316/    254E :                     ; output : de or CF
    7317/    254E :                     ;----------------------
    7318/    254E :                     get_number:
    7319/    254E :                     
    7320/    254E : 11 F1 FF            	ld	de, num_string
    7321/    2551 : 0E 00               	ld	c, 0
    7322/    2553 :                     	
    7323/    2553 :                     ; check first character
    7324/    2553 :                     
    7325/    2553 : CD 90 25            	call	dec_chr		; check decimal chrarcter
    7326/    2556 : D8                  	ret	c		; no number inputs detect
    7327/    2557 :                     
    7328/    2557 :                     ;  detect 1st number( only 0 to 9 )
    7329/    2557 :                     
    7330/    2557 : 12                  	ld	(de), a		; save to buffer
    7331/    2558 : 13                  	inc	de
    7332/    2559 : 23                  	inc	hl
    7333/    255A : 0C                  	inc	c
    7334/    255B :                     
    7335/    255B :                     ; check 2nd, 3rd, 4th, 5th number string
    7336/    255B :                     
    7337/    255B :                     lop_gnum:
    7338/    255B : CD 9A 25            	call	hex_chr
    7339/    255E : 38 0B               	jr	c, ck_endmk	; no number inputs detect
    7340/    2560 :                     
    7341/    2560 :                     ; detect 2nd, 3rd, 4th, 5th number (include A to F)
    7342/    2560 :                     
    7343/    2560 : 12                  	ld	(de), a		; save to buffer
    7344/    2561 : 13                  	inc	de
    7345/    2562 : 23                  	inc	hl
    7346/    2563 : 0C                  	inc	c
    7347/    2564 : 79                  	ld	a, c
    7348/    2565 : FE 07               	cp	NUMLEN		; buffer check
    7349/    2567 : 28 2F               	jr	z, no_num	; overfllow. error return
    7350/    2569 : 18 F0               	jr	lop_gnum
    7351/    256B :                     
    7352/    256B :                     ck_endmk:
    7353/    256B : 08                  	ex	af, af'
    7354/    256C : AF                  	xor	a
    7355/    256D : 12                  	ld	(de), a		; set delimiter
    7356/    256E : 08                  	ex	af, af'
    7357/    256F : FE 48               	cp	'H'		; check hex?
    7358/    2571 : 28 0B               	jr	z, bi_hex
    7359/    2573 :                     
    7360/    2573 :                     ;	get binary from decimal string
    7361/    2573 :                     ;bi_dec:
    7362/    2573 : E5                  	push	hl
    7363/    2574 : 21 F1 FF            	ld	hl, num_string
    7364/    2577 : CD 0E 03            	call	GET_dNUM	; return bc
    7365/    257A : E1                  	pop	hl
    7366/    257B : 50                  	ld	d, b		; set binary to DE
    7367/    257C : 59                  	ld	e, c		; set binary to DE
    7368/    257D : C9                  	ret
    7369/    257E :                     
    7370/    257E :                     ;	ret	nc		; if CF =1, try hex to bin
    7371/    257E :                     ;	dec	hl		; adjust hl pointer
    7372/    257E :                     
    7373/    257E :                     	;hex to binary
    7374/    257E :                     bi_hex:
    7375/    257E : 23                  	inc	hl
    7376/    257F : E5                  	push	hl
    7377/    2580 : 21 F1 FF            	ld	hl, num_string
    7378/    2583 : CD 15 27            	call	RDHEX		; get binary to DE
    7379/    2586 : E1                  	pop	hl
    7380/    2587 : B7                  	or	a		; clear CF
    7381/    2588 : C9                  	ret
    7382/    2589 :                     
    7383/    2589 :                     ;--------------------------
    7384/    2589 :                     ; skip sp
    7385/    2589 :                     ;--------------------------
    7386/    2589 :                     skp_sp:
    7387/    2589 : 7E                  	ld	a, (hl)
    7388/    258A : FE 20               	cp	' '
    7389/    258C : C0                  	ret	nz
    7390/    258D : 23                  	inc	hl
    7391/    258E : 18 F9               	jr	skp_sp
    7392/    2590 :                     
    7393/    2590 :                     ;--------------------------
    7394/    2590 :                     ; check decimal char
    7395/    2590 :                     ;--------------------------
    7396/    2590 :                     dec_chr:
    7397/    2590 : 7E                  	ld	a, (hl)
    7398/    2591 : FE 3A               	cp	':'
    7399/    2593 : 30 03               	jr	nc, no_num
    7400/    2595 : FE 30               	cp	'0'
    7401/    2597 : D0                  	ret	nc
    7402/    2598 :                     	
    7403/    2598 : 37                  no_num:	scf
    7404/    2599 : C9                  	ret
    7405/    259A :                     
    7406/    259A :                     ;--------------------------
    7407/    259A :                     ; check HEX char
    7408/    259A :                     ;--------------------------
    7409/    259A :                     hex_chr:
    7410/    259A : 7E                  	ld	a, (hl)
    7411/    259B : FE 30               	cp	'0'
    7412/    259D : D8                  	ret	c	; error return
    7413/    259E : FE 3A               	cp	'9'+1
    7414/    25A0 : 38 07               	jr	c, dec_num
    7415/    25A2 : FE 41               	cp	'A'
    7416/    25A4 : D8                  	ret	c	; error return
    7417/    25A5 : FE 47               	cp	'F'+1
    7418/    25A7 : 30 EF               	jr	nc, no_num
    7419/    25A9 :                     dec_num:
    7420/    25A9 : B7                  	or	a	; clear carry
    7421/    25AA : C9                  	ret
    7422/    25AB :                     
    7423/    25AB :                     ;--------------------------------------
    7424/    25AB :                     ; 2 byte machine code branch
    7425/    25AB :                     ; - 2nd byte is Relative address
    7426/    25AB :                     ; - output a = (e-2) relative number
    7427/    25AB :                     ;          CF=1 : target address error
    7428/    25AB :                     ;--------------------------------------
    7429/    25AB :                     calc_reladr:
    7430/    25AB : E5                  	push	hl
    7431/    25AC : D5                  	push	de
    7432/    25AD :                     
    7433/    25AD : ED 5B 1D FF         	ld	de, (tasm_adr)	; base address
    7434/    25B1 : 13                  	inc	de
    7435/    25B2 : 13                  	inc	de
    7436/    25B3 : 2A 24 FF            	ld	hl, (opr_num25)	; target address
    7437/    25B6 : AF                  	xor	a
    7438/    25B7 : ED 52               	sbc	hl, de
    7439/    25B9 : 7D                  	ld	a, l
    7440/    25BA : 38 08               	jr	c, cal_1	; CF=1 :target address is lower
    7441/    25BC :                     
    7442/    25BC : FE 80               	cp	80H
    7443/    25BE : 30 12               	jr	nc, adr_ovr
    7444/    25C0 : B7                  	or	a
    7445/    25C1 :                     
    7446/    25C1 :                     cal_01:
    7447/    25C1 : D1                  	pop	de
    7448/    25C2 : E1                  	pop	hl
    7449/    25C3 : C9                  	ret
    7450/    25C4 :                     
    7451/    25C4 :                     cal_1:
    7452/    25C4 : 7C                  	ld	a, h
    7453/    25C5 : FE FF               	cp	0ffh
    7454/    25C7 : 20 09               	jr	nz, adr_ovr
    7455/    25C9 : 7D                  	ld	a, l
    7456/    25CA : ED 44               	neg
    7457/    25CC : FE 81               	cp	81h
    7458/    25CE : 7D                  	ld	a, l
    7459/    25CF : 3F                  	ccf
    7460/    25D0 : 18 EF               	jr	cal_01
    7461/    25D2 :                     
    7462/    25D2 :                     adr_ovr:
    7463/    25D2 : 37                  	scf
    7464/    25D3 : 18 EC               	jr	cal_01
    7465/    25D5 :                     
    7466/    25D5 :                     ;-----------------------------
    7467/    25D5 :                     ;
    7468/    25D5 :                     ; Recorrect input strings
    7469/    25D5 :                     ;
    7470/    25D5 :                     ;-----------------------------
    7471/    25D5 :                     recorrect:
    7472/    25D5 : E5                  	push	hl
    7473/    25D6 : D5                  	push	de
    7474/    25D7 : C5                  	push	bc
    7475/    25D8 :                     
    7476/    25D8 : 21 CE FF            	ld	hl, line_buf
    7477/    25DB : 54                  	ld	d, h
    7478/    25DC : 5D                  	ld	e, l
    7479/    25DD :                     
    7480/    25DD : 0E 20               	ld	c, ' '		; space delimitor. (opecode and operand)
    7481/    25DF : CD 89 25            	call	skp_sp
    7482/    25E2 : CD FA 25            	call	recorr
    7483/    25E5 : B7                  	or	a
    7484/    25E6 : 28 0E               	jr	z, gle_end
    7485/    25E8 :                     
    7486/    25E8 : 0E 00               	ld	c, 0		; end delimitor. (end strings)
    7487/    25EA : 23                  	inc	hl
    7488/    25EB : CD 89 25            	call	skp_sp
    7489/    25EE : B7                  	or	a
    7490/    25EF : 28 03               	jr	z, gle_end1
    7491/    25F1 : CD FA 25            	call	recorr
    7492/    25F4 :                     
    7493/    25F4 :                     gle_end1:
    7494/    25F4 : 1B                  	dec	de
    7495/    25F5 : 12                  	ld	(de), a		; replace space to 0
    7496/    25F6 :                     gle_end:
    7497/    25F6 : C1                  	pop	bc
    7498/    25F7 : D1                  	pop	de
    7499/    25F8 : E1                  	pop	hl
    7500/    25F9 : C9                  	ret
    7501/    25FA :                     
    7502/    25FA :                     ; extract space from input buffer
    7503/    25FA :                     recorr:
    7504/    25FA : 06 00               	ld	b, 0
    7505/    25FC :                     recorr1:
    7506/    25FC : 12                  	ld	(de), a
    7507/    25FD : 13                  	inc	de
    7508/    25FE : B7                  	or	a
    7509/    25FF : C8                  	ret	z
    7510/    2600 : B9                  	cp	c
    7511/    2601 : C8                  	ret	z
    7512/    2602 :                     
    7513/    2602 :                     next_char:
    7514/    2602 : FE 22               	cp	'"'
    7515/    2604 : 20 06               	jr	nz, nxchr
    7516/    2606 :                     
    7517/    2606 : 08                  	ex	af, af'		;'
    7518/    2607 : 78                  	ld	a, b
    7519/    2608 : EE 01               	xor	a, 1
    7520/    260A : 47                  	ld	b, a		; toggle '"' flag
    7521/    260B : 08                  	ex	af, af'		;'
    7522/    260C :                     ;"	
    7523/    260C :                     nxchr:
    7524/    260C : 23                  	inc	hl
    7525/    260D : 7E                  	ld	a, (hl)
    7526/    260E : B9                  	cp	c
    7527/    260F : 28 EB               	jr	z, recorr1
    7528/    2611 : CB 40               	bit	0, b
    7529/    2613 : 20 E7               	jr	nz, recorr1
    7530/    2615 :                     
    7531/    2615 : FE 20               	cp	' '
    7532/    2617 : 28 E9               	jr	z, next_char
    7533/    2619 : 18 E1               	jr	recorr1
    7534/    261B :                     	
    7535/    261B :                     ;;;
    7536/    261B :                     ;;; Other support routines
    7537/    261B :                     ;;;
    7538/    261B :                     
    7539/    261B :                     STROUT:
    7540/    261B : 7E                  	LD	A,(HL)
    7541/    261C : A7                  	AND	A
    7542/    261D : C8                  	RET	Z
    7543/    261E : CD 8B 2E            	CALL	CONOUT
    7544/    2621 : 23                  	INC	HL
    7545/    2622 : 18 F7               	JR	STROUT
    7546/    2624 :                     
    7547/    2624 :                     ; input:  HL
    7548/    2624 :                     ; output: 4 hex_char output console
    7549/    2624 :                     
    7550/    2624 :                     HEXOUT4:
    7551/    2624 : 7C                  	LD	A,H
    7552/    2625 : CD 29 26            	CALL	HEXOUT2
    7553/    2628 : 7D                  	LD	A,L
    7554/    2629 :                     
    7555/    2629 :                     ; input:  A
    7556/    2629 :                     ; output: 2 hex_char output console
    7557/    2629 :                     HEXOUT2:
    7558/    2629 : F5                  	PUSH	AF
    7559/    262A : 1F                  	RRA
    7560/    262B : 1F                  	RRA
    7561/    262C : 1F                  	RRA
    7562/    262D : 1F                  	RRA
    7563/    262E : CD 32 26            	CALL	HEXOUT1
    7564/    2631 : F1                  	POP	AF
    7565/    2632 :                     
    7566/    2632 :                     ; input:  A
    7567/    2632 :                     ; output: 1 hex_char output console
    7568/    2632 :                     HEXOUT1:
    7569/    2632 : E6 0F               	AND	0FH
    7570/    2634 : C6 30               	ADD	A,'0'
    7571/    2636 : FE 3A               	CP	'9'+1
    7572/    2638 : DA 8B 2E            	JP	C,CONOUT
    7573/    263B : C6 07               	ADD	A,'A'-'9'-1
    7574/    263D : C3 8B 2E            	JP	CONOUT
    7575/    2640 :                     
    7576/    2640 :                     HEXIN:
    7577/    2640 : AF                  	XOR	A
    7578/    2641 : CD 48 26            	CALL	HI0
    7579/    2644 : 07                  	RLCA
    7580/    2645 : 07                  	RLCA
    7581/    2646 : 07                  	RLCA
    7582/    2647 : 07                  	RLCA
    7583/    2648 :                     HI0:
    7584/    2648 : C5                  	PUSH	BC
    7585/    2649 : 4F                  	LD	C,A
    7586/    264A : CD 3C 2E            	CALL	CONIN
    7587/    264D : FE 30               	CP	'0'
    7588/    264F : 38 11               	JR	C,HIR
    7589/    2651 : FE 3A               	CP	'9'+1
    7590/    2653 : 38 0A               	JR	C,HI1
    7591/    2655 : FE 41               	CP	'A'
    7592/    2657 : 38 09               	JR	C,HIR
    7593/    2659 : FE 47               	CP	'F'+1
    7594/    265B : 30 05               	JR	NC,HIR
    7595/    265D : D6 07               	SUB	'A'-'9'-1
    7596/    265F :                     HI1:
    7597/    265F : D6 30               	SUB	'0'
    7598/    2661 : B1                  	OR	C
    7599/    2662 :                     HIR:
    7600/    2662 : C1                  	POP	BC
    7601/    2663 : C9                  	RET
    7602/    2664 :                     	
    7603/    2664 :                     CRLF:
    7604/    2664 : 3E 0D               	LD	A,CR
    7605/    2666 : CD 8B 2E            	CALL	CONOUT
    7606/    2669 : 3E 0A               	LD	A,LF
    7607/    266B : C3 8B 2E            	JP	CONOUT
    7608/    266E :                     
    7609/    266E :                     CLR_CRT:
    7610/    266E : E5                  	PUSH	HL
    7611/    266F : 21 77 26            	LD	HL, ESC_CRT_CLR
    7612/    2672 : CD 1B 26            	CALL	STROUT
    7613/    2675 : E1                  	POP	HL
    7614/    2676 : C9                  	RET
    7615/    2677 :                     	
    7616/    2677 :                     ESC_CRT_CLR:
    7617/    2677 : 1B                  	db	01BH
    7618/    2678 : 5B 32               	db	"[2"
    7619/    267A : 00                  	db	0
    7620/    267B :                     
    7621/    267B :                     GETLIN:
    7622/    267B : 21 CE FF            	LD	HL,INBUF
    7623/    267E : 06 28               	ld	b, BUFLEN
    7624/    2680 :                     
    7625/    2680 :                     GL0:	; input hl
    7626/    2680 :                     
    7627/    2680 : D5                  	PUSH	de
    7628/    2681 : E5                  	push	hl
    7629/    2682 : 58                  	ld	e, b	; E: buffer length
    7630/    2683 : 1D                  	dec	e	; buffer lenght -1
    7631/    2684 : 06 00               	LD	B,0
    7632/    2686 :                     
    7633/    2686 :                     GL00:
    7634/    2686 : CD 3C 2E            	CALL	CONIN
    7635/    2689 : FE 0D               	CP	CR
    7636/    268B : 28 5A               	JR	Z,GLE
    7637/    268D : FE 0A               	CP	LF
    7638/    268F : 28 56               	JR	Z,GLE
    7639/    2691 : FE 08               	CP	BS
    7640/    2693 : 28 3B               	JR	Z,GLB
    7641/    2695 : FE 7F               	CP	DEL
    7642/    2697 : 28 37               	JR	Z,GLB
    7643/    2699 : FE 22               	cp	'"'
    7644/    269B : 20 0A               	jr	nz, GL001
    7645/    269D : F5                  	push	af
    7646/    269E : 3A 39 FF            	ld	a, (ky_flg)
    7647/    26A1 : EE 04               	xor	NO_UPPER	; toggle UPPER or NO UPPER
    7648/    26A3 : 32 39 FF            	ld	(ky_flg), a
    7649/    26A6 : F1                  	pop	af
    7650/    26A7 :                     
    7651/    26A7 : FE 20               GL001:	CP	' '
    7652/    26A9 : 38 DB               	JR	C,GL00
    7653/    26AB : FE 80               	CP	80H
    7654/    26AD : 30 D7               	JR	NC,GL00
    7655/    26AF : 4F                  	LD	C,A
    7656/    26B0 : 78                  	LD	A,B
    7657/    26B1 : BB                  	CP	e	; buffer full check
    7658/    26B2 : 30 D2               	JR	NC,GL00	; Too long
    7659/    26B4 : 04                  	INC	B
    7660/    26B5 : 79                  	LD	A,C
    7661/    26B6 : CD 8B 2E            	CALL	CONOUT
    7662/    26B9 : FE 61               	cp	'a'
    7663/    26BB : 38 0F               	jr	c, GL1
    7664/    26BD : FE 7B               	cp	'z'+1
    7665/    26BF : 30 0B               	jr	nc, GL1
    7666/    26C1 :                     
    7667/    26C1 : E5                  	push	hl
    7668/    26C2 : 21 39 FF            	ld	hl, ky_flg
    7669/    26C5 : CB 56               	bit	NO_UPPER>>1, (hl)
    7670/    26C7 : 20 02               	jr	nz, skip_upper
    7671/    26C9 : E6 DF               	and	0DFH	; make upper code
    7672/    26CB :                     skip_upper:
    7673/    26CB : E1                  	pop	hl
    7674/    26CC :                     GL1:
    7675/    26CC : 77                  	LD	(HL),A
    7676/    26CD : 23                  	INC	HL
    7677/    26CE : 18 B6               	JR	GL00
    7678/    26D0 :                     GLB:
    7679/    26D0 : 78                  	LD	A,B
    7680/    26D1 : A7                  	AND	A
    7681/    26D2 : 28 B2               	JR	Z,GL00
    7682/    26D4 : 05                  	DEC	B
    7683/    26D5 : 2B                  	DEC	HL
    7684/    26D6 : 3E 08               	LD	A,08H
    7685/    26D8 : CD 8B 2E            	CALL	CONOUT
    7686/    26DB : 3E 20               	LD	A,' '
    7687/    26DD : CD 8B 2E            	CALL	CONOUT
    7688/    26E0 : 3E 08               	LD	A,08H
    7689/    26E2 : CD 8B 2E            	CALL	CONOUT
    7690/    26E5 : 18 9F               	JR	GL00
    7691/    26E7 :                     GLE:
    7692/    26E7 : E5                  	push	hl
    7693/    26E8 : 21 39 FF            	ld	hl, ky_flg
    7694/    26EB : CB 46               	bit	NO_CR>>1, (hl)
    7695/    26ED : 20 05               	jr	nz, skip_cr
    7696/    26EF : 3E 0D               	ld	a, CR
    7697/    26F1 : CD 8B 2E            	call	CONOUT
    7698/    26F4 :                     skip_cr:
    7699/    26F4 : CB 4E               	bit	NO_LF>>1, (hl)
    7700/    26F6 : 20 05               	jr	nz, skip_lf
    7701/    26F8 : 3E 0A               	ld	a, LF
    7702/    26FA : CD 8B 2E            	call	CONOUT
    7703/    26FD :                     skip_lf:
    7704/    26FD : CB 96               	res	NO_UPPER>>1,(HL)	; set upper flag
    7705/    26FF : E1                  	pop	hl
    7706/    2700 : 36 00               	LD	(HL),00H
    7707/    2702 :                     
    7708/    2702 : E1                  	pop	hl
    7709/    2703 : D1                  	POP	de
    7710/    2704 : C9                  	RET
    7711/    2705 :                     
    7712/    2705 :                     SKIPSP:
    7713/    2705 : 7E                  	LD	A,(HL)
    7714/    2706 : FE 20               	CP	' '
    7715/    2708 : C0                  	RET	NZ
    7716/    2709 : 23                  	INC	HL
    7717/    270A : 18 F9               	JR	SKIPSP
    7718/    270C :                     
    7719/    270C :                     UPPER:
    7720/    270C : FE 61               	CP	'a'
    7721/    270E : D8                  	RET	C
    7722/    270F : FE 7B               	CP	'z'+1
    7723/    2711 : D0                  	RET	NC
    7724/    2712 : C6 E0               	ADD	A,'A'-'a'
    7725/    2714 : C9                  	RET
    7726/    2715 :                     
    7727/    2715 :                     RDHEX:
    7728/    2715 : 0E 00               	LD	C,0
    7729/    2717 : 11 00 00            	LD	DE,0
    7730/    271A :                     RH0:
    7731/    271A : 7E                  	LD	A,(HL)
    7732/    271B : FE 30               	CP	'0'
    7733/    271D : 38 2C               	JR	C,RHE
    7734/    271F : FE 3A               	CP	'9'+1
    7735/    2721 : 38 0A               	JR	C,RH1
    7736/    2723 : FE 41               	CP	'A'
    7737/    2725 : 38 24               	JR	C,RHE
    7738/    2727 : FE 47               	CP	'F'+1
    7739/    2729 : 30 20               	JR	NC,RHE
    7740/    272B : D6 07               	SUB	'A'-'9'-1
    7741/    272D :                     RH1:
    7742/    272D : D6 30               	SUB	'0'
    7743/    272F : 17                  	RLA
    7744/    2730 : 17                  	RLA
    7745/    2731 : 17                  	RLA
    7746/    2732 : 17                  	RLA
    7747/    2733 : 17                  	RLA
    7748/    2734 : CB 13               	RL	E
    7749/    2736 : CB 12               	RL	D
    7750/    2738 : 17                  	RLA
    7751/    2739 : CB 13               	RL	E
    7752/    273B : CB 12               	RL	D
    7753/    273D : 17                  	RLA
    7754/    273E : CB 13               	RL	E
    7755/    2740 : CB 12               	RL	D
    7756/    2742 : 17                  	RLA
    7757/    2743 : CB 13               	RL	E
    7758/    2745 : CB 12               	RL	D
    7759/    2747 : 23                  	INC	HL
    7760/    2748 : 0C                  	INC	C
    7761/    2749 : 18 CF               	JR	RH0
    7762/    274B :                     RHE:
    7763/    274B : 79                  	ld	a, c
    7764/    274C : B7                  	or	a
    7765/    274D : 28 06               	jr	z, rhe1
    7766/    274F : FE 05               	cp	5
    7767/    2751 : 30 02               	jr	nc, rhe1
    7768/    2753 : B7                  	or	a	; clear carry
    7769/    2754 : C9                  	ret
    7770/    2755 :                     	
    7771/    2755 :                     rhe1:
    7772/    2755 : 37                  	scf	; set carry
    7773/    2756 : C9                  	RET
    7774/    2757 :                     
    7775/    2757 :                     ;;;
    7776/    2757 :                     ;;; API Handler
    7777/    2757 :                     ;;:   C : API entory NO.
    7778/    2757 :                     ;;;
    7779/    2757 :                     
    7780/    2757 :                     RST30H_IN:
    7781/    2757 :                     
    7782/    2757 : E5                  	PUSH	HL
    7783/    2758 : C5                  	PUSH	BC
    7784/    2759 : 21 74 27            	LD	HL,APITBL
    7785/    275C : 06 00               	LD	B,0
    7786/    275E : 09                  	ADD	HL,BC
    7787/    275F : 09                  	ADD	HL,BC
    7788/    2760 :                     
    7789/    2760 : 01 A0 27            	ld	bc, APITBL_E
    7790/    2763 : B7                  	or	a
    7791/    2764 : E5                  	push	hl
    7792/    2765 : ED 42               	sbc	hl, bc
    7793/    2767 : E1                  	pop	hl
    7794/    2768 : 30 07               	jr	nc, no_api	; request No. is not exist
    7795/    276A :                     
    7796/    276A : 46                  	LD	B,(HL)
    7797/    276B : 23                  	INC	HL
    7798/    276C : 66                  	LD	H,(HL)
    7799/    276D : 68                  	LD	L,B
    7800/    276E :                     
    7801/    276E : C1                  	POP	BC
    7802/    276F : E3                  	EX	(SP),HL		; Restore HL, jump address on stack top
    7803/    2770 :                     no_operate:
    7804/    2770 : C9                  	RET
    7805/    2771 :                     
    7806/    2771 :                     no_api:
    7807/    2771 : C1                  	pop	bc
    7808/    2772 : E1                  	pop	hl
    7809/    2773 : C9                  	ret
    7810/    2774 :                     
    7811/    2774 :                     APITBL:
    7812/    2774 : FD 00               	DW	START		; 00: SINIT
    7813/    2776 : A0 27               	DW	API01		; 01: WSTART
    7814/    2778 : 8B 2E               	DW	CONOUT		; 02: CONOUT
    7815/    277A : 1B 26               	DW	STROUT		; 03: STROUT
    7816/    277C : 3C 2E               	DW	CONIN		; 04: CONIN
    7817/    277E : 86 2E               	DW	CONST		; 05: CONST
    7818/    2780 : E2 27               	DW	API06		; 06: PSPEC
    7819/    2782 : 24 26               	DW	HEXOUT4		; 07: CONOUT HEX4bytes: input HL
    7820/    2784 : 29 26               	DW	HEXOUT2		; 08: CONOUT HEX2bytes: input A
    7821/    2786 : 32 26               	DW	HEXOUT1		; 09: CONOUT HEX1byte : input A
    7822/    2788 : 6E 26               	DW	CLR_CRT		; 10: Clear screen (ESC+[2)
    7823/    278A : 80 26               	DW	GL0		; 11: GET a line.  input HL : input buffer address)
    7824/    278C :                     				;                         B : buffer length
    7825/    278C :                     				;                  output B : length of strings
    7826/    278C : 05 27               	DW	SKIPSP		; 12: SKIP Spase
    7827/    278E : 64 26               	DW	CRLF		; 13: CONOUT CRLF
    7828/    2790 : 0C 27               	DW	UPPER		; 14: Lower to UPPER
    7829/    2792 : 15 27               	DW	RDHEX		; 15: get hex number from chr buffer
    7830/    2794 :                     				;     input  HL : hex string buffer
    7831/    2794 :                     				;     output DE : hex number
    7832/    2794 :                     				;            CF=1 : error, C, A = hex counts(1-4)
    7833/    2794 : 19 29               	DW	DEC_STR		; 16: get decimal srtings
    7834/    2796 :                     				; input hl : return strings buffer addr.
    7835/    2796 :                     				;       de : 16bit binary
    7836/    2796 : 4F 29               	DW	DIV16_8		; 17; division 16bit / 8bit
    7837/    2798 : C5 29               	DW	MUL_8		; 18: multiply 8bit * 8bit
    7838/    279A : 70 27               	DW	no_operate	; 19: no operation
    7839/    279C : 46 09               	dw	get_disasm_st	; 20: dis assemble string
    7840/    279E :                     				;     input: HL buffer. need 42bytes
    7841/    279E :                     				;     output : DE : next MC address
    7842/    279E :                     				;              A  : disassembled MC size
    7843/    279E : 0E 03               	dw	GET_dNUM	; 21: get number from decimal strings
    7844/    27A0 :                     				;     input HL : string buffer
    7845/    27A0 :                     				;     Return
    7846/    27A0 :                     				;        CF =1 : Error
    7847/    27A0 :                     				;        BC: Calculation result
    7848/    27A0 :                     APITBL_E:
    7849/    27A0 :                     
    7850/    27A0 :                     	;; WSTART from API
    7851/    27A0 :                     API01:
    7852/    27A0 : 31 D0 FE            	LD	SP,STACKM	; reset SP for monitor
    7853/    27A3 :                     
    7854/    27A3 :                     ; check stop by bp and trace operation
    7855/    27A3 :                     
    7856/    27A3 : 3A 06 FF            	ld	a, (tmpb_f)
    7857/    27A6 : B7                  	or	a
    7858/    27A7 : 28 06               	jr	z, ws_chk1
    7859/    27A9 : 21 07 FF            	ld	hl, tmpb_op
    7860/    27AC : CD D1 28            	call	rstr_tpt
    7861/    27AF :                     ws_chk1:
    7862/    27AF : 3A F6 FE            	ld	a, (tpt1_f)
    7863/    27B2 : B7                  	or	a
    7864/    27B3 : 28 06               	jr	z, ws_chk2
    7865/    27B5 : 21 F7 FE            	ld	hl, tpt1_op
    7866/    27B8 : CD D1 28            	call	rstr_tpt
    7867/    27BB :                     
    7868/    27BB :                     ws_chk2:
    7869/    27BB : 3A FA FE            	ld	a, (tpt2_f)
    7870/    27BE : B7                  	or	a
    7871/    27BF : 28 06               	jr	z, ws_chk3
    7872/    27C1 : 21 FB FE            	ld	hl, tpt2_op
    7873/    27C4 : CD D1 28            	call	rstr_tpt
    7874/    27C7 :                     ws_chk3:
    7875/    27C7 : 3A 02 FF            	ld	a, (bpt2_f)
    7876/    27CA : B7                  	or	a
    7877/    27CB : 28 06               	jr	z, ws_chk4
    7878/    27CD : 21 03 FF            	ld	hl, bpt2_op
    7879/    27D0 : CD DD 28            	call	rstr_bpt
    7880/    27D3 :                     ws_chk4:
    7881/    27D3 : 3A FE FE            	ld	a, (bpt1_f)
    7882/    27D6 : B7                  	or	a
    7883/    27D7 : 28 06               	jr	z, ws_chk5
    7884/    27D9 : 21 FF FE            	ld	hl, bpt1_op
    7885/    27DC : CD DD 28            	call	rstr_bpt
    7886/    27DF :                     ws_chk5:
    7887/    27DF : C3 A7 28            	JP	backTomon
    7888/    27E2 :                     
    7889/    27E2 :                     	;; PSPEC
    7890/    27E2 :                     API06:
    7891/    27E2 : AF                  	XOR	A
    7892/    27E3 : C9                  	RET
    7893/    27E4 :                     
    7894/    27E4 :                     ;;;
    7895/    27E4 :                     ;;; Break Point
    7896/    27E4 :                     ;;; trace Point
    7897/    27E4 :                     ;;; go, stop point
    7898/    27E4 :                     ;;; operation handler
    7899/    27E4 :                     ;;
    7900/    27E4 :                     RST38H_IN:
    7901/    27E4 : F5                  	PUSH	AF
    7902/    27E5 : ED 5F               	LD	A,R
    7903/    27E7 : 32 F5 FE            	LD	(REGR),A
    7904/    27EA : ED 57               	LD	A,I
    7905/    27EC : 32 F4 FE            	LD	(REGI),A
    7906/    27EF : 22 E2 FE            	LD	(REGHL),HL
    7907/    27F2 : ED 53 E0 FE         	LD	(REGDE),DE
    7908/    27F6 : ED 43 DE FE         	LD	(REGBC),BC
    7909/    27FA : E1                  	POP	HL
    7910/    27FB : 22 DC FE            	LD	(REGAF),HL
    7911/    27FE : 08                  	EX	AF,AF'		;'
    7912/    27FF : F5                  	PUSH	AF
    7913/    2800 : D9                  	EXX
    7914/    2801 : 22 EA FE            	LD	(REGHLX),HL
    7915/    2804 : ED 53 E8 FE         	LD	(REGDEX),DE
    7916/    2808 : ED 43 E6 FE         	LD	(REGBCX),BC
    7917/    280C : E1                  	POP	HL
    7918/    280D : 22 E4 FE            	LD	(REGAFX),HL
    7919/    2810 : DD 22 EC FE         	LD	(REGIX),IX
    7920/    2814 : FD 22 EE FE         	LD	(REGIY),IY
    7921/    2818 : E1                  	POP	HL
    7922/    2819 : 2B                  	DEC	HL
    7923/    281A : 22 F2 FE            	LD	(REGPC),HL
    7924/    281D : ED 73 F0 FE         	LD	(REGSP),SP
    7925/    2821 :                     
    7926/    2821 :                     ; check bp and trace operation
    7927/    2821 :                     
    7928/    2821 : 31 D0 FE            	LD	SP,STACKM	; reset SP for monitor
    7929/    2824 : AF                  	xor	a
    7930/    2825 : 57                  	ld	d, a
    7931/    2826 : 5F                  	ld	e, a		;clear msg pointer
    7932/    2827 :                     
    7933/    2827 :                     
    7934/    2827 :                     ; check go, end operation
    7935/    2827 : 3A 06 FF            	ld	a, (tmpb_f)
    7936/    282A : B7                  	or	a
    7937/    282B : 28 09               	jr	z, chk_bp
    7938/    282D : 11 07 29            	ld	de, stpBrk_msg
    7939/    2830 : 21 07 FF            	ld	hl, tmpb_op
    7940/    2833 : CD D1 28            	call	rstr_tpt
    7941/    2836 :                     
    7942/    2836 :                     ; check set break point
    7943/    2836 :                     
    7944/    2836 :                     chk_bp:
    7945/    2836 : 3A 02 FF            	ld	a, (bpt2_f)
    7946/    2839 : B7                  	or	a
    7947/    283A : 28 09               	jr	z, bp_chk1
    7948/    283C : 11 07 29            	ld	de, stpBrk_msg
    7949/    283F : 21 03 FF            	ld	hl, bpt2_op
    7950/    2842 : CD DD 28            	call	rstr_bpt
    7951/    2845 :                     
    7952/    2845 :                     bp_chk1:
    7953/    2845 : 3A FE FE            	ld	a, (bpt1_f)
    7954/    2848 : B7                  	or	a
    7955/    2849 : 28 09               	jr	z, tp_chk1
    7956/    284B : 11 07 29            	ld	de, stpBrk_msg
    7957/    284E : 21 FF FE            	ld	hl, bpt1_op
    7958/    2851 : CD DD 28            	call	rstr_bpt
    7959/    2854 :                     
    7960/    2854 :                     ; check trace operation
    7961/    2854 :                     tp_chk1:
    7962/    2854 : 3A F6 FE            	ld	a, (tpt1_f)
    7963/    2857 : B7                  	or	a
    7964/    2858 : 28 09               	jr	z, tp_chk2
    7965/    285A : 11 10 29            	ld	de, trace_msg
    7966/    285D : 21 F7 FE            	ld	hl, tpt1_op
    7967/    2860 : CD D1 28            	call	rstr_tpt
    7968/    2863 :                     
    7969/    2863 :                     tp_chk2:
    7970/    2863 : 3A FA FE            	ld	a, (tpt2_f)
    7971/    2866 : B7                  	or	a
    7972/    2867 : 28 09               	jr	z, bp_chk_end
    7973/    2869 :                     
    7974/    2869 : 11 10 29            	ld	de, trace_msg
    7975/    286C : 21 FB FE            	ld	hl, tpt2_op
    7976/    286F : CD D1 28            	call	rstr_tpt
    7977/    2872 :                     
    7978/    2872 :                     bp_chk_end:
    7979/    2872 : 7A                  	ld	a, d
    7980/    2873 : B3                  	or	e
    7981/    2874 : 20 03               	jr	nz, no_rst38_msg
    7982/    2876 :                     
    7983/    2876 :                     	; set RST 38H message
    7984/    2876 : 11 FD 28            	LD	de,RST38MSG
    7985/    2879 :                     
    7986/    2879 :                     no_rst38_msg:
    7987/    2879 : 1A                  	ld	a, (de)		; get first char of message
    7988/    287A : FE 54               	cp	'T'		; trace ?
    7989/    287C : 28 0C               	jr	z, chk_ntrace
    7990/    287E :                     	
    7991/    287E : EB                  	ex	de, hl
    7992/    287F : CD 1B 26            	CALL	STROUT
    7993/    2882 :                     
    7994/    2882 :                     	;; R register adjustment
    7995/    2882 :                     
    7996/    2882 : CD 0B 18            	CALL	RDUMP
    7997/    2885 : CD E4 28            	call	dis_call	; list disassemble
    7998/    2888 : 18 1D               	jr	backTomon	; goto WBOOT
    7999/    288A :                     
    8000/    288A :                     ;
    8001/    288A :                     ; check continue trace operation
    8002/    288A :                     ;
    8003/    288A :                     chk_ntrace:
    8004/    288A : 3A 14 FF            	ld	a, (TP_mode)
    8005/    288D : FE 46               	cp	'F'		; chk
    8006/    288F : 28 0A               	jr	z, skp_rmsg
    8007/    2891 :                     
    8008/    2891 :                     ;no_trace:
    8009/    2891 : EB                  	ex	de, hl
    8010/    2892 : CD 1B 26            	CALL	STROUT
    8011/    2895 :                     
    8012/    2895 :                     	;; R register adjustment
    8013/    2895 :                     
    8014/    2895 : CD 0B 18            	CALL	RDUMP
    8015/    2898 : CD E4 28            	call	dis_call	; list disassemble
    8016/    289B :                     
    8017/    289B :                     skp_rmsg:
    8018/    289B : CD 86 2E            	call	CONST
    8019/    289E : 28 13               	jr	z, t_no_ky		; no key in
    8020/    28A0 : CD 3C 2E            	call	CONIN
    8021/    28A3 : FE 03               	cp	03h	; chk CTL+C
    8022/    28A5 : 20 0C               	jr	nz, t_no_ky
    8023/    28A7 :                     
    8024/    28A7 :                     	; stop_trace
    8025/    28A7 :                     backTomon:
    8026/    28A7 : AF                  	xor	a
    8027/    28A8 : 32 1A FF            	ld	(fever_t), a	; clear forever flag
    8028/    28AB : 67                  	ld	h, a
    8029/    28AC : 6F                  	ld	l, a
    8030/    28AD : 22 16 FF            	ld	(TC_cnt), hl
    8031/    28B0 : C3 CB 01            	JP	WSTART
    8032/    28B3 :                     	
    8033/    28B3 :                     	; check trace forever
    8034/    28B3 :                     t_no_ky:
    8035/    28B3 : 3A 1A FF            	ld	a, (fever_t)
    8036/    28B6 : B7                  	or	a
    8037/    28B7 : C2 C8 28            	jp	nz, repeat_trace
    8038/    28BA :                     
    8039/    28BA : 2A 16 FF            	ld	hl, (TC_cnt)
    8040/    28BD : 2B                  	dec	hl
    8041/    28BE : 22 16 FF            	ld	(TC_cnt), hl
    8042/    28C1 : 7D                  	ld	a, l
    8043/    28C2 : B4                  	or	h
    8044/    28C3 : 20 03               	jr	nz, repeat_trace
    8045/    28C5 : C3 CB 01            	JP	WSTART
    8046/    28C8 :                     
    8047/    28C8 :                     repeat_trace:
    8048/    28C8 : 2A F2 FE            	ld	hl, (REGPC)
    8049/    28CB : 22 18 FF            	ld	(tmpT), hl
    8050/    28CE : C3 35 05            	jp	t_op_chk
    8051/    28D1 :                     
    8052/    28D1 :                     rstr_tpt:	; HL=buffer point
    8053/    28D1 : E5                  	push	hl
    8054/    28D2 : 7E                  	ld	a, (hl)
    8055/    28D3 : 23                  	inc	hl
    8056/    28D4 : 4E                  	ld	c, (hl)
    8057/    28D5 : 23                  	inc	hl
    8058/    28D6 : 46                  	ld	b, (hl)
    8059/    28D7 :                     
    8060/    28D7 : 02                  	ld	(bc), a		; restor OP CODE
    8061/    28D8 : E1                  	pop	hl
    8062/    28D9 : AF                  	xor	a
    8063/    28DA : 2B                  	dec	hl
    8064/    28DB : 77                  	ld	(hl), a		; clear trace flag
    8065/    28DC : C9                  	ret
    8066/    28DD :                     
    8067/    28DD :                     rstr_bpt:	; HL=buffer point
    8068/    28DD : 7E                  	ld	a, (hl)
    8069/    28DE : 23                  	inc	hl
    8070/    28DF : 4E                  	ld	c, (hl)
    8071/    28E0 : 23                  	inc	hl
    8072/    28E1 : 46                  	ld	b, (hl)
    8073/    28E2 :                     
    8074/    28E2 : 02                  	ld	(bc), a		; restor OP CODE
    8075/    28E3 : C9                  	ret
    8076/    28E4 :                     
    8077/    28E4 :                     dis_call:
    8078/    28E4 : 2A F2 FE            	ld	hl, (REGPC)
    8079/    28E7 : 22 3D FF            	ld	(dasm_adr), hl	; set disasm address
    8080/    28EA : CD 9C 09            	call	dis_analysis
    8081/    28ED : CD 61 09            	call	mk_adr_str	; conout address and machine code
    8082/    28F0 : 21 CE FF            	ld	hl, adr_mc_buf
    8083/    28F3 : CD 1B 26            	call	STROUT		; conout disassemble strings
    8084/    28F6 : 2A F2 FE            	ld	hl, (REGPC)
    8085/    28F9 : 22 3D FF            	ld	(dasm_adr), hl	; restrore disasm address
    8086/    28FC : C9                  	ret
    8087/    28FD :                     
    8088/    28FD :                     RST38MSG:
    8089/    28FD : 52 53 54 20 33 38   	DB	"RST 38H",CR,LF,00H
             2903 : 48 0D 0A 00       
    8090/    2907 :                     stpBrk_msg:	
    8091/    2907 : 42 72 65 61 6B 21   	db	"Break!",CR,LF,00H
             290D : 0D 0A 00          
    8092/    2910 :                     trace_msg:	
    8093/    2910 : 54 72 61 63 65 21   	db	"Trace!",CR,LF,00H
             2916 : 0D 0A 00          
    8094/    2919 :                     
    8095/    2919 :                     ;
    8096/    2919 :                     ; make decimal string
    8097/    2919 :                     ;
    8098/    2919 :                     ; input HL : output string buffer
    8099/    2919 :                     ;       DE : 16bit binary
    8100/    2919 :                     ;
    8101/    2919 :                     ; output (HL) : decimal strings
    8102/    2919 :                     
    8103/    2919 :                     DEC_STR:
    8104/    2919 : F5                  	PUSH	AF
    8105/    291A : C5                  	PUSH	BC
    8106/    291B : D5                  	PUSH	DE
    8107/    291C : E5                  	push	hl
    8108/    291D : DD E5               	push	ix
    8109/    291F :                     
    8110/    291F : E5                  	push	hl
    8111/    2920 : DD E1               	pop	ix		; ix: save buffer top address
    8112/    2922 :                     
    8113/    2922 : EB                  	ex	de, hl		; hl: 16bit binary, de: buffer
    8114/    2923 : E5                  	push	hl		; save 16bit binary
    8115/    2924 : 21 05 00            	ld	hl, 5
    8116/    2927 : 19                  	add	hl, de		; hl = buffer + 5
    8117/    2928 : AF                  	xor	a
    8118/    2929 : 77                  	ld	(hl), A
    8119/    292A : EB                  	ex	de, hl		; de: buffer + 5, hl : buffer
    8120/    292B : E1                  	pop	hl		; hl : 16bit binary
    8121/    292C : 01 01 00            	LD	BC, 1
    8122/    292F :                     
    8123/    292F :                     LOOP_DEC:
    8124/    292F : 3E 0A               	LD	A, 10
    8125/    2931 : CD 4F 29            	CALL	DIV16_8
    8126/    2934 : F6 30               	OR	30H
    8127/    2936 : 1B                  	DEC	DE
    8128/    2937 : 12                  	LD	(DE), A
    8129/    2938 : 0C                  	INC	C
    8130/    2939 : 7C                  	LD	A, H
    8131/    293A : B5                  	OR	L
    8132/    293B : 20 F2               	JR	NZ, LOOP_DEC
    8133/    293D :                     
    8134/    293D : 79                  	LD	A, C
    8135/    293E : FE 06               	CP	6
    8136/    2940 : 28 06               	JR	Z, END_DEC
    8137/    2942 :                     
    8138/    2942 : DD E5               	push	ix
    8139/    2944 : E1                  	pop	hl		; hl : buffer top address
    8140/    2945 : EB                  	EX	DE, HL
    8141/    2946 : ED B0               	LDIR
    8142/    2948 :                     
    8143/    2948 :                     END_DEC:
    8144/    2948 : DD E1               	pop	ix
    8145/    294A : E1                  	pop	hl
    8146/    294B : D1                  	POP	DE
    8147/    294C : C1                  	POP	BC
    8148/    294D : F1                  	POP	AF
    8149/    294E : C9                  	RET
    8150/    294F :                     
    8151/    294F :                     
    8152/    294F :                     ; DIV 16bit / 8 bit
    8153/    294F :                     ; input
    8154/    294F :                     ;	HL, A
    8155/    294F :                     ; output
    8156/    294F :                     ;	result = HL, mod = A
    8157/    294F :                     
    8158/    294F :                     DIV16_8:
    8159/    294F : C5                  	PUSH	BC
    8160/    2950 : D5                  	PUSH	DE
    8161/    2951 :                     
    8162/    2951 : 4F                  	LD	C, A
    8163/    2952 : 06 0F               	LD	B, 15
    8164/    2954 : AF                  	XOR	A
    8165/    2955 : 29                  	ADD	HL, HL
    8166/    2956 : 17                  	RLA
    8167/    2957 : 91                  	SUB	C
    8168/    2958 : 38 0D               	JR	C, D16_MINUS_BEFORE
    8169/    295A : 29                  	ADD	HL, HL
    8170/    295B : 2C                  	INC	L
    8171/    295C :                     
    8172/    295C :                     D16_PLUS:
    8173/    295C : 17                  	RLA
    8174/    295D : 91                  	SUB	C
    8175/    295E : 38 0C               	JR	C, D16_MINUS_AFTER
    8176/    2960 :                     
    8177/    2960 :                     D16_PLUS_AFTER:
    8178/    2960 : 29                  	ADD	HL, HL
    8179/    2961 : 2C                  	INC	L
    8180/    2962 : 10 F8               	DJNZ	D16_PLUS
    8181/    2964 : C3 70 29            	JP	D16_END
    8182/    2967 :                     
    8183/    2967 :                     D16_MINUS_BEFORE:
    8184/    2967 : 29                  	ADD	HL, HL
    8185/    2968 :                     
    8186/    2968 :                     D16_MINUS:
    8187/    2968 : 17                  	RLA
    8188/    2969 : 81                  	ADD	A, C
    8189/    296A : 38 F4               	JR	C, D16_PLUS_AFTER
    8190/    296C :                     
    8191/    296C :                     D16_MINUS_AFTER:
    8192/    296C : 29                  	ADD	HL, HL
    8193/    296D : 10 F9               	DJNZ	D16_MINUS
    8194/    296F : 81                  	ADD	A,C
    8195/    2970 :                     D16_END:
    8196/    2970 : D1                  	POP	DE
    8197/    2971 : C1                  	POP	BC
    8198/    2972 : C9                  	RET
    8199/    2973 :                     
    8200/    2973 :                     ;
    8201/    2973 :                     ; input : HL / DE
    8202/    2973 :                     ; output : quotient HL
    8203/    2973 :                     ;	   remainder DE
    8204/    2973 :                     
    8205/    2973 :                     DIV16:
    8206/    2973 : 22 0A FF            	LD	(DIV16_NA), HL
    8207/    2976 : ED 53 0C FF         	LD	(DIV16_NB), DE
    8208/    297A :                     
    8209/    297A : AF                  	XOR	A
    8210/    297B : 32 0E FF            	LD	(DIV16_NC), A
    8211/    297E : 32 0F FF            	LD	(DIV16_NC+1), A
    8212/    2981 : 32 10 FF            	LD	(DIV16_ND), A
    8213/    2984 : 32 11 FF            	LD	(DIV16_ND+1), A
    8214/    2987 : 06 10               	LD	B, 16
    8215/    2989 :                     
    8216/    2989 :                     DIV16_X2:
    8217/    2989 : 21 0E FF            	LD	HL, DIV16_NC
    8218/    298C : CB 26               	SLA	(HL)
    8219/    298E : 23                  	INC	HL
    8220/    298F : CB 16               	RL	(HL)
    8221/    2991 :                     
    8222/    2991 : 21 0A FF            	LD	HL, DIV16_NA
    8223/    2994 : CB 26               	SLA	(HL)
    8224/    2996 : 23                  	INC	HL
    8225/    2997 : CB 16               	RL	(HL)
    8226/    2999 : 21 10 FF            	LD	HL, DIV16_ND
    8227/    299C : CB 16               	RL	(HL)
    8228/    299E : 23                  	INC	HL
    8229/    299F : CB 16               	RL	(HL)
    8230/    29A1 :                     
    8231/    29A1 : 2A 0C FF            	LD	HL, (DIV16_NB)
    8232/    29A4 : 5D                  	LD	E, L
    8233/    29A5 : 54                  	LD	D, H
    8234/    29A6 : 2A 10 FF            	LD	HL, (DIV16_ND)
    8235/    29A9 : AF                  	XOR	A
    8236/    29AA : ED 52               	SBC	HL, DE
    8237/    29AC : 30 02               	JR	NC, DIV16_X0
    8238/    29AE : 18 0B               	JR	DIV16_X1
    8239/    29B0 :                     
    8240/    29B0 :                     DIV16_X0:
    8241/    29B0 : 22 10 FF            	LD	(DIV16_ND), HL
    8242/    29B3 :                     
    8243/    29B3 : 3A 0E FF            	LD	A, (DIV16_NC)
    8244/    29B6 : F6 01               	OR	1
    8245/    29B8 : 32 0E FF            	LD	(DIV16_NC), A
    8246/    29BB :                     
    8247/    29BB :                     DIV16_X1:
    8248/    29BB : 10 CC               	DJNZ	DIV16_X2
    8249/    29BD :                     
    8250/    29BD : 2A 0E FF            	LD	HL,(DIV16_NC)
    8251/    29C0 : ED 5B 10 FF         	LD	DE,(DIV16_ND)
    8252/    29C4 : C9                  	RET
    8253/    29C5 :                     
    8254/    29C5 :                     ; 8bit * 8bit : ans = 16bit
    8255/    29C5 :                     ; input A , BC
    8256/    29C5 :                     ; output HL
    8257/    29C5 :                     
    8258/    29C5 :                     MUL_8:
    8259/    29C5 : F5                  	PUSH	AF
    8260/    29C6 : C5                  	PUSH	BC
    8261/    29C7 : B7                  	OR	A	; clear carry
    8262/    29C8 : 18 04               	JR	ST_MUL8
    8263/    29CA :                     
    8264/    29CA :                     LOOP_M8:
    8265/    29CA : CB 21               	SLA	C
    8266/    29CC : CB 10               	RL	B
    8267/    29CE :                     
    8268/    29CE :                     ST_MUL8:
    8269/    29CE : 1F                  	RRA
    8270/    29CF : 30 F9               	JR	NC, LOOP_M8
    8271/    29D1 : 09                  	ADD	HL, BC
    8272/    29D2 : 20 F6               	JR	NZ, LOOP_M8
    8273/    29D4 : C1                  	POP	BC
    8274/    29D5 : F1                  	POP	AF
    8275/    29D6 : C9                  	RET
    8276/    29D7 :                     ;;;
    8277/    29D7 :                     ;;; Messages
    8278/    29D7 :                     ;;;
    8279/    29D7 :                     
    8280/    29D7 : 3F 20 3A 43 6F 6D   cmd_hlp:	db	"? :Command Help", CR, LF
             29DD : 6D 61 6E 64 20 48 
             29E3 : 65 6C 70 0D 0A    
    8281/    29E8 : 23 4C 7C 3C 6E 75   		db	"#L|<num> :Launch program", CR, LF
             29EE : 6D 3E 20 3A 4C 61 
             29F4 : 75 6E 63 68 20 70 
             29FA : 72 6F 67 72 61 6D 
             2A00 : 0D 0A             
    8282/    2A02 : 41 5B 3C 61 64 64   		db	"A[<address>] : Mini Assemble mode", CR, LF
             2A08 : 72 65 73 73 3E 5D 
             2A0E : 20 3A 20 4D 69 6E 
             2A14 : 69 20 41 73 73 65 
             2A1A : 6D 62 6C 65 20 6D 
             2A20 : 6F 64 65 0D 0A    
    8283/    2A25 : 42 5B 31 7C 32 5B   		db	"B[1|2[,<adr>]] :Set or List Break Point", CR, LF
             2A2B : 2C 3C 61 64 72 3E 
             2A31 : 5D 5D 20 3A 53 65 
             2A37 : 74 20 6F 72 20 4C 
             2A3D : 69 73 74 20 42 72 
             2A43 : 65 61 6B 20 50 6F 
             2A49 : 69 6E 74 0D 0A    
    8284/    2A4E : 42 43 5B 31 7C 32   		db	"BC[1|2] :Clear Break Point", CR, LF
             2A54 : 5D 20 3A 43 6C 65 
             2A5A : 61 72 20 42 72 65 
             2A60 : 61 6B 20 50 6F 69 
             2A66 : 6E 74 0D 0A       
    8285/    2A6A : 44 5B 3C 61 64 72   		db	"D[<adr>] :Dump Memory", CR, LF
             2A70 : 3E 5D 20 3A 44 75 
             2A76 : 6D 70 20 4D 65 6D 
             2A7C : 6F 72 79 0D 0A    
    8286/    2A81 : 44 49 5B 3C 61 64   		db	"DI[<adr>][,s<steps>|<adr>] :Disassemble", CR, LF
             2A87 : 72 3E 5D 5B 2C 73 
             2A8D : 3C 73 74 65 70 73 
             2A93 : 3E 7C 3C 61 64 72 
             2A99 : 3E 5D 20 3A 44 69 
             2A9F : 73 61 73 73 65 6D 
             2AA5 : 62 6C 65 0D 0A    
    8287/    2AAA : 47 5B 3C 61 64 72   		db	"G[<adr>][,<stop adr>] :Go and Stop", CR, LF
             2AB0 : 3E 5D 5B 2C 3C 73 
             2AB6 : 74 6F 70 20 61 64 
             2ABC : 72 3E 5D 20 3A 47 
             2AC2 : 6F 20 61 6E 64 20 
             2AC8 : 53 74 6F 70 0D 0A 
    8288/    2ACE : 4C 20 3A 4C 6F 61   		db	"L :Load HexFile", CR, LF
             2AD4 : 64 20 48 65 78 46 
             2ADA : 69 6C 65 0D 0A    
    8289/    2ADF : 50 5B 49 7C 53 5D   		db	"P[I|S] :Save HexFile(I:Intel,S:Motorola)", CR, LF
             2AE5 : 20 3A 53 61 76 65 
             2AEB : 20 48 65 78 46 69 
             2AF1 : 6C 65 28 49 3A 49 
             2AF7 : 6E 74 65 6C 2C 53 
             2AFD : 3A 4D 6F 74 6F 72 
             2B03 : 6F 6C 61 29 0D 0A 
    8290/    2B09 : 52 5B 3C 72 65 67   		db	"R[<reg>] :Set or Dump register", CR, LF
             2B0F : 3E 5D 20 3A 53 65 
             2B15 : 74 20 6F 72 20 44 
             2B1B : 75 6D 70 20 72 65 
             2B21 : 67 69 73 74 65 72 
             2B27 : 0D 0A             
    8291/    2B29 : 53 5B 3C 61 64 72   		db	"S[<adr>] :Set Memory", CR, LF
             2B2F : 3E 5D 20 3A 53 65 
             2B35 : 74 20 4D 65 6D 6F 
             2B3B : 72 79 0D 0A       
    8292/    2B3F : 54 5B 3C 61 64 72   		db	"T[<adr>][,<steps>|-1] : Trace command", CR, LF
             2B45 : 3E 5D 5B 2C 3C 73 
             2B4B : 74 65 70 73 3E 7C 
             2B51 : 2D 31 5D 20 3A 20 
             2B57 : 54 72 61 63 65 20 
             2B5D : 63 6F 6D 6D 61 6E 
             2B63 : 64 0D 0A          
    8293/    2B66 : 54 4D 5B 49 7C 53   		db	"TM[I|S] :Trace Option for CALL", CR, LF
             2B6C : 5D 20 3A 54 72 61 
             2B72 : 63 65 20 4F 70 74 
             2B78 : 69 6F 6E 20 66 6F 
             2B7E : 72 20 43 41 4C 4C 
             2B84 : 0D 0A             
    8294/    2B86 : 54 50 5B 4F 4E 7C   		db	"TP[ON|OFF] :Trace Print Mode", CR, LF, 00h
             2B8C : 4F 46 46 5D 20 3A 
             2B92 : 54 72 61 63 65 20 
             2B98 : 50 72 69 6E 74 20 
             2B9E : 4D 6F 64 65 0D 0A 
             2BA4 : 00                
    8295/    2BA5 :                     
    8296/    2BA5 :                     OPNMSG:
    8297/    2BA5 : 0D 0A               	DB	CR,LF
    8298/    2BA7 : 41 4B 49 2D 38 30   	db	"AKI-80 MONITOR Rev.B04",CR,LF
             2BAD : 20 4D 4F 4E 49 54 
             2BB3 : 4F 52 20 52 65 76 
             2BB9 : 2E 42 30 34 0D 0A 
    8299/    2BBF : 54 68 69 73 20 6D   	db	"This monitor is based on unimon.",CR,LF,00H
             2BC5 : 6F 6E 69 74 6F 72 
             2BCB : 20 69 73 20 62 61 
             2BD1 : 73 65 64 20 6F 6E 
             2BD7 : 20 75 6E 69 6D 6F 
             2BDD : 6E 2E 0D 0A 00    
    8300/    2BE2 :                     
    8301/    2BE2 :                     PROMPT:
    8302/    2BE2 : 5D 20 00            	DB	"] ",00H
    8303/    2BE5 :                     
    8304/    2BE5 :                     IHEMSG:
    8305/    2BE5 : 45 72 72 6F 72 20   	DB	"Error ihex",CR,LF,00H
             2BEB : 69 68 65 78 0D 0A 
             2BF1 : 00                
    8306/    2BF2 :                     SHEMSG:
    8307/    2BF2 : 45 72 72 6F 72 20   	DB	"Error srec",CR,LF,00H
             2BF8 : 73 72 65 63 0D 0A 
             2BFE : 00                
    8308/    2BFF :                     ERRMSG:
    8309/    2BFF : 45 72 72 6F 72 0D   	DB	"Error",CR,LF,00H
             2C05 : 0A 00             
    8310/    2C07 :                     
    8311/    2C07 :                     DSEP0:
    8312/    2C07 : 20 3A 00            	DB	" :",00H
    8313/    2C0A :                     DSEP1:
    8314/    2C0A : 20 7C 20 00         	DB	" | ",00H
    8315/    2C0E :                     
    8316/    2C0E : 20 20 00            dsap	db	"  ", 00
    8317/    2C11 :                     
    8318/    2C11 :                     IHEXER:
    8319/    2C11 : 3A 30 30 30 30 30           DB	":00000001FF",CR,LF,00H
             2C17 : 30 30 31 46 46 0D 
             2C1D : 0A 00             
    8320/    2C1F :                     SRECER:
    8321/    2C1F : 53 39 30 33 30 30           DB	"S9030000FC",CR,LF,00H
             2C25 : 30 30 46 43 0D 0A 
             2C2B : 00                
    8322/    2C2C :                     
    8323/    2C2C :                     	;; Register dump table
    8324/    2C2C : 81 2C DD FE         RDTAB:	DW	RDSA,   REGAF+1
    8325/    2C30 : 01                  	DB	1
    8326/    2C31 : 85 2C DE FE         	DW	RDSBC,  REGBC
    8327/    2C35 : 02                  	DB	2
    8328/    2C36 : 8B 2C E0 FE         	DW	RDSDE,  REGDE
    8329/    2C3A : 02                  	DB	2
    8330/    2C3B : 91 2C E2 FE         	DW	RDSHL,  REGHL
    8331/    2C3F : 02                  	DB	2
    8332/    2C40 : 97 2C DC FE         	DW	RDSF,   REGAF
    8333/    2C44 : 01                  	DB	1
    8334/    2C45 :                     
    8335/    2C45 : 9C 2C EC FE         	DW	RDSIX,  REGIX
    8336/    2C49 : 02                  	DB	2
    8337/    2C4A : A1 2C EE FE         	DW	RDSIY,  REGIY
    8338/    2C4E : 02                  	DB	2
    8339/    2C4F :                     
    8340/    2C4F : A6 2C E5 FE         	DW	RDSAX,  REGAFX+1
    8341/    2C53 : 01                  	DB	1
    8342/    2C54 : AC 2C E6 FE         	DW	RDSBCX, REGBCX
    8343/    2C58 : 02                  	DB	2
    8344/    2C59 : B2 2C E8 FE         	DW	RDSDEX, REGDEX
    8345/    2C5D : 02                  	DB	2
    8346/    2C5E : B8 2C EA FE         	DW	RDSHLX, REGHLX
    8347/    2C62 : 02                  	DB	2
    8348/    2C63 : BE 2C E4 FE         	DW	RDSFX,  REGAFX
    8349/    2C67 : 01                  	DB	1
    8350/    2C68 :                     
    8351/    2C68 : C3 2C F0 FE         	DW	RDSSP,  REGSP
    8352/    2C6C : 02                  	DB	2
    8353/    2C6D : C8 2C F2 FE         	DW	RDSPC,  REGPC
    8354/    2C71 : 02                  	DB	2
    8355/    2C72 : CD 2C F4 FE         	DW	RDSI,   REGI
    8356/    2C76 : 01                  	DB	1
    8357/    2C77 : D1 2C F5 FE         	DW	RDSR,   REGR
    8358/    2C7B : 01                  	DB	1
    8359/    2C7C :                     
    8360/    2C7C : 00 00 00 00         	DW	0000H,  0000H
    8361/    2C80 : 00                  	DB	0
    8362/    2C81 :                     
    8363/    2C81 : 41 20 3D 00         RDSA:	DB	"A =",00H
    8364/    2C85 : 20 42 43 20 3D 00   RDSBC:	DB	" BC =",00H
    8365/    2C8B : 20 44 45 20 3D 00   RDSDE:	DB	" DE =",00H
    8366/    2C91 : 20 48 4C 20 3D 00   RDSHL:	DB	" HL =",00H
    8367/    2C97 :                     
    8368/    2C97 : 20 46 20 3D 00      RDSF:	DB	" F =",00H
    8369/    2C9C :                     
    8370/    2C9C : =2CH                 RDSF_H	equ	RDSF >> 8
    8371/    2C9C : =97H                 RDSF_L	equ	RDSF & 0FFh
    8372/    2C9C :                     
    8373/    2C9C :                     
    8374/    2C9C : 20 49 58 3D 00      RDSIX:	DB	" IX=",00H
    8375/    2CA1 : 20 49 59 3D 00      RDSIY:	DB	" IY=",00H
    8376/    2CA6 : 0D 0A 41 27 3D 00   RDSAX:	DB	CR,LF,"A'=",00H
    8377/    2CAC : 20 42 43 27 3D 00   RDSBCX:	DB	" BC'=",00H
    8378/    2CB2 : 20 44 45 27 3D 00   RDSDEX:	DB	" DE'=",00H
    8379/    2CB8 : 20 48 4C 27 3D 00   RDSHLX:	DB	" HL'=",00H
    8380/    2CBE :                     
    8381/    2CBE : 20 46 27 3D 00      RDSFX:	DB	" F'=",00H
    8382/    2CC3 :                     
    8383/    2CC3 : =2CH                 RDSFX_H	equ	RDSFX >> 8
    8384/    2CC3 : =0BEH                RDSFX_L	equ	RDSFX & 0FFh
    8385/    2CC3 :                     
    8386/    2CC3 : 20 53 50 3D 00      RDSSP:	DB	" SP=",00H
    8387/    2CC8 : 20 50 43 3D 00      RDSPC:	DB	" PC=",00H
    8388/    2CCD : 20 49 3D 00         RDSI:	DB	" I=",00H
    8389/    2CD1 : 20 52 3D 00         RDSR:	DB	" R=",00H
    8390/    2CD5 :                     
    8391/    2CD5 :                     RNTAB:
    8392/    2CD5 : 41 0F               	DB	'A',0FH		; "A?"
    8393/    2CD7 : 1F 2D 00 00         	DW	RNTABA,0
    8394/    2CDB : 42 0F               	DB	'B',0FH		; "B?"
    8395/    2CDD : 2D 2D 00 00         	DW	RNTABB,0
    8396/    2CE1 : 43 0F               	DB	'C',0FH		; "C?"
    8397/    2CE3 : 4F 2D 00 00         	DW	RNTABC,0
    8398/    2CE7 : 44 0F               	DB	'D',0FH		; "D?"
    8399/    2CE9 : 5D 2D 00 00         	DW	RNTABD,0
    8400/    2CED : 45 0F               	DB	'E',0FH		; "E?"
    8401/    2CEF : 7F 2D 00 00         	DW	RNTABE,0
    8402/    2CF3 : 46 0F               	DB	'F',0FH		; "F?"
    8403/    2CF5 : 8D 2D 00 00         	DW	RNTABF,0
    8404/    2CF9 : 48 0F               	DB	'H',0FH		; "H?"
    8405/    2CFB : 9B 2D 00 00         	DW	RNTABH,0
    8406/    2CFF : 49 0F               	DB	'I',0FH		; "I?"
    8407/    2D01 : CB 2D 00 00         	DW	RNTABI,0
    8408/    2D05 : 4C 0F               	DB	'L',0FH		; "L?"
    8409/    2D07 : BD 2D 00 00         	DW	RNTABL,0
    8410/    2D0B : 50 0F               	DB	'P',0FH		; "P?"
    8411/    2D0D : DF 2D 00 00         	DW	RNTABP,0
    8412/    2D11 : 52 01               	DB	'R',1		; "R"
    8413/    2D13 : F5 FE 3A 2E         	DW	REGR,RNR
    8414/    2D17 : 53 0F               	DB	'S',0FH		; "S?"
    8415/    2D19 : E7 2D 00 00         	DW	RNTABS,0
    8416/    2D1D :                     
    8417/    2D1D : 00 00               	DB	00H,0		; End mark
    8418/    2D1F :                     
    8419/    2D1F :                     RNTABA:
    8420/    2D1F : 00 01               	DB	00H,1		; "A"
    8421/    2D21 : DD FE EF 2D         	DW	REGAF+1,RNA
    8422/    2D25 : 27 01               	DB	27H,1		; "A'"
    8423/    2D27 :                     ;;	DB	'\'',1		; "A'"
    8424/    2D27 : E5 FE 08 2E         	DW	REGAFX+1,RNAX
    8425/    2D2B :                     
    8426/    2D2B : 00 00               	DB	00H,0
    8427/    2D2D :                     	
    8428/    2D2D :                     RNTABB:
    8429/    2D2D : 00 01               	DB	00H,1		; "B"
    8430/    2D2F : DF FE F4 2D         	DW	REGBC+1,RNB
    8431/    2D33 : 27 01               	DB	27H,1		; "B'"
    8432/    2D35 :                     ;;	DB	'\'',1		; "B'"
    8433/    2D35 : E7 FE 0F 2E         	DW	REGBCX+1,RNBX
    8434/    2D39 : 43 0F               	DB	'C',0FH		; "BC?"
    8435/    2D3B : 41 2D 00 00         	DW	RNTABBC,0
    8436/    2D3F :                     
    8437/    2D3F : 00 00               	DB	00H,0		; End mark
    8438/    2D41 :                     
    8439/    2D41 :                     RNTABBC:
    8440/    2D41 : 00 02               	DB	00H,2		; "BC"
    8441/    2D43 : DE FE F1 2D         	DW	REGBC,RNBC
    8442/    2D47 : 27 02               	DB	27H,2		; "BC'"
    8443/    2D49 :                     ;;	DB	'\'',2		; "BC'"
    8444/    2D49 : E6 FE 0B 2E         	DW	REGBCX,RNBCX
    8445/    2D4D :                     
    8446/    2D4D : 00 00               	DB	00H,0
    8447/    2D4F :                     	
    8448/    2D4F :                     RNTABC:
    8449/    2D4F : 00 01               	DB	00H,1		; "C"
    8450/    2D51 : DE FE F6 2D         	DW	REGBC,RNC
    8451/    2D55 : 27 01               	DB	27H,1		; "C'"
    8452/    2D57 :                     ;;	DB	'\'',1		; "C'"
    8453/    2D57 : E6 FE 12 2E         	DW	REGBCX,RNCX
    8454/    2D5B :                     
    8455/    2D5B : 00 00               	DB	00H,0
    8456/    2D5D :                     	
    8457/    2D5D :                     RNTABD:
    8458/    2D5D : 00 01               	DB	00H,1		; "D"
    8459/    2D5F : E1 FE FB 2D         	DW	REGDE+1,RND
    8460/    2D63 : 27 01               	DB	27H,1		; "D'"
    8461/    2D65 :                     ;;	DB	'\'',1		; "D'"
    8462/    2D65 : E9 FE 19 2E         	DW	REGDEX+1,RNDX
    8463/    2D69 : 45 0F               	DB	'E',0FH		; "DE?"
    8464/    2D6B : 71 2D 00 00         	DW	RNTABDE,0
    8465/    2D6F :                     
    8466/    2D6F : 00 00               	DB	00H,0
    8467/    2D71 :                     
    8468/    2D71 :                     RNTABDE:
    8469/    2D71 : 00 02               	DB	00H,2		; "DE"
    8470/    2D73 : E0 FE F8 2D         	DW	REGDE,RNDE
    8471/    2D77 : 27 02               	DB	27H,2		; "DE'"
    8472/    2D79 :                     ;;	DB	'\'',2		; "DE'"
    8473/    2D79 : E8 FE 15 2E         	DW	REGDEX,RNDEX
    8474/    2D7D :                     
    8475/    2D7D : 00 00               	DB	00H,0
    8476/    2D7F :                     	
    8477/    2D7F :                     RNTABE:
    8478/    2D7F : 00 01               	DB	00H,1		; "E"
    8479/    2D81 : E0 FE FD 2D         	DW	REGDE,RNE
    8480/    2D85 : 27 01               	DB	27H,1		; "E'"
    8481/    2D87 :                     ;;	DB	'\'',1		; "E'"
    8482/    2D87 : E8 FE 1C 2E         	DW	REGDEX,RNEX
    8483/    2D8B :                     
    8484/    2D8B : 00 00               	DB	00H,0
    8485/    2D8D :                     	
    8486/    2D8D :                     RNTABF:
    8487/    2D8D : 00 01               	DB	00H,1		; "F"
    8488/    2D8F : DC FE 06 2E         	DW	REGAF,RNF
    8489/    2D93 : 27 01               	DB	27H,1		; "F'"
    8490/    2D95 :                     ;;	DB	'\'',1		; "F'"
    8491/    2D95 : E4 FE 29 2E         	DW	REGAFX,RNFX
    8492/    2D99 :                     
    8493/    2D99 : 00 00               	DB	00H,0
    8494/    2D9B :                     	
    8495/    2D9B :                     RNTABH:
    8496/    2D9B : 00 01               	DB	00H,1		; "H"
    8497/    2D9D : E3 FE 02 2E         	DW	REGHL+1,RNH
    8498/    2DA1 : 27 01               	DB	27H,1		; "H'"
    8499/    2DA3 :                     ;;	DB	'\'',1		; "H'"
    8500/    2DA3 : EB FE 23 2E         	DW	REGHLX+1,RNHX
    8501/    2DA7 : 4C 0F               	DB	'L',0FH		; "HL?"
    8502/    2DA9 : AF 2D 00 00         	DW	RNTABHL,0
    8503/    2DAD :                     
    8504/    2DAD : 00 00               	DB	00H,0
    8505/    2DAF :                     
    8506/    2DAF :                     RNTABHL:
    8507/    2DAF : 00 02               	DB	00H,2		; "HL"
    8508/    2DB1 : E2 FE FF 2D         	DW	REGHL,RNHL
    8509/    2DB5 : 27 02               	DB	27H,2		; "HL'"
    8510/    2DB7 :                     ;;	DB	'\'',2		; "HL'"
    8511/    2DB7 : EA FE 1F 2E         	DW	REGHLX,RNHLX
    8512/    2DBB :                     
    8513/    2DBB : 00 00               	DB	00H,0
    8514/    2DBD :                     	
    8515/    2DBD :                     RNTABL:
    8516/    2DBD : 00 01               	DB	00H,1		; "L"
    8517/    2DBF : E2 FE 04 2E         	DW	REGHL,RNL
    8518/    2DC3 : 27 01               	DB	27H,1		; "L'"
    8519/    2DC5 :                     ;;	DB	'\'',1		; "L'"
    8520/    2DC5 : EA FE 26 2E         	DW	REGHLX,RNLX
    8521/    2DC9 :                     
    8522/    2DC9 : 00 00               	DB	00H,0
    8523/    2DCB :                     	
    8524/    2DCB :                     RNTABI:
    8525/    2DCB : 00 01               	DB	00H,1		; "I"
    8526/    2DCD : F4 FE 38 2E         	DW	REGI,RNI
    8527/    2DD1 : 58 02               	DB	'X',2		; "IX"
    8528/    2DD3 : EC FE 2C 2E         	DW	REGIX,RNIX
    8529/    2DD7 : 59 02               	DB	'Y',2		; "IY"
    8530/    2DD9 : EE FE 2F 2E         	DW	REGIY,RNIY
    8531/    2DDD :                     	
    8532/    2DDD : 00 00               	DB	00H,0
    8533/    2DDF :                     
    8534/    2DDF :                     RNTABP:
    8535/    2DDF : 43 02               	DB	'C',2		; "PC"
    8536/    2DE1 : F2 FE 35 2E         	DW	REGPC,RNPC
    8537/    2DE5 :                     
    8538/    2DE5 : 00 00               	DB	00H,0
    8539/    2DE7 :                     
    8540/    2DE7 :                     RNTABS:
    8541/    2DE7 : 50 02               	DB	'P',2		; "SP"
    8542/    2DE9 : F0 FE 32 2E         	DW	REGSP,RNSP
    8543/    2DED :                     
    8544/    2DED : 00 00               	DB	00H,0
    8545/    2DEF :                     
    8546/    2DEF : 41 00               RNA:	DB	"A",00H
    8547/    2DF1 : 42 43 00            RNBC:	DB	"BC",00H
    8548/    2DF4 : 42 00               RNB:	DB	"B",00H
    8549/    2DF6 : 43 00               RNC:	DB	"C",00H
    8550/    2DF8 : 44 45 00            RNDE:	DB	"DE",00H
    8551/    2DFB : 44 00               RND:	DB	"D",00H
    8552/    2DFD : 45 00               RNE:	DB	"E",00H
    8553/    2DFF : 48 4C 00            RNHL:	DB	"HL",00H
    8554/    2E02 : 48 00               RNH:	DB	"H",00H
    8555/    2E04 : 4C 00               RNL:	DB	"L",00H
    8556/    2E06 : 46 00               RNF:	DB	"F",00H
    8557/    2E08 : 41 27 00            RNAX:	DB	"A'",00H
    8558/    2E0B : 42 43 27 00         RNBCX:	DB	"BC'",00H
    8559/    2E0F : 42 27 00            RNBX:	DB	"B'",00H
    8560/    2E12 : 43 27 00            RNCX:	DB	"C'",00H
    8561/    2E15 : 44 45 27 00         RNDEX:	DB	"DE'",00H
    8562/    2E19 : 44 27 00            RNDX:	DB	"D'",00H
    8563/    2E1C : 45 27 00            RNEX:	DB	"E'",00H
    8564/    2E1F : 48 4C 27 00         RNHLX:	DB	"HL'",00H
    8565/    2E23 : 48 27 00            RNHX:	DB	"H'",00H
    8566/    2E26 : 4C 27 00            RNLX:	DB	"L'",00H
    8567/    2E29 : 46 27 00            RNFX:	DB	"F'",00H
    8568/    2E2C : 49 58 00            RNIX:	DB	"IX",00H
    8569/    2E2F : 49 59 00            RNIY:	DB	"IY",00H
    8570/    2E32 : 53 50 00            RNSP:	DB	"SP",00H
    8571/    2E35 : 50 43 00            RNPC:	DB	"PC",00H
    8572/    2E38 : 49 00               RNI:	DB	"I",00H
    8573/    2E3A : 52 00               RNR:	DB	"R",00H
    8574/    2E3C :                     
    8575/    2E3C :                     ;;;
    8576/    2E3C :                     ;;; Console drivers
    8577/    2E3C :                     ;;;
    8578/    2E3C :                     
    8579/    2E3C :                     ;	BUFER -> A
    8580/    2E3C :                     ;
    8581/    2E3C :                     ;	SAVE REGISTERS
    8582/    2E3C :                     CONIN: ; RXA
    8583/    2E3C : C5                  	PUSH	BC
    8584/    2E3D : D5                  	PUSH	DE
    8585/    2E3E : E5                  	PUSH	HL
    8586/    2E3F :                     ;
    8587/    2E3F :                     ;	WAIT FOR NOT EMPTY
    8588/    2E3F : 3A 44 FF            RXWAIT:	LD	A,(Rx_BCNT)
    8589/    2E42 : B7                  	or	a
    8590/    2E43 : 28 FA               	JR	Z,RXWAIT
    8591/    2E45 :                     ;
    8592/    2E45 :                     ;	READ DATA
    8593/    2E45 : F3                  	DI
    8594/    2E46 : 3A 44 FF            	LD	A,(Rx_BCNT)
    8595/    2E49 : 3D                  	DEC	A
    8596/    2E4A : 32 44 FF            	LD	(Rx_BCNT),A
    8597/    2E4D :                     
    8598/    2E4D : FE 0A               	cp	a, 10
    8599/    2E4F : 20 1E               	jr	nz, cont_rcv
    8600/    2E51 : 3A CB FF            	ld	a, (rx_xflg)
    8601/    2E54 : FE 13               	cp	XOFF
    8602/    2E56 : 20 17               	jr	nz, cont_rcv
    8603/    2E58 :                     	
    8604/    2E58 : 3E 11               	ld	a, XON
    8605/    2E5A : 32 CD FF            	ld	(rx_xreq), a	; set XON request
    8606/    2E5D : 3A CA FF            	ld	a, (tx_pend)
    8607/    2E60 : B7                  	or	a
    8608/    2E61 : 20 0C               	jr	nz, cont_rcv
    8609/    2E63 :                     
    8610/    2E63 : 3E 11               	ld	a, XON
    8611/    2E65 : 32 CB FF            	ld	(rx_xflg), a	; save XON condition
    8612/    2E68 : CD E7 2E            	call	Tx_direct
    8613/    2E6B : AF                  	xor	a
    8614/    2E6C : 32 CD FF            	ld	(rx_xreq), a	; clear XON request
    8615/    2E6F :                     
    8616/    2E6F :                     cont_rcv:
    8617/    2E6F : 3A 45 FF            	LD	A,(Rx_BRP)
    8618/    2E72 : 4F                  	LD	C,A
    8619/    2E73 : 06 00               	LD	B,00H
    8620/    2E75 : 21 47 FF            	LD	HL,Rx_BUF
    8621/    2E78 : 09                  	ADD	HL,BC
    8622/    2E79 : 56                  	LD	D,(HL)
    8623/    2E7A : 3C                  	INC	A
    8624/    2E7B : E6 3F               	AND	Rx_BFSIZ-1
    8625/    2E7D : 32 45 FF            	LD	(Rx_BRP),A
    8626/    2E80 : 7A                  	LD	A,D
    8627/    2E81 : FB                  	EI
    8628/    2E82 :                     ;
    8629/    2E82 :                     ;	RESTORE REGISTERS
    8630/    2E82 : E1                  	POP	HL
    8631/    2E83 : D1                  	POP	DE
    8632/    2E84 : C1                  	POP	BC
    8633/    2E85 : C9                  	RET
    8634/    2E86 :                     
    8635/    2E86 :                     ;
    8636/    2E86 :                     ;	CHECK RECEIVE STATUS
    8637/    2E86 :                     CONST: ; KBHIT
    8638/    2E86 : 3A 44 FF            	LD	A,(Rx_BCNT)
    8639/    2E89 : B7                  	or	a
    8640/    2E8A : C9                  	RET
    8641/    2E8B :                     
    8642/    2E8B :                     ;
    8643/    2E8B :                     ; A -> Tx buffer;
    8644/    2E8B :                     ;
    8645/    2E8B :                     CONOUT:	; TXA
    8646/    2E8B :                     
    8647/    2E8B : F5                  	push	af
    8648/    2E8C : E5                  	push	hl
    8649/    2E8D : C5                  	push	bc
    8650/    2E8E : D5                  	push	de
    8651/    2E8F :                     
    8652/    2E8F : 57                  	ld	d, a
    8653/    2E90 :                     CONOUT1:
    8654/    2E90 : 3A CC FF            	ld	a, (tx_xflg)
    8655/    2E93 : FE 13               	cp	XOFF
    8656/    2E95 : 28 F9               	jr	z, CONOUT1
    8657/    2E97 :                     
    8658/    2E97 : 3A 87 FF            	ld	a, (Tx_BCNT)
    8659/    2E9A : FE 40               	cp	Tx_BFSIZ	; check buffer full
    8660/    2E9C : 28 F2               	jr	z, CONOUT1
    8661/    2E9E :                     
    8662/    2E9E :                     ; save tx data to tx buffer
    8663/    2E9E : F3                  	di
    8664/    2E9F : 3A 87 FF            	ld	a, (Tx_BCNT)
    8665/    2EA2 : 3C                  	inc	a
    8666/    2EA3 : 32 87 FF            	ld	(Tx_BCNT), a
    8667/    2EA6 :                     
    8668/    2EA6 : 21 8A FF            	ld	hl, Tx_BUF
    8669/    2EA9 : 3A 89 FF            	ld	a, (Tx_BWP)
    8670/    2EAC : 4F                  	ld	c, a
    8671/    2EAD : 06 00               	ld	b, 0
    8672/    2EAF : 09                  	add	hl, bc
    8673/    2EB0 : 72                  	ld	(hl), d		; save tx data
    8674/    2EB1 : 3C                  	inc	a
    8675/    2EB2 : E6 3F               	and	Tx_BFSIZ-1
    8676/    2EB4 : 32 89 FF            	ld	(Tx_BWP), a	; save write buffer pointer
    8677/    2EB7 :                     
    8678/    2EB7 :                     ; check tx buffer empty
    8679/    2EB7 :                     
    8680/    2EB7 : 3A CA FF            	ld	a, (tx_pend)
    8681/    2EBA : B7                  	or	a
    8682/    2EBB : 28 06               	JR	z, end_tx
    8683/    2EBD : CD C9 2E            	call	get_TxDat
    8684/    2EC0 : CD E7 2E            	call	Tx_direct
    8685/    2EC3 :                     
    8686/    2EC3 :                     end_tx:
    8687/    2EC3 : FB                  	ei
    8688/    2EC4 : D1                  	pop	de
    8689/    2EC5 : C1                  	pop	bc
    8690/    2EC6 : E1                  	pop	hl
    8691/    2EC7 : F1                  	pop	af
    8692/    2EC8 : C9                  	RET
    8693/    2EC9 :                     ;
    8694/    2EC9 :                     ; control Tx buffer
    8695/    2EC9 :                     ;
    8696/    2EC9 :                     get_TxDat:
    8697/    2EC9 : 3A 87 FF            	LD	A,(Tx_BCNT)
    8698/    2ECC : B7                  	or	a
    8699/    2ECD : 28 16               	jr	z, tx_nodat
    8700/    2ECF :                     
    8701/    2ECF : 3D                  	DEC	A
    8702/    2ED0 : 32 87 FF            	LD	(Tx_BCNT),A
    8703/    2ED3 :                     
    8704/    2ED3 : 21 8A FF            	ld	hl, Tx_BUF
    8705/    2ED6 : 3A 88 FF            	ld	a, (Tx_BRP)
    8706/    2ED9 : 4F                  	ld	c, a
    8707/    2EDA : 06 00               	ld	b, 0
    8708/    2EDC : 09                  	add	hl, bc
    8709/    2EDD : 3C                  	inc	a
    8710/    2EDE : E6 3F               	and	Tx_BFSIZ -1	; CF=0
    8711/    2EE0 : 32 88 FF            	ld	(Tx_BRP), a
    8712/    2EE3 : 7E                  	ld	a, (hl)		; get Tx data
    8713/    2EE4 : C9                  	ret
    8714/    2EE5 :                     
    8715/    2EE5 :                     tx_nodat:
    8716/    2EE5 : 37                  	scf
    8717/    2EE6 : C9                  	ret
    8718/    2EE7 :                     
    8719/    2EE7 :                     ;---------------------
    8720/    2EE7 :                     ; Tx send data direct
    8721/    2EE7 :                     ;---------------------
    8722/    2EE7 :                     Tx_direct:
    8723/    2EE7 : F5                  	push	af
    8724/    2EE8 : D5                  	push	de
    8725/    2EE9 :                     
    8726/    2EE9 : 57                  	ld	d, a
    8727/    2EEA : DB 19               TX_WT:	IN	A,(PSIOAC)
    8728/    2EEC : E6 04               	and	TXEMPTY
    8729/    2EEE : 28 FA               	JR	Z,TX_WT
    8730/    2EF0 :                     
    8731/    2EF0 : 7A                  	ld	a, d
    8732/    2EF1 : D3 18               	OUT	(PSIOAD), a
    8733/    2EF3 :                     
    8734/    2EF3 : AF                  	xor	a
    8735/    2EF4 : 32 CA FF            	ld	(tx_pend), a
    8736/    2EF7 :                     
    8737/    2EF7 : D1                  	pop	de
    8738/    2EF8 : F1                  	pop	af
    8739/    2EF9 : C9                  	ret
    8740/    2EFA :                     
    8741/    2EFA : FF FF FF FF FF FF   	db	BASIC_TOP - $ dup(0ffH)
    8742/    2F00 :                     ;	ORG	BASIC_TOP
    8743/    2F00 :                     
    8744/    2F00 :                     ;;;
    8745/    2F00 :                     ;;; RAM area
    8746/    2F00 :                     ;;;
    8747/    2F00 :                     
    8748/    2F00 :                     	;;
    8749/    2F00 :                     	;; Work Area
    8750/    2F00 :                     	;;
    8751/    2F00 :                     	
    8752/    FED0 :                     	ORG	WORK_B
    8753/    FED0 :                     
    8754/    FED0 : =>FALSE              	IF	BACKDOOR
    8755/    FED0 :                     stealRST08:	ds	2	; hacking RST 08H, set jump address
    8756/    FED0 :                     stealRST10:	ds	2	; hacking RST 10H, set jump address
    8757/    FED0 :                     stealRST18:	ds	2	; hacking RST 18H, set jump address
    8758/    FED0 :                     stealRST20:	ds	2	; hacking RST 20H, set jump address
    8759/    FED0 :                     stealRST28:	ds	2	; hacking RST 28H, set jump address
    8760/    FED0 :                     stealRST30:	ds	2	; hacking RST 30H, set jump address
    8761/    FED0 :                     stealRST38:	ds	2	; hacking RST 38H, set jump address
    8762/    FED0 :                     save_hl:	ds	2
    8763/    FED0 : [8754]               	ENDIF
    8764/    FED0 :                     	
    8765/    FED0 :                     DSADDR:	DS	2	; Dump start address
    8766/    FED2 :                     DEADDR:	DS	2	; Dump end address
    8767/    FED4 :                     DSTATE:	DS	1	; Dump state
    8768/    FED5 :                     GADDR:	DS	2	; Go address
    8769/    FED7 :                     SADDR:	DS	2	; Set address
    8770/    FED9 :                     HEXMOD:	DS	1	; HEX file mode
    8771/    FEDA :                     RECTYP:	DS	1	; Record type
    8772/    FEDB :                     SIZE:	DS	1	; I/O Size 00H,'W','S'
    8773/    FEDC :                     
    8774/    FEDC :                     REG_B:	
    8775/    FEDC :                     REGAF:	DS	2
    8776/    FEDE :                     REGBC:	DS	2
    8777/    FEE0 :                     REGDE:	DS	2
    8778/    FEE2 :                     REGHL:	DS	2
    8779/    FEE4 :                     REGAFX:	DS	2		; Register AF'
    8780/    FEE6 :                     REGBCX:	DS	2
    8781/    FEE8 :                     REGDEX:	DS	2
    8782/    FEEA :                     REGHLX:	DS	2		; Register HL'
    8783/    FEEC :                     REGIX:	DS	2
    8784/    FEEE :                     REGIY:	DS	2
    8785/    FEF0 :                     REGSP:	DS	2
    8786/    FEF2 :                     REGPC:	DS	2
    8787/    FEF4 :                     REGI:	DS	1
    8788/    FEF5 :                     REGR:	DS	1
    8789/    FEF6 :                     REG_E:
    8790/    FEF6 :                     
    8791/    FEF6 :                     ; break, trace point work area
    8792/    FEF6 : =0FEF6H              dbg_wtop	equ	$
    8793/    FEF6 :                     tpt1_f:		ds	1
    8794/    FEF7 :                     tpt1_op:	ds	1	; save trace point1 opcode
    8795/    FEF8 :                     tpt1_adr:	ds	2
    8796/    FEFA :                     tpt2_f:		ds	1
    8797/    FEFB :                     tpt2_op:	ds	1	; save trace point2 opcode (for branch)
    8798/    FEFC :                     tpt2_adr:	ds	2
    8799/    FEFE :                     
    8800/    FEFE :                     ; break point work area
    8801/    FEFE :                     bpt1_f:		ds	1
    8802/    FEFF :                     bpt1_op:	ds	1
    8803/    FF00 :                     bpt1_adr:	ds	2
    8804/    FF02 :                     bpt2_f:		ds	1
    8805/    FF03 :                     bpt2_op:	ds	1
    8806/    FF04 :                     bpt2_adr:	ds	2
    8807/    FF06 :                     
    8808/    FF06 :                     tmpb_f:		ds	1
    8809/    FF07 :                     tmpb_op:	ds	1
    8810/    FF08 :                     tmpb_adr:	ds	2
    8811/    FF0A : =0FF0AH              dbg_wend	equ	$
    8812/    FF0A :                     
    8813/    FF0A :                     ; DIV 16 /16 buffer
    8814/    FF0A :                     DIV16_NA:	ds	2
    8815/    FF0C :                     DIV16_NB:	ds	2
    8816/    FF0E :                     DIV16_NC:	DS	2
    8817/    FF10 :                     DIV16_ND:	DS	2
    8818/    FF12 :                     
    8819/    FF12 :                     ; go command temp start address
    8820/    FF12 :                     goTmp:		ds	2
    8821/    FF14 :                     
    8822/    FF14 :                     ; trace mode switch
    8823/    FF14 :                     TP_mode:	ds	1	; N: display on, F: display off
    8824/    FF15 :                     TM_mode:	ds	1	; 'S':skip call, 'I':trace CALL IN
    8825/    FF16 :                     TC_cnt:		ds	2	; numbers of step
    8826/    FF18 :                     tmpT:		ds	2	; save temp buffer
    8827/    FF1A :                     fever_t:	ds	1	; flag trace forever
    8828/    FF1B :                     
    8829/    FF1B :                     ; minimal assembler
    8830/    FF1B :                     
    8831/    FF1B :                     asm_adr:	ds	2
    8832/    FF1D :                     tasm_adr:	ds	2
    8833/    FF1F :                     element_cnt:	ds	1	; Element count of input string
    8834/    FF20 :                     byte_count:	ds	1	; numbers of Machine code
    8835/    FF21 :                     opc_cd:		ds	1	; opecode number
    8836/    FF22 :                     opr1_cd:	ds	1	; 1st operand number
    8837/    FF23 :                     opr2_cd:	ds	1	; 2nd operand number
    8838/    FF24 :                     opr_num25:	ds	2	; save number nnnn
    8839/    FF26 :                     opr_num35:	ds	2	; save number (nnnn)
    8840/    FF28 :                     opr_num37:	ds	1	; save number (IY-nn)
    8841/    FF29 :                     opr_num34:	ds	1	; save number (IY+nn)
    8842/    FF2A :                     opr_num36:	ds	1	; save number (IX-nn)
    8843/    FF2B :                     opr_num33:	ds	1	; save number (IX+nn)
    8844/    FF2C :                     cb_mcw		ds	2	; use BIT, RES, SET
    8845/    FF2E :                     cb_xyw		ds	2	; use BIT, RES, SET
    8846/    FF30 :                     
    8847/    FF30 :                     F_bit:		ds	F_bitSize+1
    8848/    FF39 :                     ky_flg:		ds	1	; b00000ULC ( U: UPPER L: LF C: CR )
    8849/    FF3A :                     				; U=0: Lower To Upper
    8850/    FF3A :                     				; L=0: End of line is added LF
    8851/    FF3A :                     				; C=0: End of line is added CR
    8852/    FF3A :                     ;::::::::::::::::::::::::::
    8853/    FF3A :                     ; DISASEM work area
    8854/    FF3A :                     ;;;;;;;;;;;;;;;;;;;;;;;;;;;
    8855/    FF3A :                     dasm_ed:	ds	2
    8856/    FF3C :                     dasm_stpf:	ds	1
    8857/    FF3D :                     dasm_adr:	ds	2
    8858/    FF3F :                     reg_xy:		ds	2	; RNIX or RNIY
    8859/    FF41 :                     xy_srtp		ds	2	; strings pointer
    8860/    FF43 :                     
    8861/    FF43 :                     mc_Size:	ds	1
    8862/    FF44 :                     ;
    8863/    FF44 :                     ;	RECEIVE BUFFER
    8864/    FF44 :                     Rx_BCNT:	ds	1
    8865/    FF45 :                     Rx_BRP:		ds	1
    8866/    FF46 :                     Rx_BWP:		ds	1
    8867/    FF47 :                     Rx_BUF:		ds	Rx_BFSIZ
    8868/    FF87 :                     
    8869/    FF87 :                     ;	SEND BUFFER
    8870/    FF87 :                     Tx_BCNT:	ds	1
    8871/    FF88 :                     Tx_BRP:		ds	1
    8872/    FF89 :                     Tx_BWP:		ds	1
    8873/    FF8A :                     Tx_BUF:		ds	Tx_BFSIZ
    8874/    FFCA :                     tx_pend:	ds	1
    8875/    FFCB :                     
    8876/    FFCB :                     ;	XON/XOFF flag
    8877/    FFCB :                     rx_xflg:	ds	1
    8878/    FFCC :                     tx_xflg:	ds	1
    8879/    FFCD :                     rx_xreq:	ds	1
    8880/    FFCE :                     
    8881/    FFCE :                     ;;;;;;;;;;;;;;;;;;;
    8882/    FFCE :                     ; union area
    8883/    FFCE :                     ;;;;;;;;;;;;;;;;;;;
    8884/    FFCE :                     INBUF: ; Line input buffer
    8885/    FFCE :                     line_buf:
    8886/    FFCE :                     
    8887/    FFCE :                     ;  DidAsm string buffer
    8888/    FFCE :                     ; total 42 bytes
    8889/    FFCE :                     dasm_bs:
    8890/    FFCE :                     adr_mc_buf:	ds	19
    8891/    FFE1 :                     dasm_OpcStr:	ds	8
    8892/    FFE9 :                     dasm_OprStr:	ds	15 - NUMLEN
    8893/    FFF1 :                     num_string:	ds	NUMLEN	; max 65536 or 0FFFFH + null( max 7bytes )
    8894/    FFF8 :                     dasm_be:
    8895/    FFF8 :                     
    8896/    FFF8 :                     	END
 AS V1.42 Beta [Bld 227] - Source File AKI80mon_RevB04.asm - Page 2 - 1/5/2023 20:45:29


  Symbol Table (* = unused):
  --------------------------

 ACS_KN2K :                    0C25 C |  ADCSTR :                      12A7 C |
 ADC_3MC :                        4 - |  ADC_A_ :                      1D1C C |
 ADC_A_A :                     1D3E C |  ADC_A_N :                     1D36 C |
 ADC_A_X :                     1D33 C |  ADC_FD :                      1D5A C |
 ADC_HL_ :                     1D18 C |  ADC_HL_BC :                   1D17 C |
 ADC_HL_DE :                   1D13 C |  ADC_HL_HL :                   1D0F C |
*ADC_HL_SP :                   1D0B C |  ADC_MC :                         9 - |
 ADDIXRP_TBL :                 1438 C |  ADDIYRP_TBL :                 1440 C |
 ADDSTR :                      12A3 C |  ADD_HL_ :                     1DBA C |
 ADD_HL_BC :                   1DD1 C |  ADD_HL_DE :                   1DD6 C |
 ADD_HL_HL :                   1DDB C | *ADD_HL_SP :                   1DCC C |
 ADD_IX_ :                     1D80 C |  ADD_IX_IX :                   1DA8 C |
*ADD_IY_ :                     1D7C C |  ADD_IY_IY :                   1DB2 C |
 ADD_OPSTR :                   115D C |  ADD_RP_E :                    1208 C |
 ADD_RP_S :                    1204 C |  ADD_XY_BC :                   1DA0 C |
 ADD_XY_DE :                   1DA4 C | *ADD_XY_SP :                   1D99 C |
 ADD_XY_XY :                   1DAE C |  ADR_MC_BUF :                 0FFCE C |
 ADR_OVR :                     25D2 C |  ANALIZE_INPUT :               2462 C |
 ANALIZE_OPR :                 24A4 C |  ANDSTR :                      12B3 C |
 AND_CP :                      22DB C |  AN_ERR :                      2499 C |
 APENDTBL :                     26C C |  API01 :                       27A0 C |
 API06 :                       27E2 C |  APITBL :                      2774 C |
 APITBL_E :                    27A0 C |
*ARCHITECTURE :                                        "i386-unknown-win32" - |
 ASM_ADR :                    0FF1B C |  ASM_ERR :                     1A95 C |
*ASM_ERR1 :                    1A98 C |  A_COLON_SP :                  11B0 C |
 A_CRLF :                      117B C |  BACKDOOR :                       0 - |
 BACKTOMON :                   28A7 C |  BASE1 :                       22BC C |
 BASIC_CST :                   2F00 - |  BASIC_TOP :                   2F00 - |
 BASIC_WST :                   2F03 - |  BITSTR :                      1326 C |
 BIT_IXM :                     1C18 C |  BIT_IXP :                     1C06 C |
 BIT_IXP1 :                    1C09 C |  BIT_IYM :                     1C25 C |
 BIT_IYP :                     1C1D C |  BIT_IYP1 :                    1C20 C |
 BIT_MCB :                     1BA1 C |  BIT_MCBE :                    1BA9 C |
 BIT_MCBN :                       8 - |  BIT_RES_SET :                 1BBD C |
 BIT_XYT :                     1BA9 C |  BI_HEX :                      257E C |
 BPT1_ADR :                   0FF00 C |  BPT1_F :                     0FEFE C |
 BPT1_OP :                    0FEFF C |  BPT2_ADR :                   0FF04 C |
 BPT2_F :                     0FF02 C |  BPT2_OP :                    0FF03 C |
 BP_CHK1 :                     2845 C |  BP_CHK_END :                  2872 C |
 BP_CLR :                       3CD C |  BP_CLR1 :                      3E3 C |
 BP_LOT :                       3F4 C |  BP_MSG1 :                      40A C |
 BP_MSG2 :                      40E C |  BRK_CMD :                      37B C |
 BS :                             8 - |  BUFLEN :                        28 - |
 BYTE_COUNT :                 0FF20 C |  B_ACLR :                       3E8 C |
 B_LIST :                       35B C |  B_LIST1 :                      369 C |
 B_MSG_OUT :                    411 C |  C0END :                         60 - |
 CALC_DIS_STEP :                938 C |  CALC_RELADR :                 25AB C |
 CALLSTR :                     1292 C |  CALL_MC1T :                   1C2A C |
 CAL_01 :                      25C1 C |  CAL_1 :                       25C4 C |
*CASESENSITIVE :                  0 - |  CB_MCW :                     0FF2C C |
 CB_XYW :                     0FF2E C |  CC0 :                         13A2 C |
 CC1 :                         13A5 C |  CC2 :                         13A7 C |
 CC3 :                         13AA C |  CC4 :                         13AC C |
 CC5 :                         13AF C |  CC6 :                         13B2 C |
 CC7 :                         13B4 C |  CCFSTR :                      12FB C |
 CC_NNNN :                     0D06 C |  CC_OPR :                      13C6 C |
 CHKERR :                       3CB C |  CHK_0CBH :                    0D23 C |
 CHK_0DD3OP :                  0E70 C |  CHK_0DD4OP :                  0EEF C |
 CHK_0DDH :                    0DE9 C |  CHK_0DDH_1 :                  0DFC C |
 CHK_0EDH :                    0F8F C |  CHK_0FDH :                    108C C |
 CHK_1MC_BNH :                 0B82 C |  CHK_2MC :                     0BCF C |
 CHK_3MC :                     0C7F C |  CHK_ADC :                     0A48 C |
 CHK_ADC3MC :                  1D41 C |  CHK_ADD :                     0A3C C |
 CHK_ADD_RP :                  0B01 C |  CHK_AND :                     0A72 C |
 CHK_BP :                      2836 C |  CHK_CALCC :                   0D14 C |
 CHK_CALLN4 :                  0CED C |  CHK_CP :                      0A96 C |
 CHK_DD_CB :                   0F3B C |  CHK_DEC :                     0ABB C |
 CHK_DEC_RP :                  0AE8 C |  CHK_DI1 :                      8E0 C |
 CHK_DJNZ :                    0C4A C |  CHK_EX :                      0B51 C |
 CHK_FEVRE :                    51F C |  CHK_INC :                     0AA3 C |
 CHK_INC_RP :                  0ACF C |  CHK_JPCC :                    0CF9 C |
 CHK_JPN4 :                    0CE1 C |  CHK_JRCC :                    0C63 C |
 CHK_JRNN :                    0C53 C |  CHK_LD :                       9CD C |
 CHK_LD1 :                     0A0B C |  CHK_LD16 :                    0CA0 C |
 CHK_LOGOP2 :                  0BF6 C |  CHK_NTRACE :                  288A C |
 CHK_OR :                      0A8A C |  CHK_POP_RP :                  0B1F C |
 CHK_PUSH_RP :                 0B38 C |  CHK_RET :                     0B95 C |
 CHK_RST :                     0BAE C |  CHK_SBC :                     0A63 C |
 CHK_STPDI :                    8FF C |  CHK_STRINGS :                 2505 C |
 CHK_SUB :                     0A57 C |  CHK_XOR :                     0A7E C |
 CK_ENDMK :                    256B C |  CLCC_TBLE :                    6EF C |
 CLCC_TBLS :                    6E7 C |  CLR_CRT :                     266E C |
 CLR_PEND :                      80 C |  CLR_TXINTPENDING :              89 C |
 CMD_HLP :                     29D7 C |  COMMAND_HLP :                  21F C |
*COMPMODE :                       0 - |  COM_ERRM :                    1395 C |
 CONIN :                       2E3C C |  CONOUT :                      2E8B C |
 CONOUT1 :                     2E90 C |  CONST :                       2E86 C |
*CONSTPI :        3.141592653589793 - |  CONT_ASM :                    1B13 C |
 CONT_RCV :                    2E6F C |  COUT_SP :                     1AA6 C |
 COUT_SP1 :                    1ABC C |  COUT_SP2 :                    1AD8 C |
 CPDRSTR :                     1378 C |  CPDSTR :                      1352 C |
 CPIRSTR :                     1364 C |  CPISTR :                      1341 C |
 CPLSTR :                      12F3 C |  CPSTR :                       12BE C |
 CPSTREND :                    21C4 C |  CPSTR_CRLF :                  1189 C |
 CP_IXIY :                     230C C |  CP_IY :                       2314 C |
 CP_XY1 :                      2319 C |  CR :                            0D - |
 CRLF :                        2664 C |  CTC0 :                          10 - |
 CTC0CD :                        5E C |  CTL_RCV :                      0A2 C |
 CTL_RCV1 :                     0C9 C |  CTL_TXFLG :                     9D C |
 D16_END :                     2970 C |  D16_MINUS :                   2968 C |
 D16_MINUS_AFTER :             296C C |  D16_MINUS_BEFORE :            2967 C |
 D16_PLUS :                    295C C |  D16_PLUS_AFTER :              2960 C |
 DAASTR :                      12EF C |  DASM_ADR :                   0FF3D C |
 DASM_BE :                    0FFF8 C |  DASM_BS :                    0FFCE C |
 DASM_ED :                    0FF3A C |  DASM_OPCSTR :                0FFE1 C |
 DASM_OPRSTR :                0FFE9 C |  DASM_STPF :                  0FF3C C |
*DATE :                  "1/5/2023" - |  DBG_WEND :                   0FF0A - |
*DBG_WTOP :                   0FEF6 - |  DDLOGTBL :                    1448 C |
 DD_21 :                       0F15 C |  DD_22 :                       0F22 C |
 DD_2A :                       0F2B C |  DD_2A1 :                      0F2F C |
 DD_2NDTBL :                    7AA C |  DD_2NDTBL1 :                   7AE C |
 DD_2NDTBL2 :                   7B2 C |  DD_2NDTBL_E :                  7B4 C |
 DD_2OPT :                     1430 C |  DD_BIT :                      0F7F C |
 DD_BIT_OPTBL :                122C C |  DD_BIT_OPTBLE :               1244 C |
 DD_BSR :                      0F76 C |  DD_CB_NN_XX :                 0F5B C |
 DD_LD :                       0EAF C |  DD_LD1 :                      0EC7 C |
 DD_LDTBL :                    1456 C |  DD_LD_TBL :                   1210 C |
 DD_LD_TBLE :                  121E C |  DD_LOG_TBL :                  121E C |
 DD_LOG_TBLE :                 1225 C |  DD_MIX :                      0EDA C |
 DD_MIX1 :                     0EE5 C |  DD_MIX2 :                     0EEA C |
 DD_MIX3 :                     0EDD C |  DD_MIX4 :                     0ED3 C |
 DD_RES :                      0F87 C |  DD_RT_STR :                   148E C |
 DD_RT_TBLE :                  122C C |  DD_RT_TBLES :                 1225 C |
 DEADDR :                     0FED2 C |  DECSTR :                      12C5 C |
 DEC_CHR :                     2590 C |  DEC_NUM :                     25A9 C |
 DEC_OPCDTBLE :                11FC C |  DEC_OPCDTBLS :                11F4 C |
 DEC_OPR :                     2337 C |  DEC_RP_E :                    1204 C |
 DEC_RP_S :                    1200 C |  DEC_STR :                     2919 C |
 DEL :                           7F - |  DEX_SP_HL :                   0B7A C |
 DIP_TM :                       462 C |  DISASM_GO :                    90D C |
 DISASSEMBLE :                  8BD C |  DISREGTBL :                   13B6 C |
 DISTR :                       12FF C |  DIS_ANALYSIS :                 99C C |
 DIS_CALL :                    28E4 C |  DIS_GO1 :                      918 C |
*DIV16 :                       2973 C |  DIV16_8 :                     294F C |
 DIV16_NA :                   0FF0A C |  DIV16_NB :                   0FF0C C |
 DIV16_NC :                   0FF0E C |  DIV16_ND :                   0FF10 C |
 DIV16_X0 :                    29B0 C |  DIV16_X1 :                    29BB C |
 DIV16_X2 :                    2989 C |  DIXN_TBL :                    2333 C |
 DIX_TBL :                     2331 C |  DIYN_TBL :                    2335 C |
 DI_3MC :                      238B C |  DI_3MC1 :                     2391 C |
 DI_IXNNUM :                      4 - |  DI_IXYNUM :                      6 - |
 DI_IY :                       2387 C |  DI_IYNNUM :                      2 - |
 DI_NBS :                        12 - |  DI_NXT :                       8C6 C |
 DJNZSTR :                     128D C |  DJPHL :                        5F1 C |
 DMKST1 :                      1171 C |  DMKST2 :                      1173 C |
 DMKSTR0 :                     1167 C |  DMP_DB :                      1AE9 C |
 DMP_DW :                      1AF4 C |  DM_BIT :                        80 - |
 DONOT_TRACE :                 14F9 C |  DP0 :                          7C9 C |
 DP00 :                         7D9 C |  DP1 :                          7EE C |
 DPB :                          871 C |  DPB0 :                         888 C |
 DPB1 :                         897 C |  DPB2 :                         89C C |
 DPL :                          837 C |  DPL0 :                         848 C |
 DPL1 :                         858 C |  DPL2 :                         867 C |
 DPL3 :                         86C C |  DPM :                          80A C |
 DPM0 :                         815 C |  DPM1 :                         831 C |
 DPM_C :                        804 C |  DSADDR :                     0FED0 C |
 DSAP :                        2C0E C |  DSEP0 :                       2C07 C |
 DSEP1 :                       2C0A C |  DSTATE :                     0FED4 C |
 DUMP :                         7B4 C |  D_I_TB :                      2325 C |
 D_I_TBE :                     2337 C |  E1S :                           0E - |
 E1S1 :                          15 - |  E1_E :                        20B6 C |
 E1_E1 :                       20D9 C |  E1_S :                        20A8 C |
 E1_S1 :                       20C4 C |  E2S :                           1A - |
 E2_E :                        2144 C |  E2_S :                        212A C |
 ED_4MC :                      106D C |  ED_ADC :                      101B C |
 ED_IM :                       104C C |  ED_LD_AI :                    1035 C |
 ED_LD_AR :                    102C C |  ED_LD_IA :                    1047 C |
 ED_LD_RA :                    103E C |  ED_LD_RA1 :                   1041 C |
 ED_NOOPR :                    1464 C |  ED_NO_OPR :                   105F C |
 ED_OP_TBL :                   1244 C |  ED_OP_TBLE :                  127C C |
 ED_OUT :                      0FEA C |  ED_OUT1 :                     0FFE C |
 ED_RP_STR :                   1424 C |  ED_SBC :                      1005 C |
 ED_SBC1 :                     1014 C |  EISTR :                       1302 C |
 EL2_12 :                      23F8 C |  EL2_13 :                      23EE C |
 EL2_130 :                     240E C |  EL2_16 :                      23F3 C |
 EL2_17 :                      23E9 C |  EL2_18 :                      23E4 C |
 EL2_19 :                      23DF C |  EL2_20 :                      23DA C |
 EL2_23 :                      2360 C |  EL2_24 :                      22D9 C |
 EL2_26 :                      235B C |  EL2_27 :                      22D5 C |
 EL2_28 :                      22D1 C |  EL2_29 :                      22CD C |
 EL2_41 :                      22C9 C |  EL2_410 :                     22FA C |
 EL2_411 :                     2307 C |  EL2_42 :                      228F C |
 EL2_43 :                      222E C |  EL2_44 :                      2213 C |
 EL2_441 :                     2224 C |  EL2_45 :                      21F8 C |
 EL2_451 :                     2202 C |  EL2_46 :                      226B C |
 EL2_49 :                      2241 C |  EL2_54 :                      2440 C |
 EL2_541 :                     245B C |  EL2_5411 :                    245C C |
 EL2_68 :                      21DA C |  EL2_69 :                      21A1 C |
 EL2_691 :                     21C8 C |  EL2_692 :                     21B6 C |
 EL2_70 :                      218C C |  EL2_8 :                       23A6 C |
 EL2_81 :                      23A8 C |  EL2_82 :                      23CC C |
 EL2_9 :                       23A2 C |  EL2_DI :                      2363 C |
 EL3_1 :                       1E6A C |  EL3_11 :                      1F08 C |
 EL3_12 :                      1E92 C |  EL3_121 :                     1F98 C |
 EL3_125 :                     1E96 C |  EL3_126 :                     1EAC C |
 EL3_13 :                      1FC9 C |  EL3_14 :                      1FD7 C |
 EL3_1_2 :                     1F83 C |  EL3_21 :                      1D5E C |
 EL3_211 :                     1D82 C |  EL3_212 :                     1D9B C |
 EL3_22 :                      1CE5 C |  EL3_221 :                     1CEB C |
 EL3_25 :                      1CDD C |  EL3_34 :                      1BB1 C |
 EL3_341 :                     1C02 C |  EL3_342 :                     1C0C C |
 EL3_35 :                      1B75 C |  EL3_36 :                      1B93 C |
 EL3_42 :                      1C3F C |  EL3_421 :                     1C42 C |
 EL3_43 :                      1CA8 C |  EL3_431 :                     1CC9 C |
 EL3_45 :                      1C32 C |  EL3_55 :                      1C68 C |
 EL3_550 :                     1C73 C |  EL3_551 :                     1C91 C |
 EL3_552 :                     1C94 C |  EL3_6 :                       1DE0 C |
 EL3_60 :                      1C5F C |  EL3_61 :                      1E23 C |
 EL3_JTB :                     1B4B C |  EL3_S13 :                     20A3 C |
 EL3_S16 :                     2057 C |  EL3_S161 :                    207B C |
 EL3_S162 :                    207F C |  EL3_S163 :                    2083 C |
 EL3_S1631 :                   2085 C |  EL3_S164 :                    208C C |
 EL3_S17 :                     209E C |  EL3_S26 :                     2099 C |
 EL3_S261 :                    209B C |  EL3_S27 :                     2095 C |
 EL3_S28 :                     2028 C |  EL3_S281 :                    2048 C |
 EL3_S282 :                    2044 C |  EL3_S283 :                    2041 C |
 EL3_S35 :                     1FF3 C |  EL3_S351 :                    2013 C |
 EL3_S352 :                    201F C |  EL3_S353 :                    2019 C |
 EL3_STB :                     1B3E C |  EL3_STBE :                    1B4B C |
 EL3_UM :                        0D - |  ELEM1_CD :                    20A8 C |
 ELEM1_CD1 :                   20C4 C |  ELEM1_OPCD :                  20B6 C |
 ELEM1_OPCD1 :                 20D9 C |  ELEM2_CD :                    212A C |
 ELEMENT_CNT :                0FF1F C |  END_DEC :                     2948 C |
 END_INS_TC :                   657 C |  END_TX :                      2EC3 C |
 ENTRY :                         40 - |  ENT_EL2 :                     2144 C |
 ERR :                          217 C |  ERRMSG :                      2BFF C |
 ERR_TRACE_SEQ :                65A C |  ER_OPMSG :                    1395 C |
 ESC :                           1B - |  ESC_CRT_CLR :                 2677 C |
 EXP_MSB :                      679 C |  EXSTR :                       12D2 C |
 EXT_ASM :                     1A84 C |  EXXSTR :                      12D5 C |
 EX_AF_ :                      1E11 C |  EX_AF_AF :                    0B6C C |
 EX_DE_ :                      1E1B C |  EX_SP_HL :                    1E0E C |
 EX_SP_IX :                    1E08 C |  EX_SR_ :                      1E46 C |
 EX_SR_NUM :                      4 - | *E_CSTART :                       0 C |
*FALSE :                          0 - |  FEVER_T :                    0FF1A C |
 FLG_LOOP :                    1864 C |  FLG_NXT :                     1873 C |
 FLG_OFF :                     186F C | *FULLPMMU :                       1 - |
 F_BIT :                      0FF30 C |  F_BITSIZE :                      8 - |
 F_BIT_OFF :                   188F C |  F_BIT_ON :                    1887 C |
 G0 :                          14D9 C |  GADDR :                      0FED5 C |
 GAME80_CST :                  5400 - | *GAME80_TOP :                  5400 - |
*GAME80_WST :                  5403 - |  GETLIN :                      267B C |
 GET_BI :                       338 C |  GET_DI1 :                      8DA C |
 GET_DISASM_ST :                946 C |  GET_DNUM :                     30E C |
 GET_N4 :                      0CC8 C |  GET_N4CRLF :                  0C9A C |
 GET_NNNN :                    10CB C |  GET_NUM :                      316 C |
 GET_NUM0 :                     319 C |  GET_NUMBER :                  254E C |
 GET_RSTG_OFF :                10DF C |  GET_R_NUM :                    9C4 C |
 GET_STRBUFPOINT :             10E2 C |  GET_TXDAT :                   2EC9 C |
 GL0 :                         2680 C |  GL00 :                        2686 C |
 GL001 :                       26A7 C |  GL1 :                         26CC C |
 GLB :                         26D0 C |  GLE :                         26E7 C |
 GLE_END :                     25F6 C |  GLE_END1 :                    25F4 C |
 GO :                          149C C |  GO1 :                         14D3 C |
 GOSTMP :                      14B0 C |  GOTMP :                      0FF12 C |
 G_STPADR :                    14B4 C |  H2SA_1 :                      1137 C |
 H2S_N1 :                      114D C |  H2S_N2 :                      1151 C |
 H4SA_1 :                      1126 C |  H4SA_2 :                      1129 C |
*HAS64 :                          0 - | *HASFPU :                         0 - |
*HASPMMU :                        0 - |  HEX2STR :                     1144 C |
 HEX2STR_ASM :                 112E C |  HEX4STR :                     113C C |
 HEX4STR_ASM :                 111D C |  HEXIN :                       2640 C |
 HEXMOD :                     0FED9 C |  HEXOUT1 :                     2632 C |
 HEXOUT2 :                     2629 C |  HEXOUT4 :                     2624 C |
 HEX_CHR :                     259A C |  HI0 :                         2648 C |
 HI1 :                         265F C |  HIR :                         2662 C |
 HLTSTR :                      129E C |  HL_CRLF :                     1186 C |
 IB1 :                          68A C |  IB2 :                          689 C |
 IB3 :                          688 C |  ICKA1 :                        6C3 C |
 ICKA_END :                     6CE C |  IGNORE :                       0DE C |
 IHEMSG :                      2BE5 C |  IHEXER :                      2C11 C |
 IKK_1 :                       11C9 C |  IMSTR :                       1332 C |
 INADR_CHK_AND_WRT :            6A8 C |  INBUF :                      0FFCE C |
 INCSTR :                      12C1 C |  INC_DEC :                     0AB5 C |
 INC_DEC_ADDRP :               13DE C |  INC_ELEMENT :                 249C C |
 INC_OPCDTBLE :                11F4 C |  INC_OPCDTBLS :                11EC C |
 INC_OPR :                     2349 C |  INC_RP_E :                    1200 C |
 INC_RP_S :                    11FC C |  INDRSTR :                     137D C |
 INDSTR :                      1356 C |  INIRSTR :                     1369 C |
 INISTR :                      1345 C |  INIT_RAM :                     107 C |
 INS2 :                         6F7 C |  INSBRK_1OP :                   67B C |
 INSBRK_2OP :                   680 C |  INSBRK_3OP :                   685 C |
 INSBRK_BRP :                   68F C |  INSBRK_SP :                    69B C |
 INSPOSTSTR :                  118C C |  INSTC1 :                       5AB C |
*INSTC2 :                       539 C |  INSTR :                       1309 C |
*INSUPMODE :                      0 - |  INS_EX_OPC :                  0B66 C |
 INS_HLKK :                    0CD2 C |  INS_HL_OPR :                  0B63 C |
 INS_IXRP :                    0E5B C |  INS_JPIX :                    0E31 C |
*INS_JPIX1 :                   0E35 C |  INS_KAKKOL :                  11C3 C |
 INS_KAKKOR :                  11C7 C |  INS_KKA :                     0CBC C |
 INS_KKHL :                    0CB6 C |  INS_KMR :                     11D8 C |
 INS_KN2K :                    0C2E C |  INS_KN4KCS :                  10F7 C |
 INS_KSPKIX :                  0E43 C |  INS_MISR :                    11D4 C |
 INS_N2CRLF :                  0C1B C |  INS_PLSR :                    11D0 C |
 INS_RSTG :                    0DCE C |  INS_SPCR :                    11CC C |
 INS_SPIX :                    0E52 C |  INTEXT :                       0DA C |
 INTRXD :                        8F C |  INTTXD :                        68 C |
 INTTX_NXT :                     79 C |  IN_A_NN :                     1C97 C |
 IN_SELM :                        6 - |  IN_SELT :                     1E27 C |
 IOSET :                        0E1 C |  IR0 :                          143 C |
 IR00 :                         15A C |  IX_CRLF :                     1180 C |
 JPCC_TBLE :                    6E7 C |  JPCC_TBLS :                    6DF C |
 JPHL :                        22B3 C |  JPIX :                        22AC C |
 JPNNNN :                      22B7 C |  JPSTR :                       1287 C |
 JP_EACH :                     1B37 C |  JP_MC1T :                     1C37 C |
 JP_MC1TE :                    1C3F C |  JP_MC1TM :                       8 - |
 JRCC_OPR1 :                   13D6 C |  JRCC_TBLE :                    6DF C |
 JRCC_TBLS :                    6DA C |  JRCC_TBLS1 :                   6DB C |
 JRSTR :                       128A C |  JR_CCT :                      1CA4 C |
 JR_N4CRLF :                   0C5A C |  KCKSTR :                      1399 C |
 KIXYPNK_CRLF :                10A6 C |  KIXYPNK_CS :                  109D C |
 KN2K :                        0C3A C |  KN4HK :                       0CC2 C |
 KN4KCRLF :                    0CD8 C |  KRNHL :                       139D C |
 KY_FLG :                     0FF39 C |  LANCH1 :                       27A C |
 LANCH2 :                       28E C |  LANCH3 :                       2A4 C |
 LANCH4 :                       2C3 C |  LANCH5 :                       2E4 C |
 LANCH6 :                       2F8 C |  LAUNCHER :                     227 C |
 LD1OP :                       0A1E C |  LD1_BASE :                    1E4F C |
*LDA_SP :                      1E4A C |  LDA_SPE :                     1E4F C |
 LDDRSTR :                     1373 C |  LDDSTR :                      134E C |
 LDIRSTR :                     135F C |  LDISTR :                      133D C |
 LDNR_C :                      1FEC C |  LDNR_N :                         7 - |
 LDNR_T :                      1FE5 C |  LDSTR :                       129B C |
 LD_A_KBCK :                    9EA C |  LD_A_KDEK :                    9F8 C |
 LD_A_KXXK :                    9ED C | *LD_BC_N4 :                    1F1F C |
 LD_BC_N40 :                   1F25 C |  LD_BC_N41 :                   1F36 C |
 LD_BC_N42 :                   1F3D C |  LD_DE_N4 :                    1F48 C |
 LD_E2_TBL :                   1E26 C |  LD_E2_TBL1 :                  1E2D C |
 LD_E2_TBL2 :                  1E32 C |  LD_E2_TBL3 :                  1E36 C |
 LD_E2_TBLE :                  1E3D C |  LD_EN1 :                         7 - |
 LD_EN2 :                         5 - |  LD_EN3 :                         4 - |
 LD_EN4 :                         7 - |  LD_HL_N4 :                    1F50 C |
 LD_IX_N4 :                    1F65 C |  LD_IX_N40 :                   1F67 C |
 LD_IX_N42 :                   1F78 C |  LD_IY_N4 :                    1F7F C |
 LD_KBCK_A :                    9FD C |  LD_KDEK_A :                   0A06 C |
 LD_KXXK_A :                   0A00 C |  LD_R13 :                      1EC8 C |
 LD_R17 :                      1EC3 C |  LD_R171 :                     1EC5 C |
 LD_R25 :                      1EF6 C |  LD_R251 :                     1EFA C |
 LD_R26 :                      1ED1 C |  LD_R27 :                      1ECC C |
 LD_R33 :                      1EF1 C |  LD_R34 :                      1EE4 C |
 LD_R35 :                      1EB2 C |  LD_R36 :                      1EE9 C |
 LD_R361 :                     1EEC C |  LD_R37 :                      1ED6 C |
 LD_R371 :                     1ED9 C |  LD_R372 :                     1EDC C |
 LD_RRN :                         8 - |  LD_RR_ :                      1E45 C |
 LD_RXYN_SP :                    0A - |  LD_R_JT :                     1E56 C |
 LD_R_NN_E :                    798 C |  LD_R_NN_S :                    790 C |
 LD_XYNLN :                    1FB9 C |  LF :                            0A - |
 LF_OUT :                      1A90 C |  LH0 :                         15F0 C |
*LH1 :                         15F7 C |  LH2 :                         15FB C |
 LH3 :                         1603 C |  LHI0 :                        1608 C |
 LHI1 :                        162B C |  LHI2 :                        163D C |
 LHI20 :                       163C C |  LHI3 :                        163F C |
 LHIE :                        164F C |  LHS0 :                        1658 C |
 LHS1 :                        1675 C |  LHS2 :                        1687 C |
 LHS20 :                       1688 C |  LHS3 :                        168A C |
 LHSE :                        16A4 C |  LHSR :                        16AA C |
 LINE_ASM :                    1A29 C |  LINE_BUF :                   0FFCE C |
*LISTON :                         1 - |  LOADH :                       15D3 C |
 LOGOP2STR :                   1408 C |  LOGOP3STR :                   141C C |
 LOG_OP_E :                     7A2 C |  LOG_OP_S :                     798 C |
 LOOP_DEC :                    292F C |  LOOP_M8 :                     29CA C |
 LOP_GNUM :                    255B C |  LST_PRG :                      257 C |
 LST_PRG1 :                     25A C |  L_B2 :                         404 C |
*MACEXP :                         7 - |  MAS_1 :                        977 C |
 MAS_2 :                        988 C |  MAS_3 :                        994 C |
 MC2_77 :                      1FB4 C |  MC_END :                      2107 C |
 MC_END2 :                     2126 C |  MC_END3 :                     220E C |
*MC_END4 :                     243B C |  MC_END41 :                    2431 C |
 MC_SIZE :                    0FF43 C |  MEET_DD :                      722 C |
 MEET_ED :                      744 C |  MEET_OP1 :                     760 C |
 MEET_OP2 :                     76B C |  MEET_OP3 :                     776 C |
 MEET_OP4 :                     781 C |  MKMC_SH :                     1CCC C |
 MKMC_SHED :                   1CDC C |  MKOPCSTR :                    1160 C |
 MKREL_STR :                   110F C |  MK_2NDOPR :                   0A2A C |
 MK_2NDOPR1 :                  0A34 C |  MK_ADR_STR :                   961 C |
 MK_BITR :                     0DB1 C |  MK_BITR_STR :                 0DC9 C |
 MK_E1 :                       20EE C |  MK_E11 :                      210D C |
 MK_E2 :                       2178 C | *MK_E3 :                       1B26 C |
 MK_KIXPNK :                   0EA5 C |  MK_KIXYPNK :                  10AC C |
*MK_KIYPNK :                   0EA9 C |  MK_KN4K :                     1106 C |
 MK_KRK :                      119A C |  MK_KRKCS :                    11A2 C |
 MK_KRK_1 :                    1197 C |  MK_N2CRLF :                   10EB C |
 MK_N4CRLF :                   10F1 C |  MK_RCS :                      11B3 C |
 MK_RESR :                     0DBA C |  MK_RLCR :                     0D72 C |
 MK_RLR :                      0D84 C |  MK_RRCR :                     0D7B C |
 MK_RRR :                      0D8D C |  MK_SLAR :                     0D96 C |
 MK_SRAR :                     0D9F C |  MK_SRLR :                     0DA8 C |
 MK_STR :                      10D6 C | *MOMCPU :                        80 - |
*MOMCPUNAME :                 "Z80" - |  MSTACK_SIZE :                   40 - |
 MUL_10 :                       347 C |  MUL_8 :                       29C5 C |
 M_NUM :                          5 - |  NEGSTR :                      132E C |
*NESTMAX :                      100 - |  NEXT_ASM :                    1A47 C |
 NEXT_BC1 :                     556 C |  NEXT_BC10 :                    630 C |
 NEXT_BC11 :                    63D C |  NEXT_BC111 :                   652 C |
 NEXT_BC2 :                     579 C |  NEXT_BC21 :                    587 C |
 NEXT_BC22 :                    5A2 C | *NEXT_BC221 :                   5A0 C |
 NEXT_BC222 :                   59A C |  NEXT_BC3 :                     5BA C |
 NEXT_BC4 :                     5CF C |  NEXT_BC5 :                     5E6 C |
 NEXT_BC6 :                     5DD C |  NEXT_BC7 :                     5FA C |
 NEXT_BC8 :                     609 C |  NEXT_BC9 :                     61C C |
 NEXT_CHAR :                   2602 C |  NMIVEC :                        66 - |
 NOPSTR :                      12D9 C |  NO_API :                      2771 C |
 NO_CR :                          1 - |  NO_LF :                          2 - |
 NO_NUM :                      2598 C |  NO_OPERATE :                  2770 C |
 NO_RAM_AREA :                  6D0 C |  NO_RST38_MSG :                2879 C |
 NO_UPPER :                       4 - |  NUMLEN :                         7 - |
 NUMPLUS :                     10C6 C |  NUM_STRING :                 0FFF1 C |
 NXCHR :                       260C C |  NXT_A1 :                      24EE C |
 NXT_A2 :                      24CA C |  NXT_A21 :                     24D1 C |
 NXT_A22 :                     24D6 C |  NXT_A3 :                      24D9 C |
 NXT_A31 :                     24E0 C |  NXT_A4 :                      24E9 C |
 NXT_SR :                      2414 C |  N_END :                       254B C |
*OKRAM :                       21EE C |  OK_MATCH :                    2546 C |
 ONLY_NUM :                    2510 C |  OPC_CD :                     0FF21 C |
 OPERAND_CDS :                 19B4 C |  OPE_CDS :                     1897 C |
 OPNMSG :                      2BA5 C |  OPR1_CD :                    0FF22 C |
 OPR2_CD :                    0FF23 C |  OPR_CD1 :                     1A14 C |
 OPR_NUM25 :                  0FF24 C |  OPR_NUM33 :                  0FF2B C |
 OPR_NUM34 :                  0FF29 C |  OPR_NUM35 :                  0FF26 C |
 OPR_NUM36 :                  0FF2A C |  OPR_NUM37 :                  0FF28 C |
 OP_ERR :                      0DC3 C |  ORSTR :                       12BB C |
 OTDRSTR :                     1382 C |  OTH_1OP_E :                   11EC C |
 OTH_1OP_S :                   11DF C |  OTH_1OP_TBL :                 13EE C |
 OTIRSTR :                     136E C |  OUTDSTR :                     135A C |
 OUTISTR :                     1349 C |  OUTSTR :                      1305 C |
*PADDING :                        1 - |  POPSTR :                      12C9 C |
 POP_PUSHRP :                  13E6 C |  POP_RP_E :                    120C C |
 POP_RP_S :                    1208 C |  POTB_CST :                    4C00 - |
*POTB_TOP :                    4C00 - |  POTB_WST :                    4C03 - |
 PP_BASE :                     239C C |  PP_IXIY :                        2 - |
 PP_IXY :                      239A C |  PP_NO :                          6 - |
 PP_TBL :                      2396 C |  PP_TBLE :                     239C C |
 PROMPT :                      2BE2 C |  PRTDMP :                      1AFC C |
 PSIOAC :                        19 - |  PSIOAD :                        18 - |
 PUSHSTR :                     12CD C |  PUSH_RP_E :                   1210 C |
 PUSH_RP_S :                   120C C |  RAMSIZ :                      8000 - |
 RAM_B :                       8000 - |  RAM_E :                      0FFFF - |
 RD0 :                         180E C |  RD1 :                         1846 C |
 RD10 :                        1834 C |  RD101 :                       182A C |
 RD20 :                        1853 C |  RDHEX :                       2715 C |
 RDSA :                        2C81 C |  RDSAX :                       2CA6 C |
 RDSBC :                       2C85 C |  RDSBCX :                      2CAC C |
 RDSDE :                       2C8B C |  RDSDEX :                      2CB2 C |
 RDSF :                        2C97 C |  RDSFX :                       2CBE C |
 RDSFX_H :                       2C - |  RDSFX_L :                      0BE - |
 RDSF_H :                        2C - |  RDSF_L :                        97 - |
 RDSHL :                       2C91 C |  RDSHLX :                      2CB8 C |
 RDSI :                        2CCD C |  RDSIX :                       2C9C C |
 RDSIY :                       2CA1 C |  RDSPC :                       2CC8 C |
 RDSR :                        2CD1 C |  RDSSP :                       2CC3 C |
 RDTAB :                       2C2C C |  RDUMP :                       180B C |
 RECORR :                      25FA C |  RECORR1 :                     25FC C |
 RECORRECT :                   25D5 C |  RECTYP :                     0FEDA C |
 REG :                         1785 C |  REGAF :                      0FEDC C |
 REGAFX :                     0FEE4 C |  REGBC :                      0FEDE C |
 REGBCX :                     0FEE6 C |  REGDE :                      0FEE0 C |
 REGDEX :                     0FEE8 C |  REGHL :                      0FEE2 C |
 REGHLX :                     0FEEA C |  REGI :                       0FEF4 C |
 REGIX :                      0FEEC C |  REGIY :                      0FEEE C |
 REGPC :                      0FEF2 C |  REGR :                       0FEF5 C |
 REGSP :                      0FEF0 C |  REG_B :                      0FEDC C |
*REG_E :                      0FEF6 C |  REG_XY :                     0FF3F C |
*RELAXED :                        0 - |  REL_ADR_C :                    66E C |
 REPEAT_TRACE :                28C8 C |  RESSTR :                      132A C |
 RES_MCB :                     1B83 C |  RES_XYT :                     1B8B C |
 RETCC_TBLE :                   6DA C |  RETCC_TBLS :                   6D2 C |
 RETISTR :                     1387 C |  RETNSTR :                     138C C |
 RETSTR :                      1283 C |  RET_CD :                      2287 C |
 RET_NO :                      227F C |  RG0 :                         1792 C |
 RG1 :                         1796 C |  RG2 :                         17A6 C |
 RG3 :                         17B5 C |  RG4 :                         17DA C |
 RG5 :                         17E6 C |  RG6 :                         1802 C |
 RG7 :                         1805 C |  RGE :                         1808 C |
 RGR :                         1805 C |  RH0 :                         271A C |
 RH1 :                         272D C |  RHE :                         274B C |
 RHE1 :                        2755 C |  RHLNNXY :                       0D - |
 RLASTR :                      12E7 C |  RLCASTR :                     12DD C |
 RLCSTR :                      130C C |  RLC_OR :                         0 - |
 RLDSTR :                      1339 C |  RLSTR :                       1314 C |
 RL_OR :                         10 - |  RNA :                         2DEF C |
 RNAF :                        127C C |  RNAFX :                       127F C |
 RNAX :                        2E08 C |  RNB :                         2DF4 C |
 RNBC :                        2DF1 C |  RNBCX :                       2E0B C |
 RNBX :                        2E0F C |  RNC :                         2DF6 C |
 RNCX :                        2E12 C |  RND :                         2DFB C |
 RNDE :                        2DF8 C |  RNDEX :                       2E15 C |
 RNDX :                        2E19 C |  RNE :                         2DFD C |
 RNEX :                        2E1C C |  RNF :                         2E06 C |
 RNFX :                        2E29 C |  RNH :                         2E02 C |
 RNHL :                        2DFF C |  RNHLX :                       2E1F C |
 RNHX :                        2E23 C |  RNI :                         2E38 C |
 RNIX :                        2E2C C |  RNIY :                        2E2F C |
 RNL :                         2E04 C |  RNLX :                        2E26 C |
 RNPC :                        2E35 C |  RNR :                         2E3A C |
 RNSP :                        2E32 C |  RNTAB :                       2CD5 C |
 RNTABA :                      2D1F C |  RNTABB :                      2D2D C |
 RNTABBC :                     2D41 C |  RNTABC :                      2D4F C |
 RNTABD :                      2D5D C |  RNTABDE :                     2D71 C |
 RNTABE :                      2D7F C |  RNTABF :                      2D8D C |
 RNTABH :                      2D9B C |  RNTABHL :                     2DAF C |
 RNTABI :                      2DCB C |  RNTABL :                      2DBD C |
 RNTABP :                      2DDF C |  RNTABS :                      2DE7 C |
 ROM_B :                          0 - |  RRASTR :                      12EB C |
 RRCASTR :                     12E2 C |  RRCSTR :                      1310 C |
 RRC_OR :                         8 - |  RRDSTR :                      1335 C |
 RRSTR :                       1317 C |  RR_OR :                         18 - |
 RST30H_IN :                   2757 C |  RST38H_IN :                   27E4 C |
 RST38MSG :                    28FD C |  RSTR_BPT :                    28DD C |
 RSTR_TPT :                    28D1 C |  RSTSTR :                      1297 C |
 RST_CD :                      2263 C |  RST_NO :                      225B C |
 RST_TBLE :                     6F7 C |  RST_TBLS :                     6EF C |
 RXWAIT :                      2E3F C |  RX_BCNT :                    0FF44 C |
 RX_BFSIZ :                      40 - |  RX_BRP :                     0FF45 C |
 RX_BUF :                     0FF47 C |  RX_BWP :                     0FF46 C |
 RX_XFLG :                    0FFCB C |  RX_XREQ :                    0FFCD C |
 R_HL_NN :                     1E3D C |  R_HL_NNE :                    1E4A C |
 SADDR :                      0FED7 C |  SAEND :                         59 - |
 SAVEH :                       16AD C |  SBCSTR :                      12AF C |
 SBEND :                         5E - |  SCFSTR :                      12F7 C |
 SCH_NEXT :                    2534 C |  SCH_OPECODE :                 2525 C |
 SCH_OPERAND1 :                251B C |  SCH_OPERAND1_1 :              2520 C |
 SETBPADR :                     3B9 C |  SETBYTEC :                    1B0B C |
 SETDSADR :                    1B01 C |  SETM :                        155D C |
 SETSTR :                      1391 C |  SET_BITNO :                   0DDB C |
 SET_BP :                      1551 C |  SET_BP1 :                      397 C |
 SET_MCB :                     1B65 C |  SET_PEND :                      84 C |
 SET_TM :                       479 C |  SET_XYT :                     1B6D C |
 SH0 :                         16B7 C |  SH1 :                         16BB C |
 SH2 :                         16E3 C |  SH3 :                         16EB C |
 SH4 :                         1702 C |  SHE :                         16E0 C |
 SHEMSG :                      2BF2 C |  SHL0 :                        1716 C |
 SHL00 :                       170B C |  SHLI0 :                       173F C |
 SHLS :                        1753 C |  SHLS0 :                       1772 C |
 SH_0 :                        252B C |  SH_1 :                        252C C |
 SIOA :                          18 - |  SIOACD :                        50 C |
 SIOB :                          1A - |  SIOBCD :                        59 C |
*SIZE :                       0FEDB C |  SKIPSP :                      2705 C |
 SKIP_CR :                     26F4 C |  SKIP_LF :                     26FD C |
 SKIP_NEXT :                   2538 C |  SKIP_UPPER :                  26CB C |
 SKPA_ADR :                    1A41 C |  SKP_OUTM :                    1AE4 C |
 SKP_RMSG :                    289B C |  SKP_SP :                      2589 C |
 SKP_TBP :                     1514 C |  SLASTR :                      131A C |
 SLA_OR :                        20 - |  SM0 :                         1577 C |
 SM1 :                         1578 C |  SM2 :                         159E C |
 SM3 :                         15A9 C |  SM4 :                         15B4 C |
 SRASTR :                      131E C |  SRA_OR :                        28 - |
 SRECER :                      2C1F C |  SRLSTR :                      1322 C |
 SRL_OR :                        38 - |  SR_BASE :                     23D2 C |
 SR_IY1 :                      2428 C |  SR_LOOKFOR :                  23FB C |
 SR_NUM :                         8 - |  STACK :                      0FE90 - |
 STACKM :                     0FED0 - |  START :                        0FD C |
 STPBRK_MSG :                  2907 C |  STP_CHK :                      502 C |
 STROUT :                      261B C |  ST_COPY :                     11BB C |
 ST_MC1 :                      20FF C |  ST_MC11 :                     2101 C |
 ST_MUL8 :                     29CE C |  SUBSTR :                      12AB C |
 SV_NNKR :                     10C0 C |  SX_ERR :                      249A C |
 TADR_CHK :                     4F1 C |  TASM_ADR :                   0FF1D C |
 TC_CNT :                     0FF16 C |  TERR_MSG :                     664 C |
 THREE_OPTBL :                  7A2 C |  THREE_OPTBLE :                 7A6 C |
 THREE_OPTBL_E :                7AA C | *TIME :                  "20:45:29" - |
 TMPB_ADR :                   0FF08 C |  TMPB_F :                     0FF06 C |
 TMPB_OP :                    0FF07 C |  TMPT :                       0FF18 C |
 TM_MODE :                    0FF15 C |  TM_MSG_0 :                     48A C |
 TM_MSG_I :                     499 C |  TM_MSG_S :                     49F C |
 TPT1_ADR :                   0FEF8 C |  TPT1_F :                     0FEF6 C |
 TPT1_OP :                    0FEF7 C |  TPT2_ADR :                   0FEFC C |
 TPT2_F :                     0FEFA C |  TPT2_OP :                    0FEFB C |
 TP_CHK1 :                     2854 C |  TP_CHK2 :                     2863 C |
 TP_CMD :                       4A7 C |  TP_MD_ON :                     4CB C |
 TP_MODE :                    0FF14 C |  TP_MSG_0 :                     4DC C |
 TP_MSG_OFF :                   4EB C |  TP_MSG_ON :                    4E6 C |
 TP_N1 :                        4B3 C |  TP_N2 :                        4BC C |
 TRACE_CMD :                    42B C |  TRACE_MSG :                   2910 C |
*TRUE :                           1 - |  TWO_OPTBL :                    790 C |
 TWO_OPTBL_E :                  7A2 C |  TXEMPTY :                        4 - |
 TXPEND :                        28 - |  TX_BCNT :                    0FF87 C |
 TX_BFSIZ :                      40 - |  TX_BRP :                     0FF88 C |
 TX_BUF :                     0FF8A C |  TX_BWP :                     0FF89 C |
 TX_DIRECT :                   2EE7 C |  TX_NODAT :                    2EE5 C |
 TX_PEND :                    0FFCA C |  TX_WT :                       2EEA C |
 TX_XFLG :                    0FFCC C |  T_NO_KY :                     28B3 C |
 T_OP1 :                        51A C |  T_OP11 :                       514 C |
 T_OP_CHK :                     535 C |  UPPER :                       270C C |
 UP_BI :                        345 C | *VERSION :                     142F - |
 WORK_B :                     0FED0 - |  WORK_SIZE :                    130 - |
 WSTART :                       1CB C |  WSTART0 :                      19E C |
 WS_CHK1 :                     27AF C |  WS_CHK2 :                     27BB C |
 WS_CHK3 :                     27C7 C |  WS_CHK4 :                     27D3 C |
 WS_CHK5 :                     27DF C |  XOFF :                          13 - |
 XON :                           11 - |  XORSTR :                      12B7 C |
 XY_SRTP :                    0FF41 C |

   1181 symbols
     44 unused symbols

 AS V1.42 Beta [Bld 227] - Source File AKI80mon_RevB04.asm - Page 3 - 1/5/2023 20:45:29


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.06 seconds assembly time

   8897 lines source file
      2 passes
      0 errors
      0 warnings
